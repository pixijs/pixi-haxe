!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.PIXI=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a,b){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:2}],2:[function(a,b,c){function d(){if(!h){h=!0;for(var a,b=g.length;b;){a=g,g=[];for(var c=-1;++c<b;)a[c]();b=g.length}h=!1}}function e(){}var f=b.exports={},g=[],h=!1;f.nextTick=function(a){g.push(a),h||setTimeout(d,0)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=e,f.addListener=e,f.once=e,f.off=e,f.removeListener=e,f.removeAllListeners=e,f.emit=e,f.binding=function(a){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(a){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],3:[function(b,c,d){(function(b){!function(){function d(a){var b=!1;return function(){if(b)throw new Error("Callback was already called.");b=!0,a.apply(e,arguments)}}var e,f,g={};e=this,null!=e&&(f=e.async),g.noConflict=function(){return e.async=f,g};var h=Object.prototype.toString,i=Array.isArray||function(a){return"[object Array]"===h.call(a)},j=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},k=function(a,b){if(a.map)return a.map(b);var c=[];return j(a,function(a,d,e){c.push(b(a,d,e))}),c},l=function(a,b,c){return a.reduce?a.reduce(b,c):(j(a,function(a,d,e){c=b(c,a,d,e)}),c)},m=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"!=typeof b&&b.nextTick?(g.nextTick=b.nextTick,g.setImmediate="undefined"!=typeof setImmediate?function(a){setImmediate(a)}:g.nextTick):"function"==typeof setImmediate?(g.nextTick=function(a){setImmediate(a)},g.setImmediate=g.nextTick):(g.nextTick=function(a){setTimeout(a,0)},g.setImmediate=g.nextTick),g.each=function(a,b,c){function e(b){b?(c(b),c=function(){}):(f+=1,f>=a.length&&c())}if(c=c||function(){},!a.length)return c();var f=0;j(a,function(a){b(a,d(e))})},g.forEach=g.each,g.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})};e()},g.forEachSeries=g.eachSeries,g.eachLimit=function(a,b,c,d){var e=n(b);e.apply(null,[a,c,d])},g.forEachLimit=g.eachLimit;var n=function(a){return function(b,c,d){if(d=d||function(){},!b.length||0>=a)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;a>g&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},o=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[g.each].concat(b))}},p=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[n(a)].concat(c))}},q=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[g.eachSeries].concat(b))}},r=function(a,b,c,d){if(b=k(b,function(a,b){return{index:b,value:a}}),d){var e=[];a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})}else a(b,function(a,b){c(a.value,function(a){b(a)})})};g.map=o(r),g.mapSeries=q(r),g.mapLimit=function(a,b,c,d){return s(b)(a,c,d)};var s=function(a){return p(a,r)};g.reduce=function(a,b,c,d){g.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){d(a,b)})},g.inject=g.reduce,g.foldl=g.reduce,g.reduceRight=function(a,b,c,d){var e=k(a,function(a){return a}).reverse();g.reduce(e,b,c,d)},g.foldr=g.reduceRight;var t=function(a,b,c,d){var e=[];b=k(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(a){d(k(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};g.filter=o(t),g.filterSeries=q(t),g.select=g.filter,g.selectSeries=g.filterSeries;var u=function(a,b,c,d){var e=[];b=k(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(a){d(k(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};g.reject=o(u),g.rejectSeries=q(u);var v=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(a){d()})};g.detect=o(v),g.detectSeries=q(v),g.some=function(a,b,c){g.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(a){c(!1)})},g.any=g.some,g.every=function(a,b,c){g.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(a){c(!0)})},g.all=g.every,g.sortBy=function(a,b,c){g.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0};c(null,k(b.sort(d),function(a){return a.value}))})},g.auto=function(a,b){b=b||function(){};var c=m(a),d=c.length;if(!d)return b();var e={},f=[],h=function(a){f.unshift(a)},k=function(a){for(var b=0;b<f.length;b+=1)if(f[b]===a)return void f.splice(b,1)},n=function(){d--,j(f.slice(0),function(a){a()})};h(function(){if(!d){var a=b;b=function(){},a(null,e)}}),j(c,function(c){var d=i(a[c])?a[c]:[a[c]],f=function(a){var d=Array.prototype.slice.call(arguments,1);if(d.length<=1&&(d=d[0]),a){var f={};j(m(e),function(a){f[a]=e[a]}),f[c]=d,b(a,f),b=function(){}}else e[c]=d,g.setImmediate(n)},o=d.slice(0,Math.abs(d.length-1))||[],p=function(){return l(o,function(a,b){return a&&e.hasOwnProperty(b)},!0)&&!e.hasOwnProperty(c)};if(p())d[d.length-1](f,e);else{var q=function(){p()&&(k(q),d[d.length-1](f,e))};h(q)}})},g.retry=function(a,b,c){var d=5,e=[];"function"==typeof a&&(c=b,b=a,a=d),a=parseInt(a,10)||d;var f=function(d,f){for(var h=function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},f)}};a;)e.push(h(b,!(a-=1)));g.series(e,function(a,b){b=b[b.length-1],(d||c)(b.err,b.result)})};return c?f():f},g.waterfall=function(a,b){if(b=b||function(){},!i(a)){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();var d=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var e=Array.prototype.slice.call(arguments,1),f=a.next();e.push(f?d(f):b),g.setImmediate(function(){a.apply(null,e)})}}};d(g.iterator(a))()};var w=function(a,b,c){if(c=c||function(){},i(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(m(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};g.parallel=function(a,b){w({map:g.map,each:g.each},a,b)},g.parallelLimit=function(a,b,c){w({map:s(b),each:n(b)},a,c)},g.series=function(a,b){if(b=b||function(){},i(a))g.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};g.eachSeries(m(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},g.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},g.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var x=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};g.concat=o(x),g.concatSeries=q(x),g.whilst=function(a,b,c){a()?b(function(d){return d?c(d):void g.whilst(a,b,c)}):c()},g.doWhilst=function(a,b,c){a(function(d){if(d)return c(d);var e=Array.prototype.slice.call(arguments,1);b.apply(null,e)?g.doWhilst(a,b,c):c()})},g.until=function(a,b,c){a()?c():b(function(d){return d?c(d):void g.until(a,b,c)})},g.doUntil=function(a,b,c){a(function(d){if(d)return c(d);var e=Array.prototype.slice.call(arguments,1);b.apply(null,e)?c():g.doUntil(a,b,c)})},g.queue=function(a,b){function c(a,b,c,d){return a.started||(a.started=!0),i(b)||(b=[b]),0==b.length?g.setImmediate(function(){a.drain&&a.drain()}):void j(b,function(b){var e={data:b,callback:"function"==typeof d?d:null};c?a.tasks.unshift(e):a.tasks.push(e),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),g.setImmediate(a.process)})}void 0===b&&(b=1);var e=0,f={tasks:[],concurrency:b,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(a,b){c(f,a,!1,b)},kill:function(){f.drain=null,f.tasks=[]},unshift:function(a,b){c(f,a,!0,b)},process:function(){if(!f.paused&&e<f.concurrency&&f.tasks.length){var b=f.tasks.shift();f.empty&&0===f.tasks.length&&f.empty(),e+=1;var c=function(){e-=1,b.callback&&b.callback.apply(b,arguments),f.drain&&f.tasks.length+e===0&&f.drain(),f.process()},g=d(c);a(b.data,g)}},length:function(){return f.tasks.length},running:function(){return e},idle:function(){return f.tasks.length+e===0},pause:function(){f.paused!==!0&&(f.paused=!0,f.process())},resume:function(){f.paused!==!1&&(f.paused=!1,f.process())}};return f},g.priorityQueue=function(a,b){function c(a,b){return a.priority-b.priority}function d(a,b,c){for(var d=-1,e=a.length-1;e>d;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function e(a,b,e,f){return a.started||(a.started=!0),i(b)||(b=[b]),0==b.length?g.setImmediate(function(){a.drain&&a.drain()}):void j(b,function(b){var h={data:b,priority:e,callback:"function"==typeof f?f:null};a.tasks.splice(d(a.tasks,h,c)+1,0,h),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),g.setImmediate(a.process)})}var f=g.queue(a,b);return f.push=function(a,b,c){e(f,a,b,c)},delete f.unshift,f},g.cargo=function(a,b){var c=!1,d=[],e={tasks:d,payload:b,saturated:null,empty:null,drain:null,drained:!0,push:function(a,c){i(a)||(a=[a]),j(a,function(a){d.push({data:a,callback:"function"==typeof c?c:null}),e.drained=!1,e.saturated&&d.length===b&&e.saturated()}),g.setImmediate(e.process)},process:function f(){if(!c){if(0===d.length)return e.drain&&!e.drained&&e.drain(),void(e.drained=!0);var g="number"==typeof b?d.splice(0,b):d.splice(0,d.length),h=k(g,function(a){return a.data});e.empty&&e.empty(),c=!0,a(h,function(){c=!1;var a=arguments;j(g,function(b){b.callback&&b.callback.apply(null,a)}),f()})}},length:function(){return d.length},running:function(){return c}};return e};var y=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error:console[a]&&j(c,function(a){}))}]))}};g.log=y("log"),g.dir=y("dir"),g.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),f=e.pop(),h=b.apply(null,e);h in c?g.nextTick(function(){f.apply(null,c[h])}):h in d?d[h].push(f):(d[h]=[f],a.apply(null,e.concat([function(){c[h]=arguments;var a=d[h];delete d[h];for(var b=0,e=a.length;e>b;b++)a[b].apply(null,arguments)}])))};return e.memo=c,e.unmemoized=a,e},g.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},g.times=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return g.map(d,b,c)},g.timesSeries=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return g.mapSeries(d,b,c)},g.seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),d=c.pop();g.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){d.apply(b,[a].concat(c))})}},g.compose=function(){return g.seq.apply(null,Array.prototype.reverse.call(arguments))};var z=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};g.applyEach=o(z),g.applyEachSeries=q(z),g.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},"undefined"!=typeof c&&c.exports?c.exports=g:"undefined"!=typeof a&&a.amd?a([],function(){return g}):e.async=g}()}).call(this,b("_process"))},{_process:2}],4:[function(a,b,c){"use strict";function d(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function e(){}e.prototype._events=void 0,e.prototype.listeners=function(a){if(!this._events||!this._events[a])return[];if(this._events[a].fn)return[this._events[a].fn];for(var b=0,c=this._events[a].length,d=new Array(c);c>b;b++)d[b]=this._events[a][b].fn;return d},e.prototype.emit=function(a,b,c,d,e,f){if(!this._events||!this._events[a])return!1;var g,h,i=this._events[a],j=arguments.length;if("function"==typeof i.fn){switch(i.once&&this.removeListener(a,i.fn,!0),j){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,b),!0;case 3:return i.fn.call(i.context,b,c),!0;case 4:return i.fn.call(i.context,b,c,d),!0;case 5:return i.fn.call(i.context,b,c,d,e),!0;case 6:return i.fn.call(i.context,b,c,d,e,f),!0}for(h=1,g=new Array(j-1);j>h;h++)g[h-1]=arguments[h];i.fn.apply(i.context,g)}else{var k,l=i.length;for(h=0;l>h;h++)switch(i[h].once&&this.removeListener(a,i[h].fn,!0),j){case 1:i[h].fn.call(i[h].context);break;case 2:i[h].fn.call(i[h].context,b);break;case 3:i[h].fn.call(i[h].context,b,c);break;default:if(!g)for(k=1,g=new Array(j-1);j>k;k++)g[k-1]=arguments[k];i[h].fn.apply(i[h].context,g)}}return!0},e.prototype.on=function(a,b,c){var e=new d(b,c||this);return this._events||(this._events={}),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],e]:this._events[a].push(e):this._events[a]=e,this},e.prototype.once=function(a,b,c){var e=new d(b,c||this,!0);return this._events||(this._events={}),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],e]:this._events[a].push(e):this._events[a]=e,this},e.prototype.removeListener=function(a,b,c){if(!this._events||!this._events[a])return this;var d=this._events[a],e=[];if(b&&(d.fn&&(d.fn!==b||c&&!d.once)&&e.push(d),!d.fn))for(var f=0,g=d.length;g>f;f++)(d[f].fn!==b||c&&!d[f].once)&&e.push(d[f]);return e.length?this._events[a]=1===e.length?e[0]:e:delete this._events[a],this},e.prototype.removeAllListeners=function(a){return this._events?(a?delete this._events[a]:this._events={},this):this},e.prototype.off=e.prototype.removeListener,e.prototype.addListener=e.prototype.on,e.prototype.setMaxListeners=function(){return this},e.EventEmitter=e,e.EventEmitter2=e,e.EventEmitter3=e,b.exports=e},{}],5:[function(a,b,c){"use strict";function d(a){if(null==a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}b.exports=Object.assign||function(a,b){for(var c,e,f=d(a),g=1;g<arguments.length;g++){c=arguments[g],e=Object.keys(Object(c));for(var h=0;h<e.length;h++)f[e[h]]=c[e[h]]}return f}},{}],6:[function(a,b,c){function d(a,b){g.call(this),b=b||10,this.baseUrl=a||"",this.progress=0,this.loading=!1,this._progressChunk=0,this._beforeMiddleware=[],this._afterMiddleware=[],this._boundLoadResource=this._loadResource.bind(this),this._boundOnLoad=this._onLoad.bind(this),this._buffer=[],this._numToLoad=0,this._queue=e.queue(this._boundLoadResource,b),this.resources={}}var e=a("async"),f=a("./Resource"),g=a("eventemitter3").EventEmitter;d.prototype=Object.create(g.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.add=d.prototype.enqueue=function(a,b,c,d){if(Array.isArray(a)){for(var e=0;e<a.length;++e)this.add(a[e]);return this}if("object"==typeof a&&(d=b||a.callback||a.onComplete,c=a,b=a.url,a=a.name||a.key||a.url),"string"!=typeof b&&(d=c,c=b,b=a),"string"!=typeof b)throw new Error("No url passed to add resource to loader.");if("function"==typeof c&&(d=c,c=null),this.resources[a])throw new Error('Resource with name "'+a+'" already exists.');return 0!==b.indexOf("data:")&&(b=this.baseUrl+b),this.resources[a]=new f(a,b,c),"function"==typeof d&&this.resources[a].once("afterMiddleware",d),this._numToLoad++,this._queue.started?(this._queue.push(this.resources[a]),this._progressChunk=(100-this.progress)/(this._queue.length()+this._queue.running())):(this._buffer.push(this.resources[a]),this._progressChunk=100/this._buffer.length),this},d.prototype.before=d.prototype.pre=function(a){return this._beforeMiddleware.push(a),this},d.prototype.after=d.prototype.use=function(a){return this._afterMiddleware.push(a),this},d.prototype.reset=function(){this._buffer.length=0,this._queue.kill(),this._queue.started=!1,this.progress=0,this._progressChunk=0,this.loading=!1},d.prototype.load=function(a){if("function"==typeof a&&this.once("complete",a),this._queue.started)return this;this.emit("start",this);for(var b=0;b<this._buffer.length;++b)this._queue.push(this._buffer[b]);return this._buffer.length=0,this},d.prototype._loadResource=function(a,b){var c=this;a._dequeue=b,this._runMiddleware(a,this._beforeMiddleware,function(){a.load(c._boundOnLoad)})},d.prototype._onComplete=function(){this.emit("complete",this,this.resources)},d.prototype._onLoad=function(a){this.progress+=this._progressChunk,this.emit("progress",this,a),a.error?this.emit("error",a.error,this,a):this.emit("load",this,a),this._runMiddleware(a,this._afterMiddleware,function(){a.emit("afterMiddleware",a),this._numToLoad--,0===this._numToLoad&&this._onComplete()}),a._dequeue()},d.prototype._runMiddleware=function(a,b,c){var d=this;e.eachSeries(b,function(b,c){b.call(d,a,c)},c.bind(this,a))},d.LOAD_TYPE=f.LOAD_TYPE,d.XHR_READY_STATE=f.XHR_READY_STATE,d.XHR_RESPONSE_TYPE=f.XHR_RESPONSE_TYPE},{"./Resource":7,async:3,eventemitter3:4}],7:[function(a,b,c){function d(a,b,c){if(f.call(this),c=c||{},"string"!=typeof a||"string"!=typeof b)throw new Error("Both name and url are required for constructing a resource.");this.name=a,this.url=b,this.data=null,this.crossOrigin=c.crossOrigin,this.loadType=c.loadType||this._determineLoadType(),this.xhrType=c.xhrType,this.error=null,this.xhr=null,this._dequeue=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}function e(a){return a.toString().replace("object ","")}var f=a("eventemitter3").EventEmitter,g=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest);d.prototype=Object.create(f.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError),this.data.removeEventListener("load",this._boundComplete),this.data.removeEventListener("progress",this._boundOnProgress),this.data.removeEventListener("canplaythrough",this._boundComplete)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError),this.xhr.removeEventListener("abort",this._boundXhrOnAbort),this.xhr.removeEventListener("progress",this._boundOnProgress),this.xhr.removeEventListener("load",this._boundXhrOnLoad)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.emit("complete",this)},d.prototype.load=function(a){switch(this.emit("start",this),a&&this.once("complete",a),"string"!=typeof this.crossOrigin&&(this.crossOrigin=this._determineCrossOrigin()),this.loadType){case d.LOAD_TYPE.IMAGE:this._loadImage();break;case d.LOAD_TYPE.AUDIO:this._loadElement("audio");break;case d.LOAD_TYPE.VIDEO:this._loadElement("video");break;case d.LOAD_TYPE.XHR:default:g?this._loadXdr():this._loadXhr()}},d.prototype._loadImage=function(){this.data=new Image,this.crossOrigin&&(this.data.crossOrigin=""),this.data.src=this.url,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},d.prototype._loadElement=function(a){if(this.data=document.createElement(a),Array.isArray(this.url))for(var b=0;b<this.url.length;++b)this.data.appendChild(this._createSource(a,this.url[b]));else this.data.appendChild(this._createSource(a,this.url));this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},d.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var a=this.xhr=new XMLHttpRequest;a.open("GET",this.url,!0),a.responseType=this.xhrType===d.XHR_RESPONSE_TYPE.JSON||this.xhrType===d.XHR_RESPONSE_TYPE.DOCUMENT?d.XHR_RESPONSE_TYPE.TEXT:this.xhrType,a.addEventListener("error",this._boundXhrOnError,!1),a.addEventListener("abort",this._boundXhrOnAbort,!1),a.addEventListener("progress",this._boundOnProgress,!1),a.addEventListener("load",this._boundXhrOnLoad,!1),a.send()},d.prototype._loadXdr=function(){var a=this.xhr=new XDomainRequest;a.timeout=5e3,a.onerror=this._boundXhrOnError,a.ontimeout=this._boundXdrOnTimeout,a.onprogress=this._boundOnProgress,a.onload=this._boundXhrOnLoad,a.open("GET",this.url,!0),setTimeout(function(){a.send()},0)},d.prototype._createSource=function(a,b,c){c||(c=a+"/"+b.substr(b.lastIndexOf(".")+1));var d=document.createElement("source");return d.src=b,d.type=c,d},d.prototype._onError=function(a){this.error=new Error("Failed to load element using "+a.target.nodeName),this.complete()},d.prototype._onProgress=function(a){a.lengthComputable&&this.emit("progress",this,a.loaded/a.total)},d.prototype._xhrOnError=function(a){this.error=new Error(e(a.target)+" Request failed. Status: "+a.target.status+', text: "'+a.target.statusText+'"'),this.complete()},d.prototype._xhrOnAbort=function(a){this.error=new Error(e(a.target)+" Request was aborted by the user."),this.complete()},d.prototype._xdrOnTimeout=function(a){this.error=new Error(e(a.target)+" Request timed out."),this.complete()},d.prototype._xhrOnLoad=function(a){var b=a.target;if(200===b.status)if(this.xhrType===d.XHR_RESPONSE_TYPE.TEXT)this.data=b.responseText;else if(this.xhrType===d.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(b.responseText)}catch(c){this.error=new Error("Error trying to parse loaded json:",c)}else if(this.xhrType===d.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var e=new DOMParser;this.data=e.parseFromString(b.responseText,"text/xml")}else{var f=document.createElement("div");f.innerHTML=b.responseText,this.data=f}}catch(c){this.error=new Error("Error trying to parse loaded xml:",c)}else this.data=b.response;else this.error=new Error("["+b.status+"]"+b.statusText+":"+b.responseURL);this.complete()},d.prototype._determineCrossOrigin=function(){if(0===this.url.indexOf("data:"))return"";var a=window.location,b=document.createElement("a");return b.href=this.url,b.hostname!==a.hostname||b.port!==a.port||b.protocol!==a.protocol?"anonymous":""},d.prototype._determineXhrType=function(){var a=this.url.substr(this.url.lastIndexOf(".")+1);switch(a){case"xhtml":case"html":case"htm":case"xml":case"tmx":case"tsx":case"svg":return d.XHR_RESPONSE_TYPE.DOCUMENT;case"gif":case"png":case"bmp":case"jpg":case"jpeg":case"tif":case"tiff":case"webp":return d.XHR_RESPONSE_TYPE.BLOB;case"json":return d.XHR_RESPONSE_TYPE.JSON;case"text":case"txt":default:return d.XHR_RESPONSE_TYPE.TEXT}},d.prototype._determineLoadType=function(){var a=this.url.substr(this.url.lastIndexOf(".")+1);switch(a){case"gif":case"png":case"bmp":case"jpg":case"jpeg":case"tif":case"tiff":case"webp":return d.LOAD_TYPE.IMAGE;default:return d.LOAD_TYPE.XHR}},d.prototype._getMimeFromXhrType=function(a){switch(a){case d.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case d.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case d.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case d.XHR_RESPONSE_TYPE.JSON:return"application/json";case d.XHR_RESPONSE_TYPE.DEFAULT:case d.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},d.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},d.XHR_READY_STATE={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},d.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"}},{eventemitter3:4}],8:[function(a,b,c){b.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(a){for(var b,c="",d=new Array(4),e=0,f=0,g=0;e<a.length;){for(b=new Array(3),f=0;f<b.length;f++)b[f]=e<a.length?255&a.charCodeAt(e++):0;switch(d[0]=b[0]>>2,d[1]=(3&b[0])<<4|b[1]>>4,d[2]=(15&b[1])<<2|b[2]>>6,d[3]=63&b[2],g=e-(a.length-1)){case 2:d[3]=64,d[2]=64;break;case 1:d[3]=64}for(f=0;f<d.length;f++)c+=this._keyStr.charAt(d[f])}return c}}},{}],9:[function(a,b,c){b.exports=a("./Loader"),b.exports.Resource=a("./Resource"),b.exports.middleware={caching:{memory:a("./middlewares/caching/memory")},parsing:{blob:a("./middlewares/parsing/blob")}}},{"./Loader":6,"./Resource":7,"./middlewares/caching/memory":10,"./middlewares/parsing/blob":11}],10:[function(a,b,c){var d={};b.exports=function(){return function(a,b){d[a.url]?(a.data=d[a.url],a.complete()):(a.once("complete",function(){d[this.url]=this.data}),b())}}},{}],11:[function(a,b,c){var d=a("../../Resource"),e=a("../../b64");window.URL=window.URL||window.webkitURL,b.exports=function(){return function(a,b){if(!a.data)return b();if(a.xhr&&a.xhrType===d.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof a.data){if(0===a.data.type.indexOf("image")){var c=URL.createObjectURL(a.data);a.blob=a.data,a.data=new Image,a.data.src=c,a.data.onload=function(){URL.revokeObjectURL(c),a.data.onload=null,b()}}}else{var f=a.xhr.getResponseHeader("content-type");f&&0===f.indexOf("image")&&(a.data=new Image,a.data.src="data:"+f+";base64,"+e.encodeBinary(a.xhr.responseText),b())}else b()}}},{"../../Resource":7,"../../b64":8}],12:[function(a,b,c){b.exports={name:"pixi.js",version:"3.0.0-rc4",description:"Pixi.js is a fast lightweight 2D library that works across all devices.",author:{name:"Mat Groves"},contributors:[{name:"Chad Engler",email:"chad@pantherdev.com"},{name:"Richard Davey",email:"rdavey@gmail.com"}],main:"./src/index.js",homepage:"http://goodboydigital.com/",bugs:{url:"https://github.com/GoodBoyDigital/pixi.js/issues"},license:"MIT",repository:{type:"git",url:"https://github.com/GoodBoyDigital/pixi.js.git"},scripts:{test:"gulp test",docs:"jsdoc -c ./gulp/util/jsdoc.conf.json -R README.md"},dependencies:{async:"^0.9.0",brfs:"^1.2.0",eventemitter3:"^0.1.6","object-assign":"^2.0.0","resource-loader":"^1.3.2"},devDependencies:{browserify:"^8.0.2",chai:"^1.10.0",del:"^1.1.0",gulp:"^3.8.10","gulp-cached":"^1.0.1","gulp-concat":"^2.5.2","gulp-debug":"^2.0.0","gulp-jshint":"^1.9.0","gulp-mirror":"^0.4.0","gulp-plumber":"^0.6.6","gulp-rename":"^1.2.0","gulp-sourcemaps":"^1.5.0","gulp-uglify":"^1.0.2","gulp-util":"^3.0.1","ink-docstrap":"git+https://github.com/Pilatch/docstrap.git",jsdoc:"^3.3.0-alpha13","jshint-summary":"^0.4.0",karma:"^0.12.28","karma-firefox-launcher":"^0.1.0","karma-mocha":"^0.1.10","karma-spec-reporter":"^0.0.16",minimist:"^1.1.0",mocha:"^2.1.0","require-dir":"^0.1.0","run-sequence":"^1.0.2","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.0.0",watchify:"^2.2.1"},browserify:{transform:["brfs"]},gitHead:"34c8db0ecf8089b61fa492f63f33de605e557eb9",_id:"pixi.js@3.0.0-rc4",_shasum:"add51749cd1662020e76702285c5975b182110d2",_from:"pixi.js@3.0.0-rc4",_npmVersion:"1.4.23",_npmUser:{name:"englercj",email:"englercj@live.com"},maintainers:[{name:"englercj",email:"englercj@live.com"}],dist:{shasum:"add51749cd1662020e76702285c5975b182110d2",tarball:"http://registry.npmjs.org/pixi.js/-/pixi.js-3.0.0-rc4.tgz"},directories:{},_resolved:"https://registry.npmjs.org/pixi.js/-/pixi.js-3.0.0-rc4.tgz",readme:"ERROR: No README data found!"}},{}],13:[function(a,b,c){b.exports={VERSION:a("../../package.json").version,PI_2:2*Math.PI,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},SPRITE_BATCH_SIZE:2e3}},{"../../package.json":12}],14:[function(a,b,c){function d(){f.call(this),this.children=[]}var e=a("../math"),f=a("./DisplayObject"),g=a("../textures/RenderTexture"),h=new e.Matrix;d.prototype=Object.create(f.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{width:{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(a){var b=this.getLocalBounds().width;this.scale.x=0!==b?a/b:1,this._width=a}},height:{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(a){var b=this.getLocalBounds().height;this.scale.y=0!==b?a/b:1,this._height=a}}}),d.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)},d.prototype.addChildAt=function(a,b){if(a===this)return a;if(b>=0&&b<=this.children.length)return a.parent&&a.parent.removeChild(a),
a.parent=this,this.children.splice(b,0,a),a;throw new Error(a+"addChildAt: The index "+b+" supplied is out of bounds "+this.children.length)},d.prototype.swapChildren=function(a,b){if(a!==b){var c=this.getChildIndex(a),d=this.getChildIndex(b);if(0>c||0>d)throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.");this.children[c]=b,this.children[d]=a}},d.prototype.getChildIndex=function(a){var b=this.children.indexOf(a);if(-1===b)throw new Error("The supplied DisplayObject must be a child of the caller");return b},d.prototype.setChildIndex=function(a,b){if(0>b||b>=this.children.length)throw new Error("The supplied index is out of bounds");var c=this.getChildIndex(a);this.children.splice(c,1),this.children.splice(b,0,a)},d.prototype.getChildAt=function(a){if(0>a||a>=this.children.length)throw new Error("getChildAt: Supplied index "+a+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller");return this.children[a]},d.prototype.removeChild=function(a){var b=this.children.indexOf(a);if(-1!==b)return this.removeChildAt(b)},d.prototype.removeChildAt=function(a){var b=this.getChildAt(a);return b.parent=null,this.children.splice(a,1),b},d.prototype.removeChildren=function(a,b){var c=a||0,d="number"==typeof b?b:this.children.length,e=d-c;if(e>0&&d>=e){for(var f=this.children.splice(c,e),g=0;g<f.length;++g)f[g].parent=null;return f}if(0===e&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},d.prototype.generateTexture=function(a,b,c){var d=this.getLocalBounds(),e=new g(a,0|d.width,0|d.height,a,c,b);return h.tx=-d.x,h.ty=-d.y,e.render(this,h),e},d.prototype.updateTransform=function(){if(this.visible){this.displayObjectUpdateTransform();for(var a=0,b=this.children.length;b>a;++a)this.children[a].updateTransform()}},d.prototype.containerUpdateTransform=d.prototype.updateTransform,d.prototype.getBounds=function(){if(!this._currentBounds){if(0===this.children.length)return e.Rectangle.EMPTY;for(var a,b,c,d=1/0,f=1/0,g=-(1/0),h=-(1/0),i=!1,j=0,k=this.children.length;k>j;++j){var l=this.children[j];l.visible&&(i=!0,a=this.children[j].getBounds(),d=d<a.x?d:a.x,f=f<a.y?f:a.y,b=a.width+a.x,c=a.height+a.y,g=g>b?g:b,h=h>c?h:c)}if(!i)return e.Rectangle.EMPTY;var m=this._bounds;m.x=d,m.y=f,m.width=g-d,m.height=h-f,this._currentBounds=m}return this._currentBounds},d.prototype.containerGetBounds=d.prototype.getBounds,d.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=e.Matrix.IDENTITY;for(var b=0,c=this.children.length;c>b;++b)this.children[b].updateTransform();return this.worldTransform=a,this._currentBounds=null,this.getBounds()},d.prototype.renderWebGL=function(a){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var b,c;if(this._mask||this._filters){for(a.currentRenderer.flush(),this._filters&&a.filterManager.pushFilter(this,this._filters),this._mask&&a.maskManager.pushMask(this,this._mask),a.currentRenderer.start(),this._renderWebGL(a),b=0,c=this.children.length;c>b;b++)this.children[b].renderWebGL(a);a.currentRenderer.flush(),this._mask&&a.maskManager.popMask(this,this._mask),this._filters&&a.filterManager.popFilter(),a.currentRenderer.start()}else for(this._renderWebGL(a),b=0,c=this.children.length;c>b;++b)this.children[b].renderWebGL(a)}},d.prototype._renderWebGL=function(a){},d.prototype._renderCanvas=function(a){},d.prototype.renderCanvas=function(a){if(this.visible&&!(this.alpha<=0)&&this.renderable){this._mask&&a.maskManager.pushMask(this._mask,a),this._renderCanvas(a);for(var b=0,c=this.children.length;c>b;++b)this.children[b].renderCanvas(a);this._mask&&a.maskManager.popMask(a)}},d.prototype.destroy=function(a){if(f.prototype.destroy.call(this),a)for(var b=0,c=this.children.length;c>b;++b)this.children[b].destroy(a);this.removeChildren(),this.children=null}},{"../math":23,"../textures/RenderTexture":61,"./DisplayObject":15}],15:[function(a,b,c){function d(){g.call(this),this.position=new e.Point,this.scale=new e.Point(1,1),this.pivot=new e.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.worldTransform=new e.Matrix,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new e.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cachedObject=null}var e=a("../math"),f=a("../textures/RenderTexture"),g=a("eventemitter3").EventEmitter,h=a("../const"),i=new e.Matrix;d.prototype=Object.create(g.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{x:{get:function(){return this.position.x},set:function(a){this.position.x=a}},y:{get:function(){return this.position.y},set:function(a){this.position.y=a}},worldVisible:{get:function(){var a=this;do{if(!a.visible)return!1;a=a.parent}while(a);return!0}},mask:{get:function(){return this._mask},set:function(a){this._mask&&(this._mask.renderable=!0),this._mask=a,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(a){this._filters=a&&a.slice()}}}),d.prototype.updateTransform=function(){var a,b,c,d,e,f,g=this.parent.worldTransform,i=this.worldTransform;this.rotation%h.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),a=this._cr*this.scale.x,b=this._sr*this.scale.x,c=-this._sr*this.scale.y,d=this._cr*this.scale.y,e=this.position.x,f=this.position.y,(this.pivot.x||this.pivot.y)&&(e-=this.pivot.x*a+this.pivot.y*c,f-=this.pivot.x*b+this.pivot.y*d),i.a=a*g.a+b*g.c,i.b=a*g.b+b*g.d,i.c=c*g.a+d*g.c,i.d=c*g.b+d*g.d,i.tx=e*g.a+f*g.c+g.tx,i.ty=e*g.b+f*g.d+g.ty):(a=this.scale.x,d=this.scale.y,e=this.position.x-this.pivot.x*a,f=this.position.y-this.pivot.y*d,i.a=a*g.a,i.b=a*g.b,i.c=d*g.c,i.d=d*g.d,i.tx=e*g.a+f*g.c+g.tx,i.ty=e*g.b+f*g.d+g.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},d.prototype.displayObjectUpdateTransform=d.prototype.updateTransform,d.prototype.getBounds=function(a){return e.Rectangle.EMPTY},d.prototype.getLocalBounds=function(){return this.getBounds(e.Matrix.IDENTITY)},d.prototype.toGlobal=function(a){return this.displayObjectUpdateTransform(),this.worldTransform.apply(a)},d.prototype.toLocal=function(a,b){return b&&(a=b.toGlobal(a)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(a)},d.prototype.renderWebGL=function(a){},d.prototype.renderCanvas=function(a){},d.prototype.generateTexture=function(a,b,c){var d=this.getLocalBounds(),e=new f(a,0|d.width,0|d.height,a,c,b);return i.tx=-d.x,i.ty=-d.y,e.render(this,i),e},d.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null,this.listeners=null}},{"../const":13,"../math":23,"../textures/RenderTexture":61,eventemitter3:4}],16:[function(a,b,c){function d(){e.call(this),this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this._prevTint=16777215,this.blendMode=l.BLEND_MODES.NORMAL,this.currentPath=null,this._webGL={},this.isMask=!1,this.boundsPadding=0,this._localBounds=new k.Rectangle(0,0,1,1),this.dirty=!0,this.glDirty=!1,this.cachedSpriteDirty=!1}var e=a("../display/Container"),f=a("../sprites/Sprite"),g=a("../textures/Texture"),h=a("../renderers/canvas/utils/CanvasBuffer"),i=a("../renderers/canvas/utils/CanvasGraphics"),j=a("./GraphicsData"),k=a("../math"),l=a("../const"),m=new k.Point;d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{}),d.prototype.clone=function(){var a=new d;a.renderable=this.renderable,a.fillAlpha=this.fillAlpha,a.lineWidth=this.lineWidth,a.lineColor=this.lineColor,a.tint=this.tint,a.blendMode=this.blendMode,a.isMask=this.isMask,a.boundsPadding=this.boundsPadding,a.dirty=this.dirty,a.glDirty=this.glDirty,a.cachedSpriteDirty=this.cachedSpriteDirty;for(var b=0;b<this.graphicsData.length;++b)a.graphicsData.push(this.graphicsData.clone());return a.currentPath=a.graphicsData[a.graphicsData.length-1],a.updateLocalBounds(),a},d.prototype.lineStyle=function(a,b,c){return this.lineWidth=a||0,this.lineColor=b||0,this.lineAlpha=arguments.length<3?1:c,this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new k.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha)),this},d.prototype.moveTo=function(a,b){return this.drawShape(new k.Polygon([a,b])),this},d.prototype.lineTo=function(a,b){return this.currentPath.shape.points.push(a,b),this.dirty=!0,this},d.prototype.quadraticCurveTo=function(a,b,c,d){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var e,f,g=20,h=this.currentPath.shape.points;0===h.length&&this.moveTo(0,0);for(var i=h[h.length-2],j=h[h.length-1],k=0,l=1;g>=l;++l)k=l/g,e=i+(a-i)*k,f=j+(b-j)*k,h.push(e+(a+(c-a)*k-e)*k,f+(b+(d-b)*k-f)*k);return this.dirty=!0,this},d.prototype.bezierCurveTo=function(a,b,c,d,e,f){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var g,h,i,j,k,l=20,m=this.currentPath.shape.points,n=m[m.length-2],o=m[m.length-1],p=0,q=1;l>=q;++q)p=q/l,g=1-p,h=g*g,i=h*g,j=p*p,k=j*p,m.push(i*n+3*h*p*a+3*g*j*c+k*e,i*o+3*h*p*b+3*g*j*d+k*f);return this.dirty=!0,this},d.prototype.arcTo=function(a,b,c,d,e){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(a,b):this.moveTo(a,b);var f=this.currentPath.shape.points,g=f[f.length-2],h=f[f.length-1],i=h-b,j=g-a,k=d-b,l=c-a,m=Math.abs(i*l-j*k);if(1e-8>m||0===e)(f[f.length-2]!==a||f[f.length-1]!==b)&&f.push(a,b);else{var n=i*i+j*j,o=k*k+l*l,p=i*k+j*l,q=e*Math.sqrt(n)/m,r=e*Math.sqrt(o)/m,s=q*p/n,t=r*p/o,u=q*l+r*j,v=q*k+r*i,w=j*(r+s),x=i*(r+s),y=l*(q+t),z=k*(q+t),A=Math.atan2(x-v,w-u),B=Math.atan2(z-v,y-u);this.arc(u+a,v+b,e,A,B,j*k>l*i)}return this.dirty=!0,this},d.prototype.arc=function(a,b,c,d,e,f){var g,h=a+Math.cos(d)*c,i=b+Math.sin(d)*c;if(this.currentPath?(g=this.currentPath.shape.points,0===g.length?g.push(h,i):(g[g.length-2]!==h||g[g.length-1]!==i)&&g.push(h,i)):(this.moveTo(h,i),g=this.currentPath.shape.points),d===e)return this;!f&&d>=e?e+=2*Math.PI:f&&e>=d&&(d+=2*Math.PI);var j=f?-1*(d-e):e-d,k=40*Math.ceil(Math.abs(j)/(2*Math.PI));if(0===j)return this;for(var l=j/(2*k),m=2*l,n=Math.cos(l),o=Math.sin(l),p=k-1,q=p%1/p,r=0;p>=r;r++){var s=r+q*r,t=l+d+m*s,u=Math.cos(t),v=-Math.sin(t);g.push((n*u+o*v)*c+a,(n*-v+o*u)*c+b)}return this.dirty=!0,this},d.prototype.beginFill=function(a,b){return this.filling=!0,this.fillColor=a||0,this.fillAlpha=void 0===b?1:b,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},d.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},d.prototype.drawRect=function(a,b,c,d){return this.drawShape(new k.Rectangle(a,b,c,d)),this},d.prototype.drawRoundedRect=function(a,b,c,d,e){return this.drawShape(new k.RoundedRectangle(a,b,c,d,e)),this},d.prototype.drawCircle=function(a,b,c){return this.drawShape(new k.Circle(a,b,c)),this},d.prototype.drawEllipse=function(a,b,c,d){return this.drawShape(new k.Ellipse(a,b,c,d)),this},d.prototype.drawPolygon=function(a){var b=a;if(!Array.isArray(b)){b=new Array(arguments.length);for(var c=0;c<b.length;++c)b[c]=arguments[c]}return this.drawShape(new k.Polygon(b)),this},d.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},d.prototype.generateTexture=function(a,b,c){b=b||1;var d=this.getLocalBounds(),e=new h(d.width*b,d.height*b),f=g.fromCanvas(e.canvas,c);return f.baseTexture.resolution=b,e.context.scale(b,b),e.context.translate(-d.x,-d.y),i.renderGraphics(this,e.context),f},d.prototype._renderWebGL=function(a){this.glDirty&&(this.dirty=!0,this.glDirty=!1),a.setObjectRenderer(a.plugins.graphics),a.plugins.graphics.render(this)},d.prototype._renderCanvas=function(a){if(this.isMask!==!0){if(this._prevTint!==this.tint&&(this.dirty=!0,this._prevTint=this.tint),this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,void f.prototype._renderCanvas.call(this._cachedSprite,a);var b=a.context,c=this.worldTransform;this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,b.globalCompositeOperation=a.blendModes[a.currentBlendMode]);var d=a.resolution;b.setTransform(c.a*d,c.b*d,c.c*d,c.d*d,c.tx*d,c.ty*d),i.renderGraphics(this,b)}},d.prototype.getBounds=function(a){if(!this._currentBounds){if(!this.renderable)return k.Rectangle.EMPTY;this.dirty&&(this.updateLocalBounds(),this.glDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var b=this._localBounds,c=b.x,d=b.width+b.x,e=b.y,f=b.height+b.y,g=a||this.worldTransform,h=g.a,i=g.b,j=g.c,l=g.d,m=g.tx,n=g.ty,o=h*d+j*f+m,p=l*f+i*d+n,q=h*c+j*f+m,r=l*f+i*c+n,s=h*c+j*e+m,t=l*e+i*c+n,u=h*d+j*e+m,v=l*e+i*d+n,w=o,x=p,y=o,z=p;y=y>q?q:y,y=y>s?s:y,y=y>u?u:y,z=z>r?r:z,z=z>t?t:z,z=z>v?v:z,w=q>w?q:w,w=s>w?s:w,w=u>w?u:w,x=r>x?r:x,x=t>x?t:x,x=v>x?v:x,this._bounds.x=y,this._bounds.width=w-y,this._bounds.y=z,this._bounds.height=x-z,this._currentBounds=this._bounds}return this._currentBounds},d.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,m);for(var b=this.graphicsData,c=0;c<b.length;c++){var d=b[c];if(d.fill&&d.shape&&d.shape.contains(m.x,m.y))return!0}return!1},d.prototype.updateLocalBounds=function(){var a=1/0,b=-(1/0),c=1/0,d=-(1/0);if(this.graphicsData.length)for(var e,f,g,h,i,j,k=0;k<this.graphicsData.length;k++){var m=this.graphicsData[k],n=m.type,o=m.lineWidth;if(e=m.shape,n===l.SHAPES.RECT||n===l.SHAPES.RREC)g=e.x-o/2,h=e.y-o/2,i=e.width+o,j=e.height+o,a=a>g?g:a,b=g+i>b?g+i:b,c=c>h?h:c,d=h+j>d?h+j:d;else if(n===l.SHAPES.CIRC)g=e.x,h=e.y,i=e.radius+o/2,j=e.radius+o/2,a=a>g-i?g-i:a,b=g+i>b?g+i:b,c=c>h-j?h-j:c,d=h+j>d?h+j:d;else if(n===l.SHAPES.ELIP)g=e.x,h=e.y,i=e.width+o/2,j=e.height+o/2,a=a>g-i?g-i:a,b=g+i>b?g+i:b,c=c>h-j?h-j:c,d=h+j>d?h+j:d;else{f=e.points;for(var p=0;p<f.length;p+=2)g=f[p],h=f[p+1],a=a>g-o?g-o:a,b=g+o>b?g+o:b,c=c>h-o?h-o:c,d=h+o>d?h+o:d}}else a=0,b=0,c=0,d=0;var q=this.boundsPadding;this._localBounds.x=a-q,this._localBounds.width=b-a+2*q,this._localBounds.y=c-q,this._localBounds.height=d-c+2*q},d.prototype.drawShape=function(a){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var b=new j(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,a);return this.graphicsData.push(b),b.type===l.SHAPES.POLY&&(b.shape.closed=this.filling,this.currentPath=b),this.dirty=!0,b}},{"../const":13,"../display/Container":14,"../math":23,"../renderers/canvas/utils/CanvasBuffer":35,"../renderers/canvas/utils/CanvasGraphics":36,"../sprites/Sprite":57,"../textures/Texture":62,"./GraphicsData":17}],17:[function(a,b,c){function d(a,b,c,d,e,f,g){this.lineWidth=a,this.lineColor=b,this.lineAlpha=c,this._lineTint=b,this.fillColor=d,this.fillAlpha=e,this._fillTint=d,this.fill=f,this.shape=g,this.type=g.type}d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)}},{}],18:[function(a,b,c){function d(a){h.call(this,a),this.graphicsDataPool=[],this.primitiveShader=null,this.complexPrimitiveShader=null}var e=a("../../utils"),f=a("../../math"),g=a("../../const"),h=a("../../renderers/webgl/utils/ObjectRenderer"),i=a("../../renderers/webgl/WebGLRenderer"),j=a("./WebGLGraphicsData");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,b.exports=d,i.registerPlugin("graphics",d),d.prototype.onContextChange=function(){},d.prototype.destroy=function(){h.prototype.destroy.call(this),this.graphicsDataPool=null},d.prototype.render=function(a){var b,c=this.renderer,d=c.gl,f=c.shaderManager.plugins.primitiveShader;a.dirty&&this.updateGraphics(a,d);var g=a._webGL[d.id];c.blendModeManager.setBlendMode(a.blendMode);for(var h=0;h<g.data.length;h++)1===g.data[h].mode?(b=g.data[h],c.stencilManager.pushStencil(a,b,c),d.drawElements(d.TRIANGLE_FAN,4,d.UNSIGNED_SHORT,2*(b.indices.length-4)),c.stencilManager.popStencil(a,b,c)):(b=g.data[h],f=c.shaderManager.primitiveShader,c.shaderManager.setShader(f),d.uniformMatrix3fv(f.uniforms.translationMatrix._location,!1,a.worldTransform.toArray(!0)),d.uniformMatrix3fv(f.uniforms.projectionMatrix._location,!1,c.currentRenderTarget.projectionMatrix.toArray(!0)),d.uniform3fv(f.uniforms.tint._location,e.hex2rgb(a.tint)),d.uniform1f(f.uniforms.alpha._location,a.worldAlpha),d.bindBuffer(d.ARRAY_BUFFER,b.buffer),d.vertexAttribPointer(f.attributes.aVertexPosition,2,d.FLOAT,!1,24,0),d.vertexAttribPointer(f.attributes.aColor,4,d.FLOAT,!1,24,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,b.indexBuffer),d.drawElements(d.TRIANGLE_STRIP,b.indices.length,d.UNSIGNED_SHORT,0))},d.prototype.updateGraphics=function(a){var b=this.renderer.gl,c=a._webGL[b.id];c||(c=a._webGL[b.id]={lastIndex:0,data:[],gl:b}),a.dirty=!1;var d;if(a.clearDirty){for(a.clearDirty=!1,d=0;d<c.data.length;d++){var e=c.data[d];e.reset(),this.graphicsDataPool.push(e)}c.data=[],c.lastIndex=0}var f;for(d=c.lastIndex;d<a.graphicsData.length;d++){var h=a.graphicsData[d];if(h.type===g.SHAPES.POLY){if(h.points=h.shape.points.slice(),h.shape.closed&&(h.points[0]!==h.points[h.points.length-2]||h.points[1]!==h.points[h.points.length-1])&&h.points.push(h.points[0],h.points[1]),h.fill&&h.points.length>=6)if(h.points.length<12){f=this.switchMode(c,0);var i=this.buildPoly(h,f);i||(f=this.switchMode(c,1),this.buildComplexPoly(h,f))}else f=this.switchMode(c,1),this.buildComplexPoly(h,f);h.lineWidth>0&&(f=this.switchMode(c,0),this.buildLine(h,f))}else f=this.switchMode(c,0),h.type===g.SHAPES.RECT?this.buildRectangle(h,f):h.type===g.SHAPES.CIRC||h.type===g.SHAPES.ELIP?this.buildCircle(h,f):h.type===g.SHAPES.RREC&&this.buildRoundedRectangle(h,f);c.lastIndex++}for(d=0;d<c.data.length;d++)f=c.data[d],f.dirty&&f.upload()},d.prototype.switchMode=function(a,b){var c;return a.data.length?(c=a.data[a.data.length-1],(c.points.length>32e4||c.mode!==b||1===b)&&(c=this.graphicsDataPool.pop()||new j(a.gl),c.mode=b,a.data.push(c))):(c=this.graphicsDataPool.pop()||new j(a.gl),c.mode=b,a.data.push(c)),c.dirty=!0,c},d.prototype.buildRectangle=function(a,b){var c=a.shape,d=c.x,f=c.y,g=c.width,h=c.height;if(a.fill){var i=e.hex2rgb(a.fillColor),j=a.fillAlpha,k=i[0]*j,l=i[1]*j,m=i[2]*j,n=b.points,o=b.indices,p=n.length/6;n.push(d,f),n.push(k,l,m,j),n.push(d+g,f),n.push(k,l,m,j),n.push(d,f+h),n.push(k,l,m,j),n.push(d+g,f+h),n.push(k,l,m,j),o.push(p,p,p+1,p+2,p+3,p+3)}if(a.lineWidth){var q=a.points;a.points=[d,f,d+g,f,d+g,f+h,d,f+h,d,f],this.buildLine(a,b),a.points=q}},d.prototype.buildRoundedRectangle=function(a,b){var c=a.shape,d=c.x,f=c.y,g=c.width,h=c.height,i=c.radius,j=[];if(j.push(d,f+i),this.quadraticBezierCurve(d,f+h-i,d,f+h,d+i,f+h,j),this.quadraticBezierCurve(d+g-i,f+h,d+g,f+h,d+g,f+h-i,j),this.quadraticBezierCurve(d+g,f+i,d+g,f,d+g-i,f,j),this.quadraticBezierCurve(d+i,f,d,f,d,f+i+1e-10,j),a.fill){var k=e.hex2rgb(a.fillColor),l=a.fillAlpha,m=k[0]*l,n=k[1]*l,o=k[2]*l,p=b.points,q=b.indices,r=p.length/6,s=e.PolyK.Triangulate(j),t=0;for(t=0;t<s.length;t+=3)q.push(s[t]+r),q.push(s[t]+r),q.push(s[t+1]+r),q.push(s[t+2]+r),q.push(s[t+2]+r);for(t=0;t<j.length;t++)p.push(j[t],j[++t],m,n,o,l)}if(a.lineWidth){var u=a.points;a.points=j,this.buildLine(a,b),a.points=u}},d.prototype.quadraticBezierCurve=function(a,b,c,d,e,f,g){function h(a,b,c){var d=b-a;return a+d*c}for(var i,j,k,l,m,n,o=20,p=g||[],q=0,r=0;o>=r;r++)q=r/o,i=h(a,c,q),j=h(b,d,q),k=h(c,e,q),l=h(d,f,q),m=h(i,k,q),n=h(j,l,q),p.push(m,n);return p},d.prototype.buildCircle=function(a,b){var c,d,f=a.shape,h=f.x,i=f.y;a.type===g.SHAPES.CIRC?(c=f.radius,d=f.radius):(c=f.width,d=f.height);var j=40,k=2*Math.PI/j,l=0;if(a.fill){var m=e.hex2rgb(a.fillColor),n=a.fillAlpha,o=m[0]*n,p=m[1]*n,q=m[2]*n,r=b.points,s=b.indices,t=r.length/6;for(s.push(t),l=0;j+1>l;l++)r.push(h,i,o,p,q,n),r.push(h+Math.sin(k*l)*c,i+Math.cos(k*l)*d,o,p,q,n),s.push(t++,t++);s.push(t-1)}if(a.lineWidth){var u=a.points;for(a.points=[],l=0;j+1>l;l++)a.points.push(h+Math.sin(k*l)*c,i+Math.cos(k*l)*d);this.buildLine(a,b),a.points=u}},d.prototype.buildLine=function(a,b){var c=0,d=a.points;if(0!==d.length){if(a.lineWidth%2)for(c=0;c<d.length;c++)d[c]+=.5;var g=new f.Point(d[0],d[1]),h=new f.Point(d[d.length-2],d[d.length-1]);if(g.x===h.x&&g.y===h.y){d=d.slice(),d.pop(),d.pop(),h=new f.Point(d[d.length-2],d[d.length-1]);var i=h.x+.5*(g.x-h.x),j=h.y+.5*(g.y-h.y);d.unshift(i,j),d.push(i,j)}var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=b.points,I=b.indices,J=d.length/2,K=d.length,L=H.length/6,M=a.lineWidth/2,N=e.hex2rgb(a.lineColor),O=a.lineAlpha,P=N[0]*O,Q=N[1]*O,R=N[2]*O;for(m=d[0],n=d[1],o=d[2],p=d[3],s=-(n-p),t=m-o,G=Math.sqrt(s*s+t*t),s/=G,t/=G,s*=M,t*=M,H.push(m-s,n-t,P,Q,R,O),H.push(m+s,n+t,P,Q,R,O),c=1;J-1>c;c++)m=d[2*(c-1)],n=d[2*(c-1)+1],o=d[2*c],p=d[2*c+1],q=d[2*(c+1)],r=d[2*(c+1)+1],s=-(n-p),t=m-o,G=Math.sqrt(s*s+t*t),s/=G,t/=G,s*=M,t*=M,u=-(p-r),v=o-q,G=Math.sqrt(u*u+v*v),u/=G,v/=G,u*=M,v*=M,y=-t+n-(-t+p),z=-s+o-(-s+m),A=(-s+m)*(-t+p)-(-s+o)*(-t+n),B=-v+r-(-v+p),C=-u+o-(-u+q),D=(-u+q)*(-v+p)-(-u+o)*(-v+r),E=y*C-B*z,Math.abs(E)<.1?(E+=10.1,H.push(o-s,p-t,P,Q,R,O),H.push(o+s,p+t,P,Q,R,O)):(k=(z*D-C*A)/E,l=(B*A-y*D)/E,F=(k-o)*(k-o)+(l-p)+(l-p),F>19600?(w=s-u,x=t-v,G=Math.sqrt(w*w+x*x),w/=G,x/=G,w*=M,x*=M,H.push(o-w,p-x),H.push(P,Q,R,O),H.push(o+w,p+x),H.push(P,Q,R,O),H.push(o-w,p-x),H.push(P,Q,R,O),K++):(H.push(k,l),H.push(P,Q,R,O),H.push(o-(k-o),p-(l-p)),H.push(P,Q,R,O)));for(m=d[2*(J-2)],n=d[2*(J-2)+1],o=d[2*(J-1)],p=d[2*(J-1)+1],s=-(n-p),t=m-o,G=Math.sqrt(s*s+t*t),s/=G,t/=G,s*=M,t*=M,H.push(o-s,p-t),H.push(P,Q,R,O),H.push(o+s,p+t),H.push(P,Q,R,O),I.push(L),c=0;K>c;c++)I.push(L++);I.push(L-1)}},d.prototype.buildComplexPoly=function(a,b){var c=a.points.slice();if(!(c.length<6)){var d=b.indices;b.points=c,b.alpha=a.fillAlpha,b.color=e.hex2rgb(a.fillColor);for(var f,g,h=1/0,i=-(1/0),j=1/0,k=-(1/0),l=0;l<c.length;l+=2)f=c[l],g=c[l+1],h=h>f?f:h,i=f>i?f:i,j=j>g?g:j,k=g>k?g:k;c.push(h,j,i,j,i,k,h,k);var m=c.length/2;for(l=0;m>l;l++)d.push(l)}},d.prototype.buildPoly=function(a,b){var c=a.points;if(!(c.length<6)){var d=b.points,f=b.indices,g=c.length/2,h=e.hex2rgb(a.fillColor),i=a.fillAlpha,j=h[0]*i,k=h[1]*i,l=h[2]*i,m=e.PolyK.Triangulate(c);if(!m)return!1;var n=d.length/6,o=0;for(o=0;o<m.length;o+=3)f.push(m[o]+n),f.push(m[o]+n),f.push(m[o+1]+n),f.push(m[o+2]+n),f.push(m[o+2]+n);for(o=0;g>o;o++)d.push(c[2*o],c[2*o+1],j,k,l,i);return!0}}},{"../../const":13,"../../math":23,"../../renderers/webgl/WebGLRenderer":39,"../../renderers/webgl/utils/ObjectRenderer":53,"../../utils":66,"./WebGLGraphicsData":19}],19:[function(a,b,c){function d(a){this.gl=a,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0}d.prototype.constructor=d,b.exports=d,d.prototype.reset=function(){this.points.length=0,this.indices.length=0},d.prototype.upload=function(){var a=this.gl;this.glPoints=new Float32Array(this.points),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.bufferData(a.ARRAY_BUFFER,this.glPoints,a.STATIC_DRAW),this.glIndices=new Uint16Array(this.indices),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.glIndices,a.STATIC_DRAW),this.dirty=!1}},{}],20:[function(a,b,c){var d=b.exports=Object.assign(a("./const"),a("./math"),{utils:a("./utils"),math:a("./math"),DisplayObject:a("./display/DisplayObject"),Container:a("./display/Container"),Sprite:a("./sprites/Sprite"),ParticleContainer:a("./particles/ParticleContainer"),SpriteRenderer:a("./sprites/webgl/SpriteRenderer"),ParticleRenderer:a("./particles/webgl/ParticleRenderer"),Text:a("./text/Text"),Graphics:a("./graphics/Graphics"),GraphicsData:a("./graphics/GraphicsData"),GraphicsRenderer:a("./graphics/webgl/GraphicsRenderer"),Texture:a("./textures/Texture"),BaseTexture:a("./textures/BaseTexture"),RenderTexture:a("./textures/RenderTexture"),VideoBaseTexture:a("./textures/VideoBaseTexture"),TextureUvs:a("./textures/TextureUvs"),CanvasRenderer:a("./renderers/canvas/CanvasRenderer"),CanvasGraphics:a("./renderers/canvas/utils/CanvasGraphics"),CanvasBuffer:a("./renderers/canvas/utils/CanvasBuffer"),WebGLRenderer:a("./renderers/webgl/WebGLRenderer"),ShaderManager:a("./renderers/webgl/managers/ShaderManager"),Shader:a("./renderers/webgl/shaders/Shader"),AbstractFilter:a("./renderers/webgl/filters/AbstractFilter"),autoDetectRenderer:function(a,b,c,e){return a=a||800,b=b||600,!e&&d.utils.isWebGLSupported()?new d.WebGLRenderer(a,b,c):new d.CanvasRenderer(a,b,c)}})},{"./const":13,"./display/Container":14,"./display/DisplayObject":15,"./graphics/Graphics":16,"./graphics/GraphicsData":17,"./graphics/webgl/GraphicsRenderer":18,"./math":23,"./particles/ParticleContainer":29,"./particles/webgl/ParticleRenderer":31,"./renderers/canvas/CanvasRenderer":34,"./renderers/canvas/utils/CanvasBuffer":35,"./renderers/canvas/utils/CanvasGraphics":36,"./renderers/webgl/WebGLRenderer":39,"./renderers/webgl/filters/AbstractFilter":40,"./renderers/webgl/managers/ShaderManager":46,"./renderers/webgl/shaders/Shader":51,"./sprites/Sprite":57,"./sprites/webgl/SpriteRenderer":58,"./text/Text":59,"./textures/BaseTexture":60,"./textures/RenderTexture":61,"./textures/Texture":62,"./textures/TextureUvs":63,"./textures/VideoBaseTexture":64,"./utils":66}],21:[function(a,b,c){function d(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var e=a("./Point");d.prototype.constructor=d,b.exports=d,d.prototype.fromArray=function(a){this.a=a[0],this.b=a[1],this.c=a[3],this.d=a[4],this.tx=a[2],this.ty=a[5]},d.prototype.toArray=function(a){this.array||(this.array=new Float32Array(9));var b=this.array;return a?(b[0]=this.a,b[1]=this.b,b[2]=0,b[3]=this.c,b[4]=this.d,b[5]=0,b[6]=this.tx,b[7]=this.ty,b[8]=1):(b[0]=this.a,b[1]=this.c,b[2]=this.tx,b[3]=this.b,b[4]=this.d,b[5]=this.ty,b[6]=0,b[7]=0,b[8]=1),b},d.prototype.apply=function(a,b){b=b||new e;var c=a.x,d=a.y;return b.x=this.a*c+this.c*d+this.tx,b.y=this.b*c+this.d*d+this.ty,b},d.prototype.applyInverse=function(a,b){b=b||new e;var c=1/(this.a*this.d+this.c*-this.b),d=a.x,f=a.y;return b.x=this.d*c*d+-this.c*c*f+(this.ty*this.c-this.tx*this.d)*c,b.y=this.a*c*f+-this.b*c*d+(-this.ty*this.a+this.tx*this.b)*c,b},d.prototype.translate=function(a,b){return this.tx+=a,this.ty+=b,this},d.prototype.scale=function(a,b){return this.a*=a,this.d*=b,this.c*=a,this.b*=b,this.tx*=a,this.ty*=b,this},d.prototype.rotate=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.c,f=this.tx;return this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b,this},d.prototype.append=function(a){var b=this.a,c=this.b,d=this.c,e=this.d;return this.a=a.a*b+a.b*d,this.b=a.a*c+a.b*e,this.c=a.c*b+a.d*d,this.d=a.c*c+a.d*e,this.tx=a.tx*b+a.ty*d+this.tx,this.ty=a.tx*c+a.ty*e+this.ty,this},d.prototype.prepend=function(a){var b=this.tx;if(1!==a.a||0!==a.b||0!==a.c||1!==a.d){var c=this.a,d=this.c;this.a=c*a.a+this.b*a.c,this.b=c*a.b+this.b*a.d,this.c=d*a.a+this.d*a.c,this.d=d*a.b+this.d*a.d}return this.tx=b*a.a+this.ty*a.c+a.tx,this.ty=b*a.b+this.ty*a.d+a.ty,this},d.prototype.invert=function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this},d.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},d.prototype.clone=function(){var a=new d;return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a},d.prototype.copy=function(a){return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a},d.IDENTITY=new d,d.TEMP_MATRIX=new d},{"./Point":22}],22:[function(a,b,c){function d(a,b){this.x=a||0,this.y=b||0}d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.x,this.y)},d.prototype.copy=function(a){this.set(a.x,a.y)},d.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},d.prototype.set=function(a,b){this.x=a||0,this.y=b||(0!==b?this.x:0)}},{}],23:[function(a,b,c){b.exports={Point:a("./Point"),Matrix:a("./Matrix"),Circle:a("./shapes/Circle"),Ellipse:a("./shapes/Ellipse"),Polygon:a("./shapes/Polygon"),Rectangle:a("./shapes/Rectangle"),RoundedRectangle:a("./shapes/RoundedRectangle")}},{"./Matrix":21,"./Point":22,"./shapes/Circle":24,"./shapes/Ellipse":25,"./shapes/Polygon":26,"./shapes/Rectangle":27,"./shapes/RoundedRectangle":28}],24:[function(a,b,c){function d(a,b,c){this.x=a||0,this.y=b||0,this.radius=c||0,this.type=f.SHAPES.CIRC}var e=a("./Rectangle"),f=a("../../const");d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.x,this.y,this.radius)},d.prototype.contains=function(a,b){if(this.radius<=0)return!1;var c=this.x-a,d=this.y-b,e=this.radius*this.radius;return c*=c,d*=d,e>=c+d},d.prototype.getBounds=function(){return new e(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}},{"../../const":13,"./Rectangle":27}],25:[function(a,b,c){function d(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0,this.type=f.SHAPES.ELIP}var e=a("./Rectangle"),f=a("../../const");d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height)},d.prototype.contains=function(a,b){if(this.width<=0||this.height<=0)return!1;var c=(a-this.x)/this.width,d=(b-this.y)/this.height;return c*=c,d*=d,1>=c+d},d.prototype.getBounds=function(){return new e(this.x-this.width,this.y-this.height,this.width,this.height)}},{"../../const":13,"./Rectangle":27}],26:[function(a,b,c){function d(a){var b=a;if(!Array.isArray(b)){b=new Array(arguments.length);for(var c=0;c<b.length;++c)b[c]=arguments[c]}if(b[0]instanceof e){for(var d=[],g=0,h=b.length;h>g;g++)d.push(b[g].x,b[g].y);b=d}this.closed=!0,this.points=b,this.type=f.SHAPES.POLY}var e=a("../Point"),f=a("../../const");d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.points.slice())},d.prototype.contains=function(a,b){for(var c=!1,d=this.points.length/2,e=0,f=d-1;d>e;f=e++){var g=this.points[2*e],h=this.points[2*e+1],i=this.points[2*f],j=this.points[2*f+1],k=h>b!=j>b&&(i-g)*(b-h)/(j-h)+g>a;k&&(c=!c)}return c}},{"../../const":13,"../Point":22}],27:[function(a,b,c){function d(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0,this.type=e.SHAPES.RECT}var e=a("../../const");d.prototype.constructor=d,b.exports=d,d.EMPTY=new d(0,0,0,0),d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height)},d.prototype.contains=function(a,b){return this.width<=0||this.height<=0?!1:a>=this.x&&a<this.x+this.width&&b>=this.y&&b<this.y+this.height?!0:!1}},{"../../const":13}],28:[function(a,b,c){function d(a,b,c,d,f){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0,this.radius=f||20,this.type=e.SHAPES.RREC}var e=a("../../const");d.prototype.constructor=d,b.exports=d,d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height,this.radius)},d.prototype.contains=function(a,b){return this.width<=0||this.height<=0?!1:a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<=this.y+this.height?!0:!1}},{"../../const":13}],29:[function(a,b,c){function d(a,b){e.call(this),this._properties=[!1,!0,!1,!1,!1],this._size=a||15e3,this._buffers=null,this._updateStatic=!1,this.interactiveChildren=!1,this.setProperties(b);

}var e=a("../display/Container");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.setProperties=function(a){a&&(this._properties[0]="scale"in a?!!a.scale:this._properties[0],this._properties[1]="position"in a?!!a.position:this._properties[1],this._properties[2]="rotation"in a?!!a.rotation:this._properties[2],this._properties[3]="uvs"in a?!!a.uvs:this._properties[3],this._properties[4]="alpha"in a?!!a.alpha:this._properties[4])},d.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},d.prototype.renderWebGL=function(a){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(a.setObjectRenderer(a.plugins.particle),a.plugins.particle.render(this))},d.prototype.addChildAt=function(a,b){if(a===this)return a;if(b>=0&&b<=this.children.length)return a.parent&&a.parent.removeChild(a),a.parent=this,this.children.splice(b,0,a),this._updateStatic=!0,a;throw new Error(a+"addChildAt: The index "+b+" supplied is out of bounds "+this.children.length)},d.prototype.removeChildAt=function(a){var b=this.getChildAt(a);return b.parent=null,this.children.splice(a,1),this._updateStatic=!0,b},d.prototype.renderCanvas=function(a){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var b=a.context,c=this.worldTransform,d=!0;b.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var e=0;e<this.children.length;++e){var f=this.children[e];if(f.visible){var g=f.texture.frame;if(b.globalAlpha=this.worldAlpha*f.alpha,f.rotation%(2*Math.PI)===0)d&&(b.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),d=!1),b.drawImage(f.texture.baseTexture.source,g.x,g.y,g.width,g.height,f.anchor.x*-g.width*f.scale.x+f.position.x+.5|0,f.anchor.y*-g.height*f.scale.y+f.position.y+.5|0,g.width*f.scale.x,g.height*f.scale.y);else{d||(d=!0),f.displayObjectUpdateTransform();var h=f.worldTransform;a.roundPixels?b.setTransform(h.a,h.b,h.c,h.d,0|h.tx,0|h.ty):b.setTransform(h.a,h.b,h.c,h.d,h.tx,h.ty),b.drawImage(f.texture.baseTexture.source,g.x,g.y,g.width,g.height,f.anchor.x*-g.width+.5|0,f.anchor.y*-g.height+.5|0,g.width,g.height)}}}}}},{"../display/Container":14}],30:[function(a,b,c){function d(a,b,c){this.gl=a,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=c,this.dynamicProperties=[],this.staticProperties=[];for(var d=0;d<b.length;d++){var e=b[d];e.dynamic?this.dynamicProperties.push(e):this.staticProperties.push(e)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}d.prototype.constructor=d,b.exports=d,d.prototype.initBuffers=function(){var a,b,c=this.gl,d=0;for(this.dynamicStride=0,a=0;a<this.dynamicProperties.length;a++)b=this.dynamicProperties[a],b.offset=d,d+=b.size,this.dynamicStride+=b.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,this.dynamicBuffer),c.bufferData(c.ARRAY_BUFFER,this.dynamicData,c.DYNAMIC_DRAW);var e=0;for(this.staticStride=0,a=0;a<this.staticProperties.length;a++)b=this.staticProperties[a],b.offset=e,e+=b.size,this.staticStride+=b.size;this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,this.staticBuffer),c.bufferData(c.ARRAY_BUFFER,this.staticData,c.DYNAMIC_DRAW)},d.prototype.uploadDynamic=function(a,b,c){for(var d=this.gl,e=0;e<this.dynamicProperties.length;e++){var f=this.dynamicProperties[e];f.uploadFunction(a,b,c,this.dynamicData,this.dynamicStride,f.offset)}d.bindBuffer(d.ARRAY_BUFFER,this.dynamicBuffer),d.bufferSubData(d.ARRAY_BUFFER,0,this.dynamicData)},d.prototype.uploadStatic=function(a,b,c){for(var d=this.gl,e=0;e<this.staticProperties.length;e++){var f=this.staticProperties[e];f.uploadFunction(a,b,c,this.staticData,this.staticStride,f.offset)}d.bindBuffer(d.ARRAY_BUFFER,this.staticBuffer),d.bufferSubData(d.ARRAY_BUFFER,0,this.staticData)},d.prototype.bind=function(){var a,b,c=this.gl;for(c.bindBuffer(c.ARRAY_BUFFER,this.dynamicBuffer),a=0;a<this.dynamicProperties.length;a++)b=this.dynamicProperties[a],c.vertexAttribPointer(b.attribute,b.size,c.FLOAT,!1,4*this.dynamicStride,4*b.offset);for(c.bindBuffer(c.ARRAY_BUFFER,this.staticBuffer),a=0;a<this.staticProperties.length;a++)b=this.staticProperties[a],c.vertexAttribPointer(b.attribute,b.size,c.FLOAT,!1,4*this.staticStride,4*b.offset)},d.prototype.destroy=function(){}},{}],31:[function(a,b,c){function d(a){e.call(this,a),this.size=15e3;var b=6*this.size;this.indices=new Uint16Array(b);for(var c=0,d=0;b>c;c+=6,d+=4)this.indices[c+0]=d+0,this.indices[c+1]=d+1,this.indices[c+2]=d+2,this.indices[c+3]=d+0,this.indices[c+4]=d+2,this.indices[c+5]=d+3;this.shader=null,this.tempMatrix=new i.Matrix}var e=a("../../renderers/webgl/utils/ObjectRenderer"),f=a("../../renderers/webgl/WebGLRenderer"),g=a("./ParticleShader"),h=a("./ParticleBuffer"),i=a("../../math");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,f.registerPlugin("particle",d),d.prototype.onContextChange=function(){var a=this.renderer.gl;this.shader=new g(this.renderer.shaderManager),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),this.properties=[{attribute:this.shader.attributes.aVertexPosition,dynamic:!1,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,dynamic:!0,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,dynamic:!1,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,dynamic:!1,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,dynamic:!1,size:1,uploadFunction:this.uploadAlpha,offset:0}]},d.prototype.start=function(){var a=this.renderer.gl;a.activeTexture(a.TEXTURE0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.shader;this.renderer.shaderManager.setShader(b)},d.prototype.render=function(a){var b=a.children,c=b.length,d=a._size;if(0!==c){c>d&&(c=d),a._buffers||(a._buffers=this.generateBuffers(a));var e=this.renderer.gl,f=a.worldTransform.copy(this.tempMatrix);f.prepend(this.renderer.currentRenderTarget.projectionMatrix),e.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location,!1,f.toArray(!0));var g=a._updateStatic,h=b[0]._texture.baseTexture;h._glTextures[e.id]?e.bindTexture(e.TEXTURE_2D,h._glTextures[e.id]):(this.renderer.updateTexture(h),this.properties[0].dynamic&&this.properties[3].dynamic||(g=!0));for(var i=0,j=0;c>j;j+=this.size){var k=c-j;k>this.size&&(k=this.size);var l=a._buffers[i++];l.uploadDynamic(b,j,k),g&&l.uploadStatic(b,j,k),l.bind(this.shader),e.drawElements(e.TRIANGLES,6*k,e.UNSIGNED_SHORT,0),this.renderer.drawCount++}a._updateStatic=!1}},d.prototype.generateBuffers=function(a){var b,c=this.renderer.gl,d=[],e=a._size;for(b=0;b<a._properties.length;b++)this.properties[b].dynamic=a._properties[b];for(b=0;e>b;b+=this.size)d.push(new h(c,this.properties,this.size,this.shader));return d},d.prototype.uploadVertices=function(a,b,c,d,e,f){for(var g,h,i,j,k,l,m,n,o,p=0;c>p;p++)g=a[b+p],h=g._texture,j=g.scale.x,k=g.scale.y,h.trim?(i=h.trim,m=i.x-g.anchor.x*i.width,l=m+h.crop.width,o=i.y-g.anchor.y*i.height,n=o+h.crop.height):(l=h._frame.width*(1-g.anchor.x),m=h._frame.width*-g.anchor.x,n=h._frame.height*(1-g.anchor.y),o=h._frame.height*-g.anchor.y),d[f]=m*j,d[f+1]=o*k,d[f+e]=l*j,d[f+e+1]=o*k,d[f+2*e]=l*j,d[f+2*e+1]=n*k,d[f+3*e]=m*j,d[f+3*e+1]=n*k,f+=4*e},d.prototype.uploadPosition=function(a,b,c,d,e,f){for(var g=0;c>g;g++){var h=a[b+g].position;d[f]=h.x,d[f+1]=h.y,d[f+e]=h.x,d[f+e+1]=h.y,d[f+2*e]=h.x,d[f+2*e+1]=h.y,d[f+3*e]=h.x,d[f+3*e+1]=h.y,f+=4*e}},d.prototype.uploadRotation=function(a,b,c,d,e,f){for(var g=0;c>g;g++){var h=a[b+g].rotation;d[f]=h,d[f+e]=h,d[f+2*e]=h,d[f+3*e]=h,f+=4*e}},d.prototype.uploadUvs=function(a,b,c,d,e,f){for(var g=0;c>g;g++){var h=a[b+g]._texture._uvs;h?(d[f]=h.x0,d[f+1]=h.y0,d[f+e]=h.x1,d[f+e+1]=h.y1,d[f+2*e]=h.x2,d[f+2*e+1]=h.y2,d[f+3*e]=h.x3,d[f+3*e+1]=h.y3,f+=4*e):(d[f]=0,d[f+1]=0,d[f+e]=0,d[f+e+1]=0,d[f+2*e]=0,d[f+2*e+1]=0,d[f+3*e]=0,d[f+3*e+1]=0,f+=4*e)}},d.prototype.uploadAlpha=function(a,b,c,d,e,f){for(var g=0;c>g;g++){var h=a[b+g].alpha;d[f]=h,d[f+e]=h,d[f+2*e]=h,d[f+3*e]=h,f+=4*e}},d.prototype.destroy=function(){this.shader.destroy()}},{"../../math":23,"../../renderers/webgl/WebGLRenderer":39,"../../renderers/webgl/utils/ObjectRenderer":53,"./ParticleBuffer":30,"./ParticleShader":32}],32:[function(a,b,c){function d(a){e.call(this,a,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n"),null,{aPositionCoord:0,aRotation:0})}var e=a("../../renderers/webgl/shaders/TextureShader");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"../../renderers/webgl/shaders/TextureShader":52}],33:[function(a,b,c){function d(a,b,c,d){if(h.call(this),e.sayHello(a),d)for(var i in g.DEFAULT_RENDER_OPTIONS)"undefined"==typeof d[i]&&(d[i]=g.DEFAULT_RENDER_OPTIONS[i]);else d=g.DEFAULT_RENDER_OPTIONS;this.type=g.RENDERER_TYPE.UNKNOWN,this.width=b||800,this.height=c||600,this.view=d.view||document.createElement("canvas"),this.resolution=d.resolution,this.transparent=d.transparent,this.autoResize=d.autoResize||!1,this.blendModes=null,this.preserveDrawingBuffer=d.preserveDrawingBuffer,this.clearBeforeRender=d.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgb=[0,0,0],this._backgroundColorString="#000000",this.backgroundColor=d.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent={worldTransform:new f.Matrix,worldAlpha:1,children:[]},this._lastObjectRendered=this._tempDisplayObjectParent}var e=a("../utils"),f=a("../math"),g=a("../const"),h=a("eventemitter3").EventEmitter;d.prototype=Object.create(h.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a,this._backgroundColorString=e.hex2string(a),e.hex2rgb(a,this._backgroundColorRgb)}}}),d.prototype.resize=function(a,b){this.width=a*this.resolution,this.height=b*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},d.prototype.destroy=function(a){a&&this.view.parent&&this.view.parent.removeChild(this.view),this.type=g.RENDERER_TYPE.UNKNOWN,this.width=0,this.height=0,this.view=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgb=null,this._backgroundColorString=null}},{"../const":13,"../math":23,"../utils":66,eventemitter3:4}],34:[function(a,b,c){function d(a,b,c){e.call(this,"Canvas",a,b,c),this.type=i.RENDERER_TYPE.CANVAS,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.maskManager=new f,this.roundPixels=!1,this.currentScaleMode=i.SCALE_MODES.DEFAULT,this.currentBlendMode=i.BLEND_MODES.NORMAL,this.smoothProperty="imageSmoothingEnabled",this.context.imageSmoothingEnabled||(this.context.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.context.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.context.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.context.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(),this._mapBlendModes(),this._tempDisplayObjectParent={worldTransform:new h.Matrix,worldAlpha:1},this.resize(a,b)}var e=a("../SystemRenderer"),f=a("./utils/CanvasMaskManager"),g=a("../../utils"),h=a("../../math"),i=a("../../const");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,g.pluginTarget.mixin(d),d.prototype.render=function(a){var b=a.parent;this._lastObjectRendered=a,a.parent=this._tempDisplayObjectParent,a.updateTransform(),a.parent=b,this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.currentBlendMode=i.BLEND_MODES.NORMAL,this.context.globalCompositeOperation=this.blendModes[i.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=this._backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(a,this.context)},d.prototype.destroy=function(a){this.destroyPlugins(),e.prototype.destroy.call(this,a),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.roundPixels=!1,this.currentScaleMode=0,this.currentBlendMode=0,this.smoothProperty=null},d.prototype.renderDisplayObject=function(a,b){var c=this.context;this.context=b,a.renderCanvas(this),this.context=c},d.prototype._mapBlendModes=function(){this.blendModes||(this.blendModes={},g.canUseNewCanvasBlendModes()?(this.blendModes[i.BLEND_MODES.NORMAL]="source-over",this.blendModes[i.BLEND_MODES.ADD]="lighter",this.blendModes[i.BLEND_MODES.MULTIPLY]="multiply",this.blendModes[i.BLEND_MODES.SCREEN]="screen",this.blendModes[i.BLEND_MODES.OVERLAY]="overlay",this.blendModes[i.BLEND_MODES.DARKEN]="darken",this.blendModes[i.BLEND_MODES.LIGHTEN]="lighten",this.blendModes[i.BLEND_MODES.COLOR_DODGE]="color-dodge",this.blendModes[i.BLEND_MODES.COLOR_BURN]="color-burn",this.blendModes[i.BLEND_MODES.HARD_LIGHT]="hard-light",this.blendModes[i.BLEND_MODES.SOFT_LIGHT]="soft-light",this.blendModes[i.BLEND_MODES.DIFFERENCE]="difference",this.blendModes[i.BLEND_MODES.EXCLUSION]="exclusion",this.blendModes[i.BLEND_MODES.HUE]="hue",this.blendModes[i.BLEND_MODES.SATURATION]="saturation",this.blendModes[i.BLEND_MODES.COLOR]="color",this.blendModes[i.BLEND_MODES.LUMINOSITY]="luminosity"):(this.blendModes[i.BLEND_MODES.NORMAL]="source-over",this.blendModes[i.BLEND_MODES.ADD]="lighter",this.blendModes[i.BLEND_MODES.MULTIPLY]="source-over",this.blendModes[i.BLEND_MODES.SCREEN]="source-over",this.blendModes[i.BLEND_MODES.OVERLAY]="source-over",this.blendModes[i.BLEND_MODES.DARKEN]="source-over",this.blendModes[i.BLEND_MODES.LIGHTEN]="source-over",this.blendModes[i.BLEND_MODES.COLOR_DODGE]="source-over",this.blendModes[i.BLEND_MODES.COLOR_BURN]="source-over",this.blendModes[i.BLEND_MODES.HARD_LIGHT]="source-over",this.blendModes[i.BLEND_MODES.SOFT_LIGHT]="source-over",this.blendModes[i.BLEND_MODES.DIFFERENCE]="source-over",this.blendModes[i.BLEND_MODES.EXCLUSION]="source-over",this.blendModes[i.BLEND_MODES.HUE]="source-over",this.blendModes[i.BLEND_MODES.SATURATION]="source-over",this.blendModes[i.BLEND_MODES.COLOR]="source-over",this.blendModes[i.BLEND_MODES.LUMINOSITY]="source-over"))}},{"../../const":13,"../../math":23,"../../utils":66,"../SystemRenderer":33,"./utils/CanvasMaskManager":37}],35:[function(a,b,c){function d(a,b){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=a,this.canvas.height=b}d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{width:{get:function(){return this.canvas.width},set:function(a){this.canvas.width=a}},height:{get:function(){return this.canvas.height},set:function(a){this.canvas.height=a}}}),d.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},d.prototype.resize=function(a,b){this.canvas.width=a,this.canvas.height=b},d.prototype.destroy=function(){this.context=null,this.canvas=null}},{}],36:[function(a,b,c){var d=a("../../../const"),e=b.exports={};e.renderGraphics=function(a,b){var c=a.worldAlpha;a.dirty&&(this.updateGraphicsTint(a),a.dirty=!1);for(var e=0;e<a.graphicsData.length;e++){var f=a.graphicsData[e],g=f.shape,h=f._fillTint,i=f._lineTint;if(b.lineWidth=f.lineWidth,f.type===d.SHAPES.POLY){b.beginPath();var j=g.points;b.moveTo(j[0],j[1]);for(var k=1;k<j.length/2;k++)b.lineTo(j[2*k],j[2*k+1]);g.closed&&b.lineTo(j[0],j[1]),j[0]===j[j.length-2]&&j[1]===j[j.length-1]&&b.closePath(),f.fill&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke())}else if(f.type===d.SHAPES.RECT)(f.fillColor||0===f.fillColor)&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fillRect(g.x,g.y,g.width,g.height)),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.strokeRect(g.x,g.y,g.width,g.height));else if(f.type===d.SHAPES.CIRC)b.beginPath(),b.arc(g.x,g.y,g.radius,0,2*Math.PI),b.closePath(),f.fill&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke());else if(f.type===d.SHAPES.ELIP){var l=2*g.width,m=2*g.height,n=g.x-l/2,o=g.y-m/2;b.beginPath();var p=.5522848,q=l/2*p,r=m/2*p,s=n+l,t=o+m,u=n+l/2,v=o+m/2;b.moveTo(n,v),b.bezierCurveTo(n,v-r,u-q,o,u,o),b.bezierCurveTo(u+q,o,s,v-r,s,v),b.bezierCurveTo(s,v+r,u+q,t,u,t),b.bezierCurveTo(u-q,t,n,v+r,n,v),b.closePath(),f.fill&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke())}else if(f.type===d.SHAPES.RREC){var w=g.x,x=g.y,y=g.width,z=g.height,A=g.radius,B=Math.min(y,z)/2|0;A=A>B?B:A,b.beginPath(),b.moveTo(w,x+A),b.lineTo(w,x+z-A),b.quadraticCurveTo(w,x+z,w+A,x+z),b.lineTo(w+y-A,x+z),b.quadraticCurveTo(w+y,x+z,w+y,x+z-A),b.lineTo(w+y,x+A),b.quadraticCurveTo(w+y,x,w+y-A,x),b.lineTo(w+A,x),b.quadraticCurveTo(w,x,w,x+A),b.closePath(),(f.fillColor||0===f.fillColor)&&(b.globalAlpha=f.fillAlpha*c,b.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),b.fill()),f.lineWidth&&(b.globalAlpha=f.lineAlpha*c,b.strokeStyle="#"+("00000"+(0|i).toString(16)).substr(-6),b.stroke())}}},e.renderGraphicsMask=function(a,b){var c=a.graphicsData.length;if(0!==c){b.beginPath();for(var e=0;c>e;e++){var f=a.graphicsData[e],g=f.shape;if(f.type===d.SHAPES.POLY){var h=g.points;b.moveTo(h[0],h[1]);for(var i=1;i<h.length/2;i++)b.lineTo(h[2*i],h[2*i+1]);h[0]===h[h.length-2]&&h[1]===h[h.length-1]&&b.closePath()}else if(f.type===d.SHAPES.RECT)b.rect(g.x,g.y,g.width,g.height),b.closePath();else if(f.type===d.SHAPES.CIRC)b.arc(g.x,g.y,g.radius,0,2*Math.PI),b.closePath();else if(f.type===d.SHAPES.ELIP){var j=2*g.width,k=2*g.height,l=g.x-j/2,m=g.y-k/2,n=.5522848,o=j/2*n,p=k/2*n,q=l+j,r=m+k,s=l+j/2,t=m+k/2;b.moveTo(l,t),b.bezierCurveTo(l,t-p,s-o,m,s,m),b.bezierCurveTo(s+o,m,q,t-p,q,t),b.bezierCurveTo(q,t+p,s+o,r,s,r),b.bezierCurveTo(s-o,r,l,t+p,l,t),b.closePath()}else if(f.type===d.SHAPES.RREC){var u=g.x,v=g.y,w=g.width,x=g.height,y=g.radius,z=Math.min(w,x)/2|0;y=y>z?z:y,b.moveTo(u,v+y),b.lineTo(u,v+x-y),b.quadraticCurveTo(u,v+x,u+y,v+x),b.lineTo(u+w-y,v+x),b.quadraticCurveTo(u+w,v+x,u+w,v+x-y),b.lineTo(u+w,v+y),b.quadraticCurveTo(u+w,v,u+w-y,v),b.lineTo(u+y,v),b.quadraticCurveTo(u,v,u,v+y),b.closePath()}}}},e.updateGraphicsTint=function(a){if(16777215!==a.tint)for(var b=(a.tint>>16&255)/255,c=(a.tint>>8&255)/255,d=(255&a.tint)/255,e=0;e<a.graphicsData.length;e++){var f=a.graphicsData[e],g=0|f.fillColor,h=0|f.lineColor;f._fillTint=((g>>16&255)/255*b*255<<16)+((g>>8&255)/255*c*255<<8)+(255&g)/255*d*255,f._lineTint=((h>>16&255)/255*b*255<<16)+((h>>8&255)/255*c*255<<8)+(255&h)/255*d*255}}},{"../../../const":13}],37:[function(a,b,c){function d(){}var e=a("./CanvasGraphics");d.prototype.constructor=d,b.exports=d,d.prototype.pushMask=function(a,b){b.context.save();var c=a.alpha,d=a.worldTransform,f=b.resolution;b.context.setTransform(d.a*f,d.b*f,d.c*f,d.d*f,d.tx*f,d.ty*f),a.texture||(e.renderGraphicsMask(a,b.context),b.context.clip()),a.worldAlpha=c},d.prototype.popMask=function(a){a.context.restore()}},{"./CanvasGraphics":36}],38:[function(a,b,c){var d=a("../../../utils"),e=b.exports={};e.getTintedTexture=function(a,b){var c=a.texture;b=e.roundColor(b);var d="#"+("00000"+(0|b).toString(16)).substr(-6);if(c.tintCache=c.tintCache||{},c.tintCache[d])return c.tintCache[d];var f=e.canvas||document.createElement("canvas");if(e.tintMethod(c,b,f),e.convertTintToImage){var g=new Image;g.src=f.toDataURL(),c.tintCache[d]=g}else c.tintCache[d]=f,e.canvas=null;return f},e.tintWithMultiply=function(a,b,c){var d=c.getContext("2d"),e=a.crop;c.width=e.width,c.height=e.height,d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,e.width,e.height),d.globalCompositeOperation="multiply",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height),d.globalCompositeOperation="destination-atop",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.tintWithOverlay=function(a,b,c){var d=c.getContext("2d"),e=a.crop;c.width=e.width,c.height=e.height,d.globalCompositeOperation="copy",d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,e.width,e.height),d.globalCompositeOperation="destination-atop",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.tintWithPerPixel=function(a,b,c){var e=c.getContext("2d"),f=a.crop;c.width=f.width,c.height=f.height,e.globalCompositeOperation="copy",e.drawImage(a.baseTexture.source,f.x,f.y,f.width,f.height,0,0,f.width,f.height);for(var g=d.hex2rgb(b),h=g[0],i=g[1],j=g[2],k=e.getImageData(0,0,f.width,f.height),l=k.data,m=0;m<l.length;m+=4)l[m+0]*=h,l[m+1]*=i,l[m+2]*=j;e.putImageData(k,0,0)},e.roundColor=function(a){var b=e.cacheStepsPerColorChannel,c=d.hex2rgb(a);return c[0]=Math.min(255,c[0]/b*b),c[1]=Math.min(255,c[1]/b*b),c[2]=Math.min(255,c[2]/b*b),d.rgb2hex(c)},e.cacheStepsPerColorChannel=8,e.convertTintToImage=!1,e.canUseMultiply=d.canUseNewCanvasBlendModes(),e.tintMethod=e.canUseMultiply?e.tintWithMultiply:e.tintWithPerPixel},{"../../../utils":66}],39:[function(a,b,c){function d(a,b,c){c=c||{},e.call(this,"WebGL",a,b,c),this.type=o.RENDERER_TYPE.WEBGL,this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.handleContextLost,!1),this.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this._useFXAA=!!c.forceFXAA&&c.antialias,this._FXAAFilter=null,this._contextOptions={alpha:this.transparent,antialias:c.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:c.preserveDrawingBuffer},this.drawCount=0,this.shaderManager=new f(this),this.maskManager=new g(this),this.stencilManager=new h(this),this.filterManager=new i(this),this.blendModeManager=new j(this),this.currentRenderTarget=null,this.currentRenderer=new l(this),this.initPlugins(),this._initContext(),this._mapBlendModes(),this._renderTargetStack=[]}var e=a("../SystemRenderer"),f=a("./managers/ShaderManager"),g=a("./managers/MaskManager"),h=a("./managers/StencilManager"),i=a("./managers/FilterManager"),j=a("./managers/BlendModeManager"),k=a("./utils/RenderTarget"),l=a("./utils/ObjectRenderer"),m=a("./filters/FXAAFilter"),n=a("../../utils"),o=a("../../const");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,n.pluginTarget.mixin(d),d.glContextId=0,d.prototype._initContext=function(){var a=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=a,!a)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=d.glContextId++,a.id=this.glContextId,a.renderer=this,a.disable(a.DEPTH_TEST),a.disable(a.CULL_FACE),a.enable(a.BLEND),this.renderTarget=new k(this.gl,this.width,this.height,null,this.resolution,!0),this.setRenderTarget(this.renderTarget),this.emit("context",a),this.resize(this.width,this.height),this._useFXAA||(this._useFXAA=this._contextOptions.antialias&&!a.getContextAttributes().antialias),this._useFXAA&&(window.console.warn("FXAA antialiasing being used instead of native antialiasing"),this._FXAAFilter=[new m])},d.prototype.render=function(a){if(!this.gl.isContextLost()){this._lastObjectRendered=a,this._useFXAA&&(this._FXAAFilter[0].uniforms.resolution.value.x=this.width,this._FXAAFilter[0].uniforms.resolution.value.y=this.height,a.filterArea=this.renderTarget.size,a.filters=this._FXAAFilter);var b=a.parent;a.parent=this._tempDisplayObjectParent,a.updateTransform(),a.parent=b;var c=this.gl;this.setRenderTarget(this.renderTarget),this.clearBeforeRender&&(this.transparent?c.clearColor(0,0,0,0):c.clearColor(this._backgroundColorRgb[0],this._backgroundColorRgb[1],this._backgroundColorRgb[2],1),c.clear(c.COLOR_BUFFER_BIT)),this.renderDisplayObject(a,this.renderTarget)}},d.prototype.renderDisplayObject=function(a,b,c){this.setRenderTarget(b),c&&b.clear(),this.filterManager.setFilterStack(b.filterStack),a.renderWebGL(this),this.currentRenderer.flush()},d.prototype.setObjectRenderer=function(a){this.currentRenderer!==a&&(this.currentRenderer.stop(),this.currentRenderer=a,this.currentRenderer.start())},d.prototype.setRenderTarget=function(a){this.currentRenderTarget!==a&&(this.currentRenderTarget=a,this.currentRenderTarget.activate(),this.stencilManager.setMaskStack(a.stencilMaskStack))},d.prototype.resize=function(a,b){e.prototype.resize.call(this,a,b),this.filterManager.resize(a,b),this.renderTarget.resize(a,b),this.currentRenderTarget===this.renderTarget&&this.renderTarget.activate()},d.prototype.updateTexture=function(a){if(a=a.baseTexture||a,a.hasLoaded){var b=this.gl;return a._glTextures[b.id]||(a._glTextures[b.id]=b.createTexture(),a.on("update",this.updateTexture,this),a.on("dispose",this.destroyTexture,this)),b.bindTexture(b.TEXTURE_2D,a._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultipliedAlpha),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a.scaleMode===o.SCALE_MODES.LINEAR?b.LINEAR:b.NEAREST),a.mipmap&&a.isPowerOfTwo?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===o.SCALE_MODES.LINEAR?b.LINEAR_MIPMAP_LINEAR:b.NEAREST_MIPMAP_NEAREST),b.generateMipmap(b.TEXTURE_2D)):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===o.SCALE_MODES.LINEAR?b.LINEAR:b.NEAREST),a.isPowerOfTwo?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),a._glTextures[b.id]}},d.prototype.destroyTexture=function(a){a=a.baseTexture||a,a.hasLoaded&&a._glTextures[this.gl.id]&&this.gl.deleteTexture(a._glTextures[this.gl.id])},d.prototype.handleContextLost=function(a){a.preventDefault()},d.prototype.handleContextRestored=function(){this._initContext();for(var a in n.BaseTextureCache)n.BaseTextureCache[a]._glTextures.length=0},d.prototype.destroy=function(a){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),e.prototype.destroy.call(this,a),this.uuid=0,this.shaderManager.destroy(),this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.maskManager=null,this.filterManager=null,this.blendModeManager=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.drawCount=0,this.gl=null},d.prototype._mapBlendModes=function(){var a=this.gl;this.blendModes||(this.blendModes={},this.blendModes[o.BLEND_MODES.NORMAL]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.ADD]=[a.SRC_ALPHA,a.DST_ALPHA],this.blendModes[o.BLEND_MODES.MULTIPLY]=[a.DST_COLOR,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.SCREEN]=[a.SRC_ALPHA,a.ONE],this.blendModes[o.BLEND_MODES.OVERLAY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.DARKEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.LIGHTEN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.COLOR_DODGE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.COLOR_BURN]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.HARD_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.SOFT_LIGHT]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.DIFFERENCE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.EXCLUSION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.HUE]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.SATURATION]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.COLOR]=[a.ONE,a.ONE_MINUS_SRC_ALPHA],this.blendModes[o.BLEND_MODES.LUMINOSITY]=[a.ONE,a.ONE_MINUS_SRC_ALPHA])}},{"../../const":13,"../../utils":66,"../SystemRenderer":33,"./filters/FXAAFilter":41,"./managers/BlendModeManager":43,"./managers/FilterManager":44,"./managers/MaskManager":45,"./managers/ShaderManager":46,"./managers/StencilManager":47,"./utils/ObjectRenderer":53,"./utils/RenderTarget":55}],40:[function(a,b,c){function d(a,b,c){this.shaders=[],this.padding=0,this.uniforms=c||{},this.vertexSrc=a||e.defaultVertexSrc,this.fragmentSrc=b||e.defaultFragmentSrc}var e=a("../shaders/TextureShader");d.prototype.constructor=d,b.exports=d,d.prototype.getShader=function(a){var b=a.gl,c=this.shaders[b.id];return c||(c=new e(a.shaderManager,this.vertexSrc,this.fragmentSrc,this.uniforms,this.attributes),this.shaders[b.id]=c),c},d.prototype.applyFilter=function(a,b,c,d){var e=this.getShader(a);a.filterManager.applyFilter(e,b,c,d)},d.prototype.syncUniform=function(a){for(var b=0,c=this.shaders.length;c>b;++b)this.shaders[b].syncUniform(a)}},{"../shaders/TextureShader":52}],41:[function(a,b,c){function d(){e.call(this,"\nprecision mediump float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform vec2 resolution;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n   vResolution = resolution;\n\n   //compute the texture coords and send them to varyings\n   texcoords(aTextureCoord * resolution, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'precision lowp float;\n\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE,\n            vec2 v_rgbSW, vec2 v_rgbSE,\n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D uSampler;\n\n\nvoid main(void){\n\n    gl_FragColor = fxaa(uSampler, vTextureCoord * vResolution, vResolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n}\n',{
resolution:{type:"v2",value:{x:1,y:1}}})}var e=a("./AbstractFilter");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager,e=this.getShader(a);d.applyFilter(e,b,c)}},{"./AbstractFilter":40}],42:[function(a,b,c){function d(a){var b=new f.Matrix;e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    original *= (masky.r * masky.a * alpha * clip);\n    gl_FragColor = original;\n}\n",{mask:{type:"sampler2D",value:a._texture},alpha:{type:"f",value:1},otherMatrix:{type:"mat3",value:b.toArray(!0)}}),this.maskSprite=a,this.maskMatrix=b}var e=a("./AbstractFilter"),f=a("../../../math");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager;this.uniforms.mask.value=this.maskSprite._texture,d.calculateMappedMatrix(b.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.alpha.value=this.maskSprite.worldAlpha;var e=this.getShader(a);d.applyFilter(e,b,c)},Object.defineProperties(d.prototype,{map:{get:function(){return this.uniforms.mask.value},set:function(a){this.uniforms.mask.value=a}},offset:{get:function(){return this.uniforms.offset.value},set:function(a){this.uniforms.offset.value=a}}})},{"../../../math":23,"./AbstractFilter":40}],43:[function(a,b,c){function d(a){e.call(this,a),this.currentBlendMode=99999}var e=a("./WebGLManager");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.setBlendMode=function(a){if(this.currentBlendMode===a)return!1;this.currentBlendMode=a;var b=this.renderer.blendModes[this.currentBlendMode];return this.renderer.gl.blendFunc(b[0],b[1]),!0}},{"./WebGLManager":48}],44:[function(a,b,c){function d(a){e.call(this,a),this.filterStack=[],this.filterStack.push({renderTarget:a.currentRenderTarget,filter:[],bounds:null}),this.texturePool=[],this.textureSize=new i.Rectangle(0,0,a.width,a.height),this.currentFrame=null}var e=a("./WebGLManager"),f=a("../utils/RenderTarget"),g=a("../../../const"),h=a("../utils/Quad"),i=a("../../../math");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.onContextChange=function(){this.texturePool.length=0;var a=this.renderer.gl;this.quad=new h(a)},d.prototype.setFilterStack=function(a){this.filterStack=a},d.prototype.pushFilter=function(a,b){var c=a.filterArea||a.getBounds();c.x=0|c.x,c.y=0|c.y,c.width=0|c.width,c.height=0|c.height;var d=0|b[0].padding;if(c.x-=d,c.y-=d,c.width+=2*d,c.height+=2*d,this.renderer.currentRenderTarget.transform){var e=this.renderer.currentRenderTarget.transform;c.x+=e.tx,c.y+=e.ty,this.capFilterArea(c),c.x-=e.tx,c.y-=e.ty}else this.capFilterArea(c);if(c.width>0&&c.height>0){this.currentFrame=c;var f=this.getRenderTarget();this.renderer.setRenderTarget(f),f.clear(),this.filterStack.push({renderTarget:f,filter:b})}else this.filterStack.push({renderTarget:null,filter:b})},d.prototype.popFilter=function(){var a=this.filterStack.pop(),b=this.filterStack[this.filterStack.length-1],c=a.renderTarget;if(a.renderTarget){var d=b.renderTarget,e=this.renderer.gl;this.currentFrame=c.frame,this.quad.map(this.textureSize,c.frame),e.bindBuffer(e.ARRAY_BUFFER,this.quad.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.quad.indexBuffer);var f=a.filter;if(e.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aVertexPosition,2,e.FLOAT,!1,0,0),e.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aTextureCoord,2,e.FLOAT,!1,0,32),e.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aColor,4,e.FLOAT,!1,0,64),this.renderer.blendModeManager.setBlendMode(g.BLEND_MODES.NORMAL),1===f.length)f[0].uniforms.dimensions&&(f[0].uniforms.dimensions.value[0]=this.renderer.width,f[0].uniforms.dimensions.value[1]=this.renderer.height,f[0].uniforms.dimensions.value[2]=this.quad.vertices[0],f[0].uniforms.dimensions.value[3]=this.quad.vertices[5]),f[0].applyFilter(this.renderer,c,d),this.returnRenderTarget(c);else{for(var h=c,i=this.getRenderTarget(!0),j=0;j<f.length-1;j++){var k=f[j];k.uniforms.dimensions&&(k.uniforms.dimensions.value[0]=this.renderer.width,k.uniforms.dimensions.value[1]=this.renderer.height,k.uniforms.dimensions.value[2]=this.quad.vertices[0],k.uniforms.dimensions.value[3]=this.quad.vertices[5]),k.applyFilter(this.renderer,h,i);var l=h;h=i,i=l}f[f.length-1].applyFilter(this.renderer,h,d),this.returnRenderTarget(h),this.returnRenderTarget(i)}return a.filter}},d.prototype.getRenderTarget=function(a){var b=this.texturePool.pop()||new f(this.renderer.gl,this.textureSize.width,this.textureSize.height,g.SCALE_MODES.LINEAR,this.renderer.resolution*g.FILTER_RESOLUTION);return b.frame=this.currentFrame,a&&b.clear(!0),b},d.prototype.returnRenderTarget=function(a){this.texturePool.push(a)},d.prototype.applyFilter=function(a,b,c,d){var e=this.renderer.gl;this.renderer.setRenderTarget(c),d&&c.clear(),this.renderer.shaderManager.setShader(a),a.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),a.syncUniforms(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,b.texture),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)},d.prototype.calculateMappedMatrix=function(a,b,c){var d=b.worldTransform.copy(i.Matrix.TEMP_MATRIX),e=b._texture.baseTexture,f=c.identity(),g=this.textureSize.height/this.textureSize.width;f.translate(a.x/this.textureSize.width,a.y/this.textureSize.height),f.scale(1,g);var h=this.textureSize.width/e.width,j=this.textureSize.height/e.height;return d.tx/=e.width*h,d.ty/=e.width*h,d.invert(),f.prepend(d),f.scale(1,1/g),f.scale(h,j),f.translate(b.anchor.x,b.anchor.y),f},d.prototype.capFilterArea=function(a){a.x<0&&(a.width+=a.x,a.x=0),a.y<0&&(a.height+=a.y,a.y=0),a.x+a.width>this.textureSize.width&&(a.width=this.textureSize.width-a.x),a.y+a.height>this.textureSize.height&&(a.height=this.textureSize.height-a.y)},d.prototype.resize=function(a,b){this.textureSize.width=a,this.textureSize.height=b;for(var c=0;c<this.texturePool.length;c++)this.texturePool[c].resize(a,b)},d.prototype.destroy=function(){this.filterStack=null,this.offsetY=0;for(var a=0;a<this.texturePool.length;a++)this.texturePool[a].destroy();this.texturePool=null}},{"../../../const":13,"../../../math":23,"../utils/Quad":54,"../utils/RenderTarget":55,"./WebGLManager":48}],45:[function(a,b,c){function d(a){e.call(this,a),this.stencilStack=[],this.reverse=!0,this.count=0,this.alphaMaskPool=[]}var e=a("./WebGLManager"),f=a("../filters/SpriteMaskFilter");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.pushMask=function(a,b){b.texture?this.pushSpriteMask(a,b):this.pushStencilMask(a,b)},d.prototype.popMask=function(a,b){b.texture?this.popSpriteMask(a,b):this.popStencilMask(a,b)},d.prototype.pushSpriteMask=function(a,b){var c=this.alphaMaskPool.pop();c||(c=[new f(b)]),c[0].maskSprite=b,this.renderer.filterManager.pushFilter(a,c)},d.prototype.popSpriteMask=function(){var a=this.renderer.filterManager.popFilter();this.alphaMaskPool.push(a)},d.prototype.pushStencilMask=function(a,b){this.renderer.stencilManager.pushMask(b)},d.prototype.popStencilMask=function(a,b){this.renderer.stencilManager.popMask(b)}},{"../filters/SpriteMaskFilter":42,"./WebGLManager":48}],46:[function(a,b,c){function d(a){e.call(this,a),this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var b=0;b<this.maxAttibs;b++)this.attribState[b]=!1;this.stack=[],this._currentId=-1,this.currentShader=null}var e=a("./WebGLManager"),f=a("../shaders/TextureShader"),g=a("../shaders/ComplexPrimitiveShader"),h=a("../shaders/PrimitiveShader"),i=a("../../../utils");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,i.pluginTarget.mixin(d),b.exports=d,d.prototype.onContextChange=function(){this.initPlugins(),this.defaultShader=new f(this),this.primitiveShader=new h(this),this.complexPrimitiveShader=new g(this)},d.prototype.setAttribs=function(a){var b;for(b=0;b<this.tempAttribState.length;b++)this.tempAttribState[b]=!1;for(var c in a)this.tempAttribState[a[c]]=!0;var d=this.renderer.gl;for(b=0;b<this.attribState.length;b++)this.attribState[b]!==this.tempAttribState[b]&&(this.attribState[b]=this.tempAttribState[b],this.attribState[b]?d.enableVertexAttribArray(b):d.disableVertexAttribArray(b))},d.prototype.setShader=function(a){return this._currentId===a.uuid?!1:(this._currentId=a.uuid,this.currentShader=a,this.renderer.gl.useProgram(a.program),this.setAttribs(a.attributes),!0)},d.prototype.destroy=function(){e.prototype.destroy.call(this),this.destroyPlugins(),this.attribState=null,this.tempAttribState=null}},{"../../../utils":66,"../shaders/ComplexPrimitiveShader":49,"../shaders/PrimitiveShader":50,"../shaders/TextureShader":52,"./WebGLManager":48}],47:[function(a,b,c){function d(a){e.call(this,a),this.stencilMaskStack=null}var e=a("./WebGLManager"),f=a("../../../utils");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.setMaskStack=function(a){this.stencilMaskStack=a;var b=this.renderer.gl;0===a.stencilStack.length?b.disable(b.STENCIL_TEST):b.enable(b.STENCIL_TEST)},d.prototype.pushStencil=function(a,b){this.renderer.currentRenderTarget.attachStencilBuffer();var c=this.renderer.gl,d=this.stencilMaskStack;this.bindGraphics(a,b,this.renderer),0===d.stencilStack.length&&(c.enable(c.STENCIL_TEST),c.clear(c.STENCIL_BUFFER_BIT),d.reverse=!0,d.count=0),d.stencilStack.push(b);var e=d.count;c.colorMask(!1,!1,!1,!1),c.stencilFunc(c.ALWAYS,0,255),c.stencilOp(c.KEEP,c.KEEP,c.INVERT),1===b.mode?(c.drawElements(c.TRIANGLE_FAN,b.indices.length-4,c.UNSIGNED_SHORT,0),d.reverse?(c.stencilFunc(c.EQUAL,255-e,255),c.stencilOp(c.KEEP,c.KEEP,c.DECR)):(c.stencilFunc(c.EQUAL,e,255),c.stencilOp(c.KEEP,c.KEEP,c.INCR)),c.drawElements(c.TRIANGLE_FAN,4,c.UNSIGNED_SHORT,2*(b.indices.length-4)),d.reverse?c.stencilFunc(c.EQUAL,255-(e+1),255):c.stencilFunc(c.EQUAL,e+1,255),d.reverse=!d.reverse):(d.reverse?(c.stencilFunc(c.EQUAL,e,255),c.stencilOp(c.KEEP,c.KEEP,c.INCR)):(c.stencilFunc(c.EQUAL,255-e,255),c.stencilOp(c.KEEP,c.KEEP,c.DECR)),c.drawElements(c.TRIANGLE_STRIP,b.indices.length,c.UNSIGNED_SHORT,0),d.reverse?c.stencilFunc(c.EQUAL,e+1,255):c.stencilFunc(c.EQUAL,255-(e+1),255)),c.colorMask(!0,!0,!0,!0),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),d.count++},d.prototype.bindGraphics=function(a,b){this._currentGraphics=a;var c,d=this.renderer.gl;1===b.mode?(c=this.renderer.shaderManager.complexPrimitiveShader,this.renderer.shaderManager.setShader(c),d.uniformMatrix3fv(c.uniforms.translationMatrix._location,!1,a.worldTransform.toArray(!0)),d.uniformMatrix3fv(c.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),d.uniform3fv(c.uniforms.tint._location,f.hex2rgb(a.tint)),d.uniform3fv(c.uniforms.color._location,b.color),d.uniform1f(c.uniforms.alpha._location,a.worldAlpha),d.bindBuffer(d.ARRAY_BUFFER,b.buffer),d.vertexAttribPointer(c.attributes.aVertexPosition,2,d.FLOAT,!1,8,0),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,b.indexBuffer)):(c=this.renderer.shaderManager.primitiveShader,this.renderer.shaderManager.setShader(c),d.uniformMatrix3fv(c.uniforms.translationMatrix._location,!1,a.worldTransform.toArray(!0)),d.uniformMatrix3fv(c.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),d.uniform3fv(c.uniforms.tint._location,f.hex2rgb(a.tint)),d.uniform1f(c.uniforms.alpha._location,a.worldAlpha),d.bindBuffer(d.ARRAY_BUFFER,b.buffer),d.vertexAttribPointer(c.attributes.aVertexPosition,2,d.FLOAT,!1,24,0),d.vertexAttribPointer(c.attributes.aColor,4,d.FLOAT,!1,24,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,b.indexBuffer))},d.prototype.popStencil=function(a,b){var c=this.renderer.gl,d=this.stencilMaskStack;if(d.stencilStack.pop(),d.count--,0===d.stencilStack.length)c.disable(c.STENCIL_TEST);else{var e=d.count;this.bindGraphics(a,b,this.renderer),c.colorMask(!1,!1,!1,!1),1===b.mode?(d.reverse=!d.reverse,d.reverse?(c.stencilFunc(c.EQUAL,255-(e+1),255),c.stencilOp(c.KEEP,c.KEEP,c.INCR)):(c.stencilFunc(c.EQUAL,e+1,255),c.stencilOp(c.KEEP,c.KEEP,c.DECR)),c.drawElements(c.TRIANGLE_FAN,4,c.UNSIGNED_SHORT,2*(b.indices.length-4)),c.stencilFunc(c.ALWAYS,0,255),c.stencilOp(c.KEEP,c.KEEP,c.INVERT),c.drawElements(c.TRIANGLE_FAN,b.indices.length-4,c.UNSIGNED_SHORT,0),d.reverse?c.stencilFunc(c.EQUAL,e,255):c.stencilFunc(c.EQUAL,255-e,255)):(d.reverse?(c.stencilFunc(c.EQUAL,e+1,255),c.stencilOp(c.KEEP,c.KEEP,c.DECR)):(c.stencilFunc(c.EQUAL,255-(e+1),255),c.stencilOp(c.KEEP,c.KEEP,c.INCR)),c.drawElements(c.TRIANGLE_STRIP,b.indices.length,c.UNSIGNED_SHORT,0),d.reverse?c.stencilFunc(c.EQUAL,e,255):c.stencilFunc(c.EQUAL,255-e,255)),c.colorMask(!0,!0,!0,!0),c.stencilOp(c.KEEP,c.KEEP,c.KEEP)}},d.prototype.destroy=function(){e.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},d.prototype.pushMask=function(a){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),a.dirty&&this.renderer.plugins.graphics.updateGraphics(a,this.renderer.gl),a._webGL[this.renderer.gl.id].data.length&&this.pushStencil(a,a._webGL[this.renderer.gl.id].data[0],this.renderer)},d.prototype.popMask=function(a){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.popStencil(a,a._webGL[this.renderer.gl.id].data[0],this.renderer)}},{"../../../utils":66,"./WebGLManager":48}],48:[function(a,b,c){function d(a){this.renderer=a,this.renderer.on("context",this.onContextChange,this)}d.prototype.constructor=d,b.exports=d,d.prototype.onContextChange=function(){},d.prototype.destroy=function(){this.renderer.off("context",this.onContextChange),this.renderer=null}},{}],49:[function(a,b,c){function d(a){e.call(this,a,["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},color:{type:"3f",value:[0,0,0]},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}var e=a("./Shader");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"./Shader":51}],50:[function(a,b,c){function d(a){e.call(this,a,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aColor:0})}var e=a("./Shader");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"./Shader":51}],51:[function(a,b,c){function d(a,b,c,d,f){if(!b||!c)throw new Error("Pixi.js Error. Shader requires vertexSrc and fragmentSrc");this.uuid=e.uuid(),this.gl=a.renderer.gl,this.shaderManager=a,this.program=null,this.uniforms=d||{},this.attributes=f||{},this.textureCount=1,this.vertexSrc=b,this.fragmentSrc=c,this.init()}var e=a("../../../utils");d.prototype.constructor=d,b.exports=d,d.prototype.init=function(){this.compile(),this.gl.useProgram(this.program),this.cacheUniformLocations(Object.keys(this.uniforms)),this.cacheAttributeLocations(Object.keys(this.attributes))},d.prototype.cacheUniformLocations=function(a){for(var b=0;b<a.length;++b)this.uniforms[a[b]]._location=this.gl.getUniformLocation(this.program,a[b])},d.prototype.cacheAttributeLocations=function(a){for(var b=0;b<a.length;++b)this.attributes[a[b]]=this.gl.getAttribLocation(this.program,a[b])},d.prototype.compile=function(){var a=this.gl,b=this._glCompile(a.VERTEX_SHADER,this.vertexSrc),c=this._glCompile(a.FRAGMENT_SHADER,this.fragmentSrc),d=a.createProgram();return a.attachShader(d,b),a.attachShader(d,c),a.linkProgram(d),a.getProgramParameter(d,a.LINK_STATUS)||(""!==a.getProgramInfoLog(d),a.deleteProgram(d),d=null),a.deleteShader(b),a.deleteShader(c),this.program=d},d.prototype.syncUniform=function(a){var b,c,d=a._location,f=a.value,g=this.gl;switch(a.type){case"i":case"1i":g.uniform1i(d,f);break;case"f":case"1f":g.uniform1f(d,f);break;case"2f":g.uniform2f(d,f[0],f[1]);break;case"3f":g.uniform3f(d,f[0],f[1],f[2]);break;case"4f":g.uniform4f(d,f[0],f[1],f[2],f[3]);break;case"v2":g.uniform2f(d,f.x,f.y);break;case"v3":g.uniform3f(d,f.x,f.y,f.z);break;case"v4":g.uniform4f(d,f.x,f.y,f.z,f.w);break;case"1iv":g.uniform1iv(d,f);break;case"2iv":g.uniform2iv(d,f);break;case"3iv":g.uniform3iv(d,f);break;case"4iv":g.uniform4iv(d,f);break;case"1fv":g.uniform1fv(d,f);break;case"2fv":g.uniform2fv(d,f);break;case"3fv":g.uniform3fv(d,f);break;case"4fv":g.uniform4fv(d,f);break;case"m2":case"mat2":case"Matrix2fv":g.uniformMatrix2fv(d,a.transpose,f);break;case"m3":case"mat3":case"Matrix3fv":g.uniformMatrix3fv(d,a.transpose,f);break;case"m4":case"mat4":case"Matrix4fv":g.uniformMatrix4fv(d,a.transpose,f);break;case"c":"number"==typeof f&&(f=e.hex2rgb(f)),g.uniform3f(d,f[0],f[1],f[2]);break;case"iv1":g.uniform1iv(d,f);break;case"iv":g.uniform3iv(d,f);break;case"fv1":g.uniform1fv(d,f);break;case"fv":g.uniform3fv(d,f);break;case"v2v":for(a._array||(a._array=new Float32Array(2*f.length)),b=0,c=f.length;c>b;++b)a._array[2*b]=f[b].x,a._array[2*b+1]=f[b].y;g.uniform2fv(d,a._array);break;case"v3v":for(a._array||(a._array=new Float32Array(3*f.length)),b=0,c=f.length;c>b;++b)a._array[3*b]=f[b].x,a._array[3*b+1]=f[b].y,a._array[3*b+2]=f[b].z;g.uniform3fv(d,a._array);break;case"v4v":for(a._array||(a._array=new Float32Array(4*f.length)),b=0,c=f.length;c>b;++b)a._array[4*b]=f[b].x,a._array[4*b+1]=f[b].y,a._array[4*b+2]=f[b].z,a._array[4*b+3]=f[b].w;g.uniform4fv(d,a._array);break;case"t":case"sampler2D":if(!a.value||!a.value.baseTexture.hasLoaded)break;g.activeTexture(g["TEXTURE"+this.textureCount]);var h=a.value.baseTexture._glTextures[g.id];h||this.initSampler2D(a),g.bindTexture(g.TEXTURE_2D,h),g.uniform1i(a._location,this.textureCount),this.textureCount++}},d.prototype.syncUniforms=function(){this.textureCount=1;for(var a in this.uniforms)this.syncUniform(this.uniforms[a])},d.prototype.initSampler2D=function(a){var b=this.gl,c=a.value.baseTexture;if(c.hasLoaded)if(a.textureData){var d=a.textureData;c._glTextures[b.id]=b.createTexture(),b.bindTexture(b.TEXTURE_2D,c._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.premultipliedAlpha),b.texImage2D(b.TEXTURE_2D,0,d.luminance?b.LUMINANCE:b.RGBA,b.RGBA,b.UNSIGNED_BYTE,c.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,d.magFilter?d.magFilter:b.LINEAR),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,d.wrapS?d.wrapS:b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d.wrapS?d.wrapS:b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,d.wrapT?d.wrapT:b.CLAMP_TO_EDGE)}else this.shaderManager.renderer.updateTexture(c)},d.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.gl=null,this.uniforms=null,this.attributes=null,this.vertexSrc=null,this.fragmentSrc=null},d.prototype._glCompile=function(a,b){var c=this.gl.createShader(a);return this.gl.shaderSource(c,b),this.gl.compileShader(c),this.gl.getShaderParameter(c,this.gl.COMPILE_STATUS)?c:null}},{"../../../utils":66}],52:[function(a,b,c){function d(a,b,c,f,g){var h={uSampler:{type:"sampler2D",value:0},projectionMatrix:{type:"mat3",value:new Float32Array(1,0,0,0,1,0,0,0,1)}};if(f)for(var i in f)h[i]=f[i];var j={aVertexPosition:0,aTextureCoord:0,aColor:0};if(g)for(var k in g)j[k]=g[k];b=b||d.defaultVertexSrc,c=c||d.defaultFragmentSrc,e.call(this,a,b,c,h,j)}var e=a("./Shader");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.defaultVertexSrc=["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),d.defaultFragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n")},{"./Shader":51}],53:[function(a,b,c){function d(a){e.call(this,a)}var e=a("../managers/WebGLManager");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.start=function(){},d.prototype.stop=function(){this.flush()},d.prototype.flush=function(){},d.prototype.render=function(a){}},{"../managers/WebGLManager":48}],54:[function(a,b,c){function d(a){this.gl=a,this.vertices=new Float32Array([0,0,200,0,200,200,0,200]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this.indices=new Uint16Array([0,1,2,0,3,2]),this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,128,a.DYNAMIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),this.upload()}d.prototype.constructor=d,d.prototype.map=function(a,b){var c=0,d=0;this.uvs[0]=c,this.uvs[1]=d,this.uvs[2]=c+b.width/a.width,this.uvs[3]=d,this.uvs[4]=c+b.width/a.width,this.uvs[5]=d+b.height/a.height,this.uvs[6]=c,this.uvs[7]=d+b.height/a.height,c=b.x,d=b.y,this.vertices[0]=c,this.vertices[1]=d,this.vertices[2]=c+b.width,this.vertices[3]=d,this.vertices[4]=c+b.width,this.vertices[5]=d+b.height,this.vertices[6]=c,this.vertices[7]=d+b.height,this.upload()},d.prototype.upload=function(){var a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,this.vertices),a.bufferSubData(a.ARRAY_BUFFER,32,this.uvs),a.bufferSubData(a.ARRAY_BUFFER,64,this.colors)},b.exports=d},{}],55:[function(a,b,c){var d=a("../../../math"),e=a("../../../utils"),f=a("../../../const"),g=a("./StencilMaskStack"),h=function(a,b,c,h,i,j){if(this.gl=a,this.frameBuffer=null,this.texture=null,this.size=new d.Rectangle(0,0,1,1),this.resolution=i||f.RESOLUTION,this.projectionMatrix=new d.Matrix,this.transform=null,this.frame=null,this.stencilBuffer=null,this.stencilMaskStack=new g,this.filterStack=[{renderTarget:this,filter:[],bounds:this.size}],this.scaleMode=h||f.SCALE_MODES.DEFAULT,this.root=j,!this.root){this.frameBuffer=a.createFramebuffer(),this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,h===f.SCALE_MODES.LINEAR?a.LINEAR:a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,h===f.SCALE_MODES.LINEAR?a.LINEAR:a.NEAREST);var k=e.isPowerOfTwo(b,c);k?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)),a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture,0)}this.resize(b,c)};h.prototype.constructor=h,b.exports=h,h.prototype.clear=function(a){var b=this.gl;a&&b.bindFramebuffer(b.FRAMEBUFFER,this.frameBuffer),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT)},h.prototype.attachStencilBuffer=function(){if(!this.stencilBuffer&&!this.root){var a=this.gl;this.stencilBuffer=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,this.stencilBuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.stencilBuffer),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,this.size.width*this.resolution,this.size.height*this.resolution)}},h.prototype.activate=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer);var b=this.frame||this.size;this.calculateProjection(b),this.transform&&this.projectionMatrix.append(this.transform),a.viewport(0,0,b.width*this.resolution,b.height*this.resolution)},h.prototype.calculateProjection=function(a){var b=this.projectionMatrix;b.identity(),this.root?(b.a=1/a.width*2,b.d=-1/a.height*2,b.tx=-1-a.x*b.a,b.ty=1-a.y*b.d):(b.a=1/a.width*2,b.d=1/a.height*2,b.tx=-1-a.x*b.a,b.ty=-1-a.y*b.d)},h.prototype.resize=function(a,b){if(a=0|a,b=0|b,this.size.width!==a||this.size.height!==b){if(this.size.width=a,this.size.height=b,!this.root){var c=this.gl;c.bindTexture(c.TEXTURE_2D,this.texture),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,a*this.resolution,b*this.resolution,0,c.RGBA,c.UNSIGNED_BYTE,null),this.stencilBuffer&&(c.bindRenderbuffer(c.RENDERBUFFER,this.stencilBuffer),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,a*this.resolution,b*this.resolution))}var d=this.frame||this.size;this.calculateProjection(d)}},h.prototype.destroy=function(){var a=this.gl;a.deleteFramebuffer(this.frameBuffer),a.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null}},{"../../../const":13,"../../../math":23,"../../../utils":66,"./StencilMaskStack":56}],56:[function(a,b,c){function d(){this.stencilStack=[],this.reverse=!0,this.count=0}d.prototype.constructor=d,b.exports=d},{}],57:[function(a,b,c){function d(a){g.call(this),this.anchor=new e.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=j.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=a||f.EMPTY}var e=a("../math"),f=a("../textures/Texture"),g=a("../display/Container"),h=a("../renderers/canvas/utils/CanvasTinter"),i=a("../utils"),j=a("../const"),k=new e.Point;d.prototype=Object.create(g.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{width:{get:function(){return this.scale.x*this.texture._frame.width},set:function(a){this.scale.x=a/this.texture._frame.width,this._width=a}},height:{get:function(){return this.scale.y*this.texture._frame.height},set:function(a){this.scale.y=a/this.texture._frame.height,this._height=a}},texture:{get:function(){return this._texture},set:function(a){this._texture!==a&&(this._texture=a,this.cachedTint=16777215,a&&(a.baseTexture.hasLoaded?this._onTextureUpdate():a.once("update",this._onTextureUpdate,this)))}}}),d.prototype._onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},d.prototype._renderWebGL=function(a){a.setObjectRenderer(a.plugins.sprite),a.plugins.sprite.render(this)},d.prototype.getBounds=function(a){if(!this._currentBounds){var b,c,d,e,f=this._texture._frame.width,g=this._texture._frame.height,h=f*(1-this.anchor.x),i=f*-this.anchor.x,j=g*(1-this.anchor.y),k=g*-this.anchor.y,l=a||this.worldTransform,m=l.a,n=l.b,o=l.c,p=l.d,q=l.tx,r=l.ty;if(0===n&&0===o)0>m&&(m*=-1),0>p&&(p*=-1),b=m*i+q,c=m*h+q,d=p*k+r,e=p*j+r;else{var s=m*i+o*k+q,t=p*k+n*i+r,u=m*h+o*k+q,v=p*k+n*h+r,w=m*h+o*j+q,x=p*j+n*h+r,y=m*i+o*j+q,z=p*j+n*i+r;b=s,b=b>u?u:b,b=b>w?w:b,b=b>y?y:b,d=t,d=d>v?v:d,d=d>x?x:d,d=d>z?z:d,c=s,c=u>c?u:c,c=w>c?w:c,c=y>c?y:c,e=t,e=v>e?v:e,e=x>e?x:e,e=z>e?z:e}if(this.children.length){var A=this.containerGetBounds();h=A.x,i=A.x+A.width,j=A.y,k=A.y+A.height,b=h>b?b:h,d=j>d?d:j,c=c>i?c:i,e=e>k?e:k}var B=this._bounds;B.x=b,B.width=c-b,B.y=d,B.height=e-d,this._currentBounds=B}return this._currentBounds},d.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture._frame.width*this.anchor.x,this._bounds.y=-this._texture._frame.height*this.anchor.y,this._bounds.width=this._texture._frame.width,this._bounds.height=this._texture._frame.height,this._bounds},d.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,k);var b,c=this._texture._frame.width,d=this._texture._frame.height,e=-c*this.anchor.x;return k.x>e&&k.x<e+c&&(b=-d*this.anchor.y,k.y>b&&k.y<b+d)?!0:!1},d.prototype._renderCanvas=function(a){if(!(this.texture.crop.width<=0||this.texture.crop.height<=0)&&(this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,a.context.globalCompositeOperation=a.blendModes[a.currentBlendMode]),this.texture.valid)){var b,c,d,e,f=this._texture,g=this.worldTransform,i=f.baseTexture.resolution/a.resolution;if(a.context.globalAlpha=this.worldAlpha,a.smoothProperty&&a.currentScaleMode!==f.baseTexture.scaleMode&&(a.currentScaleMode=f.baseTexture.scaleMode,a.context[a.smoothProperty]=a.currentScaleMode===j.SCALE_MODES.LINEAR),f.rotate){var k=g.a,l=g.b;g.a=-g.c,g.b=-g.d,g.c=k,g.d=l,d=f.crop.height,e=f.crop.width,b=f.trim?f.trim.y-this.anchor.y*f.trim.height:this.anchor.y*-f._frame.height,c=f.trim?f.trim.x-this.anchor.x*f.trim.width:this.anchor.x*-f._frame.width}else d=f.crop.width,e=f.crop.height,b=f.trim?f.trim.x-this.anchor.x*f.trim.width:this.anchor.x*-f._frame.width,c=f.trim?f.trim.y-this.anchor.y*f.trim.height:this.anchor.y*-f._frame.height;a.roundPixels?(a.context.setTransform(g.a,g.b,g.c,g.d,g.tx*a.resolution|0,g.ty*a.resolution|0),b=0|b,c=0|c):a.context.setTransform(g.a,g.b,g.c,g.d,g.tx*a.resolution,g.ty*a.resolution),16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=h.getTintedTexture(this,this.tint)),a.context.drawImage(this.tintedTexture,0,0,d*i*a.resolution,e*i*a.resolution,b/i,c/i,d*a.resolution,e*a.resolution)):a.context.drawImage(f.baseTexture.source,f.crop.x*i,f.crop.y*i,d*i*a.resolution,e*i*a.resolution,b/i,c/i,d*a.resolution,e*a.resolution)}},d.prototype.destroy=function(a,b){g.prototype.destroy.call(this),this.anchor=null,a&&this._texture.destroy(b),this._texture=null,this.shader=null},d.fromFrame=function(a){var b=i.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache '+this);return new d(b)},d.fromImage=function(a,b,c){return new d(f.fromImage(a,b,c))}},{"../const":13,"../display/Container":14,"../math":23,"../renderers/canvas/utils/CanvasTinter":38,"../textures/Texture":62,"../utils":66}],58:[function(a,b,c){function d(a){e.call(this,a),this.vertSize=5,this.vertByteSize=4*this.vertSize,this.size=g.SPRITE_BATCH_SIZE;var b=4*this.size*this.vertByteSize,c=6*this.size;this.vertices=new ArrayBuffer(b),this.positions=new Float32Array(this.vertices),this.colors=new Uint32Array(this.vertices),this.indices=new Uint16Array(c),this.lastIndexCount=0;for(var d=0,f=0;c>d;d+=6,f+=4)this.indices[d+0]=f+0,this.indices[d+1]=f+1,
this.indices[d+2]=f+2,this.indices[d+3]=f+0,this.indices[d+4]=f+2,this.indices[d+5]=f+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.textures=[],this.blendModes=[],this.shaders=[],this.sprites=[],this.shader=null}var e=a("../../renderers/webgl/utils/ObjectRenderer"),f=a("../../renderers/webgl/WebGLRenderer"),g=a("../../const");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,f.registerPlugin("sprite",d),d.prototype.onContextChange=function(){var a=this.renderer.gl;this.shader=this.renderer.shaderManager.defaultShader,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW),this.currentBlendMode=99999},d.prototype.render=function(a){var b=a._texture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=b.baseTexture);var c=b._uvs;if(c){var d,e,f,g,h=a.anchor.x,i=a.anchor.y;if(b.trim){var j=b.trim;e=j.x-h*j.width,d=e+b.crop.width,g=j.y-i*j.height,f=g+b.crop.height}else d=b._frame.width*(1-h),e=b._frame.width*-h,f=b._frame.height*(1-i),g=b._frame.height*-i;var k=this.currentBatchSize*this.vertByteSize,l=a.worldTransform,m=l.a,n=l.b,o=l.c,p=l.d,q=l.tx,r=l.ty,s=this.colors,t=this.positions;this.renderer.roundPixels?(t[k]=m*e+o*g+q|0,t[k+1]=p*g+n*e+r|0,t[k+5]=m*d+o*g+q|0,t[k+6]=p*g+n*d+r|0,t[k+10]=m*d+o*f+q|0,t[k+11]=p*f+n*d+r|0,t[k+15]=m*e+o*f+q|0,t[k+16]=p*f+n*e+r|0):(t[k]=m*e+o*g+q,t[k+1]=p*g+n*e+r,t[k+5]=m*d+o*g+q,t[k+6]=p*g+n*d+r,t[k+10]=m*d+o*f+q,t[k+11]=p*f+n*d+r,t[k+15]=m*e+o*f+q,t[k+16]=p*f+n*e+r),t[k+2]=c.x0,t[k+3]=c.y0,t[k+7]=c.x1,t[k+8]=c.y1,t[k+12]=c.x2,t[k+13]=c.y2,t[k+17]=c.x3,t[k+18]=c.y3;var u=a.tint;s[k+4]=s[k+9]=s[k+14]=s[k+19]=(u>>16)+(65280&u)+((255&u)<<16)+(255*a.worldAlpha<<24),this.sprites[this.currentBatchSize++]=a}},d.prototype.flush=function(){if(0!==this.currentBatchSize){var a,b=this.renderer.gl;if(this.currentBatchSize>.5*this.size)b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices);else{var c=this.positions.subarray(0,this.currentBatchSize*this.vertByteSize);b.bufferSubData(b.ARRAY_BUFFER,0,c)}for(var d,e,f,g,h=0,i=0,j=null,k=this.renderer.blendModeManager.currentBlendMode,l=null,m=!1,n=!1,o=0,p=this.currentBatchSize;p>o;o++)g=this.sprites[o],d=g._texture.baseTexture,e=g.blendMode,f=g.shader||this.shader,m=k!==e,n=l!==f,(j!==d||m||n)&&(this.renderBatch(j,h,i),i=o,h=0,j=d,m&&(k=e,this.renderer.blendModeManager.setBlendMode(k)),n&&(l=f,a=l.shaders?l.shaders[b.id]:l,a||(a=l.getShader(this.renderer)),this.renderer.shaderManager.setShader(a),a.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),a.syncUniforms(),b.activeTexture(b.TEXTURE0))),h++;this.renderBatch(j,h,i),this.currentBatchSize=0}},d.prototype.renderBatch=function(a,b,c){if(0!==b){var d=this.renderer.gl;a._glTextures[d.id]?d.bindTexture(d.TEXTURE_2D,a._glTextures[d.id]):this.renderer.updateTexture(a),d.drawElements(d.TRIANGLES,6*b,d.UNSIGNED_SHORT,6*c*2),this.renderer.drawCount++}},d.prototype.start=function(){var a=this.renderer.gl;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.vertByteSize;a.vertexAttribPointer(this.shader.attributes.aVertexPosition,2,a.FLOAT,!1,b,0),a.vertexAttribPointer(this.shader.attributes.aTextureCoord,2,a.FLOAT,!1,b,8),a.vertexAttribPointer(this.shader.attributes.aColor,4,a.UNSIGNED_BYTE,!0,b,16)},d.prototype.destroy=function(){this.renderer.gl.deleteBuffer(this.vertexBuffer),this.renderer.gl.deleteBuffer(this.indexBuffer),this.shader.destroy(),this.renderer=null,this.vertices=null,this.positions=null,this.colors=null,this.indices=null,this.vertexBuffer=null,this.indexBuffer=null,this.currentBaseTexture=null,this.drawing=!1,this.textures=null,this.blendModes=null,this.shaders=null,this.sprites=null,this.shader=null}},{"../../const":13,"../../renderers/webgl/WebGLRenderer":39,"../../renderers/webgl/utils/ObjectRenderer":53}],59:[function(a,b,c){function d(a,b,c){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=c||h.RESOLUTION,this._text=null,this._style=null;var d=f.fromCanvas(this.canvas);d.trim=new g.Rectangle,e.call(this,d),this.text=a,this.style=b}var e=a("../sprites/Sprite"),f=a("../textures/Texture"),g=a("../math"),h=a("../const");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.fontPropertiesCache={},d.fontPropertiesCanvas=document.createElement("canvas"),d.fontPropertiesContext=d.fontPropertiesCanvas.getContext("2d"),Object.defineProperties(d.prototype,{width:{get:function(){return this.dirty&&this.updateText(),this.scale.x*this._texture._frame.width},set:function(a){this.scale.x=a/this._texture._frame.width,this._width=a}},height:{get:function(){return this.dirty&&this.updateText(),this.scale.y*this._texture._frame.height},set:function(a){this.scale.y=a/this._texture._frame.height,this._height=a}},style:{get:function(){return this._style},set:function(a){a=a||{},a.font=a.font||"bold 20pt Arial",a.fill=a.fill||"black",a.align=a.align||"left",a.stroke=a.stroke||"black",a.strokeThickness=a.strokeThickness||0,a.wordWrap=a.wordWrap||!1,a.wordWrapWidth=a.wordWrapWidth||100,a.dropShadow=a.dropShadow||!1,a.dropShadowColor=a.dropShadowColor||"#000000",a.dropShadowAngle=a.dropShadowAngle||Math.PI/6,a.dropShadowDistance=a.dropShadowDistance||5,a.padding=a.padding||0,a.textBaseline=a.textBaseline||"alphabetic",a.lineJoin=a.lineJoin||"miter",a.miterLimit=a.miterLimit||10,this._style=a,this.dirty=!0}},text:{get:function(){return this._text},set:function(a){a=a.toString()||" ",this._text!==a&&(this._text=a,this.dirty=!0)}}}),d.prototype.updateText=function(){var a=this._style;this.context.font=a.font;for(var b=a.wordWrap?this.wordWrap(this._text):this._text,c=b.split(/(?:\r\n|\r|\n)/),d=new Array(c.length),e=0,f=this.determineFontProperties(a.font),g=0;g<c.length;g++){var h=this.context.measureText(c[g]).width;d[g]=h,e=Math.max(e,h)}var i=e+a.strokeThickness;a.dropShadow&&(i+=a.dropShadowDistance),this.canvas.width=(i+this.context.lineWidth)*this.resolution;var j=this.style.lineHeight||f.fontSize+a.strokeThickness,k=j*c.length;a.dropShadow&&(k+=a.dropShadowDistance),this.canvas.height=(k+2*this._style.padding)*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=a.font,this.context.strokeStyle=a.stroke,this.context.lineWidth=a.strokeThickness,this.context.textBaseline=a.textBaseline,this.context.lineJoin=a.lineJoin,this.context.miterLimit=a.miterLimit;var l,m;if(a.dropShadow){this.context.fillStyle=a.dropShadowColor;var n=Math.cos(a.dropShadowAngle)*a.dropShadowDistance,o=Math.sin(a.dropShadowAngle)*a.dropShadowDistance;for(g=0;g<c.length;g++)l=a.strokeThickness/2,m=a.strokeThickness/2+g*j+f.ascent,"right"===a.align?l+=e-d[g]:"center"===a.align&&(l+=(e-d[g])/2),a.fill&&this.context.fillText(c[g],l+n,m+o+this._style.padding)}for(this.context.fillStyle=a.fill,g=0;g<c.length;g++)l=a.strokeThickness/2,m=a.strokeThickness/2+g*j+f.ascent,"right"===a.align?l+=e-d[g]:"center"===a.align&&(l+=(e-d[g])/2),a.stroke&&a.strokeThickness&&this.context.strokeText(c[g],l,m+this._style.padding),a.fill&&this.context.fillText(c[g],l,m+this._style.padding);this.updateTexture()},d.prototype.updateTexture=function(){var a=this._texture;a.baseTexture.hasLoaded=!0,a.baseTexture.resolution=this.resolution,a.baseTexture.width=this.canvas.width/this.resolution,a.baseTexture.height=this.canvas.height/this.resolution,a.crop.width=a._frame.width=this.canvas.width/this.resolution,a.crop.height=a._frame.height=this.canvas.height/this.resolution,a.trim.x=0,a.trim.y=-this._style.padding,a.trim.width=a._frame.width,a.trim.height=a._frame.height-2*this._style.padding,this._width=this.canvas.width/this.resolution,this._height=this.canvas.height/this.resolution,a.update(),this.dirty=!1},d.prototype.renderWebGL=function(a){this.dirty&&this.updateText(),e.prototype.renderWebGL.call(this,a)},d.prototype._renderCanvas=function(a){this.dirty&&this.updateText(),e.prototype._renderCanvas.call(this,a)},d.prototype.determineFontProperties=function(a){var b=d.fontPropertiesCache[a];if(!b){b={};var c=d.fontPropertiesCanvas,e=d.fontPropertiesContext;e.font=a;var f=Math.ceil(e.measureText("|Mq").width),g=Math.ceil(e.measureText("M").width),h=2*g;g=1.4*g|0,c.width=f,c.height=h,e.fillStyle="#f00",e.fillRect(0,0,f,h),e.font=a,e.textBaseline="alphabetic",e.fillStyle="#000",e.fillText("|Mq",0,g);var i,j,k=e.getImageData(0,0,f,h).data,l=k.length,m=4*f,n=0,o=!1;for(i=0;g>i;i++){for(j=0;m>j;j+=4)if(255!==k[n+j]){o=!0;break}if(o)break;n+=m}for(b.ascent=g-i,n=l-m,o=!1,i=h;i>g;i--){for(j=0;m>j;j+=4)if(255!==k[n+j]){o=!0;break}if(o)break;n-=m}b.descent=i-g,b.fontSize=b.ascent+b.descent,d.fontPropertiesCache[a]=b}return b},d.prototype.wordWrap=function(a){for(var b="",c=a.split("\n"),d=this._style.wordWrapWidth,e=0;e<c.length;e++){for(var f=d,g=c[e].split(" "),h=0;h<g.length;h++){var i=this.context.measureText(g[h]).width,j=i+this.context.measureText(" ").width;0===h||j>f?(h>0&&(b+="\n"),b+=g[h],f=d-i):(f-=j,b+=" "+g[h])}e<c.length-1&&(b+="\n")}return b},d.prototype.getBounds=function(a){return this.dirty&&this.updateText(),e.prototype.getBounds.call(this,a)},d.prototype.destroy=function(a){this.context=null,this.canvas=null,this._texture.destroy(void 0===a?!0:a)}},{"../const":13,"../math":23,"../sprites/Sprite":57,"../textures/Texture":62}],60:[function(a,b,c){function d(a,b,c){g.call(this),this.uuid=e.uuid(),this.resolution=c||1,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=b||f.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,this._glTextures=[],a&&this.loadSource(a)}var e=a("../utils"),f=a("../const"),g=a("eventemitter3").EventEmitter;d.prototype=Object.create(g.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.update=function(){this.emit("update",this)},d.prototype.loadSource=function(a){var b=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,b&&this.source&&(this.source.onload=null,this.source.onerror=null),this.source=a,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!a.getContext){this.isLoading=!0;var c=this;a.onload=function(){a.onload=null,a.onerror=null,c.isLoading&&(c.isLoading=!1,c._sourceLoaded(),c.emit("loaded",c))},a.onerror=function(){a.onload=null,a.onerror=null,c.isLoading&&(c.isLoading=!1,c.emit("error",c))},a.complete&&a.src&&(this.isLoading=!1,a.onload=null,a.onerror=null,a.width&&a.height?(this._sourceLoaded(),b&&this.emit("loaded",this)):b&&this.emit("error",this))}},d.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=e.isPowerOfTwo(this.width,this.height),this.update()},d.prototype.destroy=function(){this.imageUrl?(delete e.BaseTextureCache[this.imageUrl],delete e.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete e.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},d.prototype.dispose=function(){this.emit("dispose",this)},d.prototype.updateSourceImage=function(a){this.source.src=a,this.loadSource(this.source)},d.fromImage=function(a,b,c){var f=e.BaseTextureCache[a];if(void 0===b&&0!==a.indexOf("data:")&&(b=!0),!f){var g=new Image;b&&(g.crossOrigin=""),f=new d(g,c),f.imageUrl=a,g.src=a,e.BaseTextureCache[a]=f,f.resolution=e.getResolutionOfUrl(a)}return f},d.fromCanvas=function(a,b){a._pixiId||(a._pixiId="canvas_"+e.uuid());var c=e.BaseTextureCache[a._pixiId];return c||(c=new d(a,b),e.BaseTextureCache[a._pixiId]=c),c}},{"../const":13,"../utils":66,eventemitter3:4}],61:[function(a,b,c){function d(a,b,c,d,l){if(!a)throw new Error("Unable to create RenderTexture, you must pass a renderer into the constructor.");b=b||100,c=c||100,l=l||k.RESOLUTION;var m=new e;if(m.width=b,m.height=c,m.resolution=l,m.scaleMode=d||k.SCALE_MODES.DEFAULT,m.hasLoaded=!0,f.call(this,m,new j.Rectangle(0,0,b,c)),this.width=b,this.height=c,this.resolution=l,this.render=null,this.renderer=a,this.renderer.type===k.RENDERER_TYPE.WEBGL){var n=this.renderer.gl;this.textureBuffer=new g(n,this.width,this.height,null,this.resolution),this.baseTexture._glTextures[n.id]=this.textureBuffer.texture,this.filterManager=new h(this.renderer),this.filterManager.onContextChange(),this.filterManager.resize(b,c),this.render=this.renderWebGL,this.renderer.currentRenderer.start(),this.renderer.currentRenderTarget.activate()}else this.render=this.renderCanvas,this.textureBuffer=new i(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()}var e=a("./BaseTexture"),f=a("./Texture"),g=a("../renderers/webgl/utils/RenderTarget"),h=a("../renderers/webgl/managers/FilterManager"),i=a("../renderers/canvas/utils/CanvasBuffer"),j=a("../math"),k=a("../const"),l=new j.Matrix;d.prototype=Object.create(f.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.resize=function(a,b,c){(a!==this.width||b!==this.height)&&(this.valid=a>0&&b>0,this.width=this._frame.width=this.crop.width=a,this.height=this._frame.height=this.crop.height=b,c&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.valid&&(this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution),this.filterManager&&this.filterManager.resize(this.width,this.height)))},d.prototype.clear=function(){this.valid&&(this.renderer.type===k.RENDERER_TYPE.WEBGL&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},d.prototype.renderWebGL=function(a,b,c,d){if(this.valid){if(d=void 0!==d?d:!0,this.textureBuffer.transform=b,a.worldAlpha=a.alpha,d){a.worldTransform.identity(),a.currentBounds=null;var e,f,g=a.children;for(e=0,f=g.length;f>e;++e)g[e].updateTransform()}var h=this.renderer.filterManager;this.renderer.filterManager=this.filterManager,this.renderer.renderDisplayObject(a,this.textureBuffer,c),this.renderer.filterManager=h}},d.prototype.renderCanvas=function(a,b,c,d){if(this.valid){d=!!d;var e=a.worldTransform,f=l;f.identity(),b&&f.append(b),a.worldTransform=f,a.worldAlpha=1;var g,h,i=a.children;for(g=0,h=i.length;h>g;++g)i[g].updateTransform();c&&this.textureBuffer.clear(),a.worldTransform=e;var j=this.textureBuffer.context,k=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(a,j),this.renderer.resolution=k}},d.prototype.destroy=function(){f.prototype.destroy.call(this,!0),this.textureBuffer.destroy(),this.filterManager&&this.filterManager.destroy(),this.renderer=null},d.prototype.getImage=function(){var a=new Image;return a.src=this.getBase64(),a},d.prototype.getBase64=function(){return this.getCanvas().toDataURL()},d.prototype.getCanvas=function(){if(this.renderer.type===k.RENDERER_TYPE.WEBGL){var a=this.renderer.gl,b=this.textureBuffer.size.width,c=this.textureBuffer.size.height,d=new Uint8Array(4*b*c);a.bindFramebuffer(a.FRAMEBUFFER,this.textureBuffer.frameBuffer),a.readPixels(0,0,b,c,a.RGBA,a.UNSIGNED_BYTE,d),a.bindFramebuffer(a.FRAMEBUFFER,null);var e=new i(b,c),f=e.context.getImageData(0,0,b,c);return f.data.set(d),e.context.putImageData(f,0,0),e.canvas}return this.textureBuffer.canvas}},{"../const":13,"../math":23,"../renderers/canvas/utils/CanvasBuffer":35,"../renderers/webgl/managers/FilterManager":44,"../renderers/webgl/utils/RenderTarget":55,"./BaseTexture":60,"./Texture":62}],62:[function(a,b,c){function d(a,b,c,e,f){h.call(this),this.noFrame=!1,b||(this.noFrame=!0,b=new i.Rectangle(0,0,1,1)),a instanceof d&&(a=a.baseTexture),this.baseTexture=a,this._frame=b,this.trim=e,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=c||b,this.rotate=!!f,a.hasLoaded?(this.noFrame&&(b=new i.Rectangle(0,0,a.width,a.height)),this.frame=b):a.once("loaded",this.onBaseTextureLoaded,this)}var e=a("./BaseTexture"),f=a("./VideoBaseTexture"),g=a("./TextureUvs"),h=a("eventemitter3").EventEmitter,i=a("../math"),j=a("../utils");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{frame:{get:function(){return this._frame},set:function(a){if(this._frame=a,this.noFrame=!1,this.width=a.width,this.height=a.height,!this.trim&&!this.rotate&&(a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=a&&a.width&&a.height&&this.baseTexture.hasLoaded,this.trim?(this.width=this.trim.width,this.height=this.trim.height,this._frame.width=this.trim.width,this._frame.height=this.trim.height):this.crop=a,this.valid&&this._updateUvs()}}}),d.prototype.update=function(){this.baseTexture.update()},d.prototype.onBaseTextureLoaded=function(a){this.frame=this.noFrame?new i.Rectangle(0,0,a.width,a.height):this._frame,this.emit("update",this)},d.prototype.destroy=function(a){a&&this.baseTexture.destroy(),this.valid=!1},d.prototype.clone=function(){return new d(this.baseTexture,this.frame,this.crop,this.trim,this.rotate)},d.prototype._updateUvs=function(){this._uvs||(this._uvs=new g),this._uvs.set(this.crop,this.baseTexture,this.rotate)},d.fromImage=function(a,b,c){var f=j.TextureCache[a];return f||(f=new d(e.fromImage(a,b,c)),j.TextureCache[a]=f),f},d.fromFrame=function(a){var b=j.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache');return b},d.fromCanvas=function(a,b){return new d(e.fromCanvas(a,b))},d.fromVideo=function(a,b){return"string"==typeof a?d.fromVideoUrl(a,b):new d(f.fromVideo(a,b))},d.fromVideoUrl=function(a,b){return new d(f.fromUrl(a,b))},d.addTextureToCache=function(a,b){j.TextureCache[b]=a},d.removeTextureFromCache=function(a){var b=j.TextureCache[a];return delete j.TextureCache[a],delete j.BaseTextureCache[a],b},d.emptyTexture=new d(new e)},{"../math":23,"../utils":66,"./BaseTexture":60,"./TextureUvs":63,"./VideoBaseTexture":64,eventemitter3:4}],63:[function(a,b,c){function d(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}b.exports=d,d.prototype.set=function(a,b,c){var d=b.width,e=b.height;c?(this.x0=(a.x+a.height)/d,this.y0=a.y/e,this.x1=(a.x+a.height)/d,this.y1=(a.y+a.width)/e,this.x2=a.x/d,this.y2=(a.y+a.width)/e,this.x3=a.x/d,this.y3=a.y/e):(this.x0=a.x/d,this.y0=a.y/e,this.x1=(a.x+a.width)/d,this.y1=a.y/e,this.x2=(a.x+a.width)/d,this.y2=(a.y+a.height)/e,this.x3=a.x/d,this.y3=(a.y+a.height)/e)}},{}],64:[function(a,b,c){function d(a,b){if(!a)throw new Error("No video source element specified.");(a.readyState===a.HAVE_ENOUGH_DATA||a.readyState===a.HAVE_FUTURE_DATA)&&a.width&&a.height&&(a.complete=!0),f.call(this,a,b),this.autoUpdate=!1,this._onUpdate=this._onUpdate.bind(this),this._onCanPlay=this._onCanPlay.bind(this),a.complete||(a.addEventListener("canplay",this._onCanPlay),a.addEventListener("canplaythrough",this._onCanPlay),a.addEventListener("play",this._onPlayStart.bind(this)),a.addEventListener("pause",this._onPlayStop.bind(this))),this.__loaded=!1}function e(a,b){b||(b="video/"+a.substr(a.lastIndexOf(".")+1));var c=document.createElement("source");return c.src=a,c.type=b,c}var f=a("./BaseTexture"),g=a("../utils");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,b.exports=d,d.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this._onUpdate),this.update())},d.prototype._onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this._onUpdate),this.autoUpdate=!0)},d.prototype._onPlayStop=function(){this.autoUpdate=!1},d.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.source.play(),this.__loaded||(this.__loaded=!0,this.emit("loaded",this)))},d.prototype.destroy=function(){this.source&&this.source._pixiId&&(g.BaseTextureCache[this.source._pixiId]=null,delete g.BaseTextureCache[this.source._pixiId],this.source._pixiId=null,delete this.source._pixiId),f.prototype.destroy.call(this)},d.fromVideo=function(a,b){a._pixiId||(a._pixiId="video_"+g.uuid());var c=g.BaseTextureCache[a._pixiId];return c||(c=new d(a,b),g.BaseTextureCache[a._pixiId]=c),c},d.fromUrl=function(a,b){var c=document.createElement("video");if(Array.isArray(a))for(var f=0;f<a.length;++f)c.appendChild(e(a.src||a,a.mime));else c.appendChild(e(a.src||a,a.mime));return c.load(),c.play(),d.fromVideo(c,b)},d.fromUrls=d.fromUrl},{"../utils":66,"./BaseTexture":60}],65:[function(a,b,c){var d=b.exports={};d.Triangulate=function(a){var b=!0,c=a.length>>1;if(3>c)return[];for(var e=[],f=[],g=0;c>g;g++)f.push(g);g=0;for(var h=c;h>3;){var i=f[(g+0)%h],j=f[(g+1)%h],k=f[(g+2)%h],l=a[2*i],m=a[2*i+1],n=a[2*j],o=a[2*j+1],p=a[2*k],q=a[2*k+1],r=!1;if(d._convex(l,m,n,o,p,q,b)){r=!0;for(var s=0;h>s;s++){var t=f[s];if(t!==i&&t!==j&&t!==k&&d._PointInTriangle(a[2*t],a[2*t+1],l,m,n,o,p,q)){r=!1;break}}}if(r)e.push(i,j,k),f.splice((g+1)%h,1),h--,g=0;else if(g++>3*h){if(!b)return null;for(e=[],f=[],g=0;c>g;g++)f.push(g);g=0,h=c,b=!1}}return e.push(f[0],f[1],f[2]),e},d._PointInTriangle=function(a,b,c,d,e,f,g,h){var i=g-c,j=h-d,k=e-c,l=f-d,m=a-c,n=b-d,o=i*i+j*j,p=i*k+j*l,q=i*m+j*n,r=k*k+l*l,s=k*m+l*n,t=1/(o*r-p*p),u=(r*q-p*s)*t,v=(o*s-p*q)*t;return u>=0&&v>=0&&1>u+v},d._convex=function(a,b,c,d,e,f,g){return(b-d)*(e-c)+(c-a)*(f-d)>=0===g}},{}],66:[function(a,b,c){var d=a("../const"),e=b.exports={_uid:0,_saidHello:!1,pluginTarget:a("./pluginTarget"),PolyK:a("./PolyK"),uuid:function(){return++e._uid},hex2rgb:function(a,b){return b=b||[],b[0]=(a>>16&255)/255,b[1]=(a>>8&255)/255,b[2]=(255&a)/255,b},hex2string:function(a){return a=a.toString(16),a="000000".substr(0,6-a.length)+a,"#"+a},rgb2hex:function(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]},canUseNewCanvasBlendModes:function(){if("undefined"==typeof document)return!1;var a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",b="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",c=new Image;c.src=a+"AP804Oa6"+b;var d=new Image;d.src=a+"/wCKxvRF"+b;var e=document.createElement("canvas");e.width=6,e.height=1;var f=e.getContext("2d");f.globalCompositeOperation="multiply",f.drawImage(c,0,0),f.drawImage(d,2,0);var g=f.getImageData(2,0,1,1).data;return 255===g[0]&&0===g[1]&&0===g[2]},getNextPowerOfTwo:function(a){if(a>0&&0===(a&a-1))return a;for(var b=1;a>b;)b<<=1;return b},isPowerOfTwo:function(a,b){return a>0&&0===(a&a-1)&&b>0&&0===(b&b-1)},getResolutionOfUrl:function(a){var b=d.RETINA_PREFIX.exec(a);return b?parseFloat(b[1]):1},sayHello:function(a){if(!e._saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var b=["\n %c %c %c Pixi.js "+d.VERSION+" -  "+a+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,b)}else window.console&&window.console.log("Pixi.js "+d.VERSION+" - "+a+" - http://www.pixijs.com/");e._saidHello=!0}},isWebGLSupported:function(){var a={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var b=document.createElement("canvas"),c=b.getContext("webgl",a)||b.getContext("experimental-webgl",a);return!(!c||!c.getContextAttributes().stencil)}catch(d){return!1}},TextureCache:{},BaseTextureCache:{}}},{"../const":13,"./PolyK":65,"./pluginTarget":67}],67:[function(a,b,c){function d(a){a.__plugins={},a.registerPlugin=function(b,c){a.__plugins[b]=c},a.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var b in a.__plugins)this.plugins[b]=new a.__plugins[b](this)},a.prototype.destroyPlugins=function(){for(var a in this.plugins)this.plugins[a].destroy(),this.plugins[a]=null;this.plugins=null}}b.exports={mixin:function(a){d(a)}}},{}],68:[function(a,b,c){var d=a("./core"),e=a("./mesh"),f=a("./extras");d.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")},d.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.Loader class.")},Object.defineProperties(d,{Stage:{get:function(){return d.Container}},DisplayObjectContainer:{get:function(){return d.Container}},Strip:{get:function(){return e.Mesh}}}),d.Sprite.prototype.setTexture=function(a){this.texture=a},f.BitmapText.prototype.setText=function(a){this.text=a},d.Text.prototype.setText=function(a){this.text=a}},{"./core":20,"./extras":76,"./mesh":117}],69:[function(a,b,c){function d(a,b){e.Container.call(this),this.textWidth=0,this.textHeight=0,this._glyphs=[],this._font={tint:void 0!==b.tint?b.tint:16777215,align:b.align||"left",name:null,size:0},this.font=b.font,this._text=a,this.maxWidth=0,this.dirty=!1,this.updateText()}var e=a("../core");d.prototype=Object.create(e.Container.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{tint:{get:function(){return this._font.tint},set:function(a){this._font.tint="number"==typeof a&&a>=0?a:16777215,this.dirty=!0}},align:{get:function(){return this._font.align},set:function(a){this._font.align=a,this.dirty=!0}},font:{get:function(){return this._font},set:function(a){"string"==typeof a?(a=a.split(" "),this._font.name=1===a.length?a[0]:a.slice(1).join(" "),this._font.size=a.length>=2?parseInt(a[0],10):d.fonts[this._font.name].size):(this._font.name=a.name,this._font.size="number"==typeof a.size?a.size:parseInt(a.size,10)),this.dirty=!0}},text:{get:function(){return this._text},set:function(a){this._text=a,this.dirty=!0}}}),d.prototype.updateText=function(){for(var a=d.fonts[this._font.name],b=new e.math.Point,c=null,f=[],g=0,h=0,i=[],j=0,k=this._font.size/a.size,l=-1,m=0;m<this.text.length;m++){var n=this.text.charCodeAt(m);if(l=/(\s)/.test(this.text.charAt(m))?m:l,/(?:\r\n|\r|\n)/.test(this.text.charAt(m)))i.push(g),h=Math.max(h,g),j++,b.x=0,b.y+=a.lineHeight,c=null;else if(-1!==l&&this.maxWidth>0&&b.x*k>this.maxWidth)f.splice(l,m-l),m=l,l=-1,i.push(g),h=Math.max(h,g),j++,b.x=0,b.y+=a.lineHeight,c=null;else{var o=a.chars[n];o&&(c&&o.kerning[c]&&(b.x+=o.kerning[c]),f.push({texture:o.texture,line:j,charCode:n,position:new e.math.Point(b.x+o.xOffset,b.y+o.yOffset)}),g=b.x+(o.texture.width+o.xOffset),b.x+=o.xAdvance,c=n)}}i.push(g),h=Math.max(h,g);var p=[];for(m=0;j>=m;m++){var q=0;"right"===this._font.align?q=h-i[m]:"center"===this._font.align&&(q=(h-i[m])/2),p.push(q)}var r=f.length,s=this.tint;for(m=0;r>m;m++){var t=this._glyphs[m];t?t.texture=f[m].texture:(t=new e.Sprite(f[m].texture),this._glyphs.push(t)),t.position.x=(f[m].position.x+p[f[m].line])*k,t.position.y=f[m].position.y*k,t.scale.x=t.scale.y=k,t.tint=s,t.parent||this.addChild(t)}for(m=r;m<this._glyphs.length;++m)this.removeChild(this._glyphs[m]);this.textWidth=h*k,this.textHeight=(b.y+a.lineHeight)*k},d.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),this.containerUpdateTransform()},d.fonts={}},{"../core":20}],70:[function(a,b,c){function d(a){e.Sprite.call(this,a[0]),this._textures=a,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1}var e=a("../core"),f=a("./Ticker");d.prototype=Object.create(e.Sprite.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{totalFrames:{get:function(){return this._textures.length}},textures:{get:function(){return this._textures},set:function(a){this._textures=a,this.texture=this._textures[Math.floor(this.currentFrame)%this._textures.length]}}}),d.prototype.stop=function(){this.playing&&(this.playing=!1,f.off("tick",this.update))},d.prototype.play=function(){this.playing||(this.playing=!0,f.on("tick",this.update,this))},d.prototype.gotoAndStop=function(a){this.stop(),this.currentFrame=a;var b=Math.floor(this.currentFrame);this.texture=this._textures[b%this._textures.length]},d.prototype.gotoAndPlay=function(a){this.currentFrame=a,this.play()},d.prototype.update=function(a){this.currentFrame+=this.animationSpeed*a;var b=Math.floor(this.currentFrame);0>b?this.loop?(this.currentFrame+=this._textures.length,this.texture=this._textures[this.currentFrame]):(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this.loop||b<this._textures.length?this.texture=this._textures[b%this._textures.length]:b>=this._textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())},d.prototype.destroy=function(){this.stop(),e.Sprite.prototype.destroy.call(this)},d.fromFrames=function(a){for(var b=[],c=0;c<a.length;++c)b.push(new e.Texture.fromFrame(a[c]));return new d(b)},d.fromImages=function(a){for(var b=[],c=0;c<a.length;++c)b.push(new e.Texture.fromImage(a[c]));return new d(b)}},{"../core":20,"./Ticker":71}],71:[function(a,b,c){var d=a("eventemitter3").EventEmitter,e=function(){d.call(this),this.updateBind=this.update.bind(this),this.active=!1,this.deltaTime=1,this.timeElapsed=0,this.lastTime=0,this.speed=1,this.start()};e.prototype=Object.create(d.prototype),e.prototype.constructor=e,e.prototype.start=function(){this.active||(this.active=!0,requestAnimationFrame(this.updateBind))},e.prototype.stop=function(){this.active&&(this.active=!1)},e.prototype.update=function(){if(this.active){requestAnimationFrame(this.updateBind);var a=(new Date).getTime(),b=a-this.lastTime;b>100&&(b=100),this.deltaTime=.06*b,this.deltaTime*=this.speed,this.emit("tick",this.deltaTime),this.lastTime=a}},b.exports=new e},{eventemitter3:4}],72:[function(a,b,c){function d(a,b,c){e.Sprite.call(this,a),this.tileScale=new e.math.Point(1,1),this.tilePosition=new e.math.Point(0,0),this._width=b||100,this._height=c||100,this._tileScaleOffset=new e.math.Point(1,1),this._tilingTexture=null,this._refreshTexture=!1,this._uvs=new e.TextureUvs}var e=a("../core"),f=new e.Sprite,g=new e.Point,h=new e.Matrix;d.prototype=Object.create(e.Sprite.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{width:{get:function(){return this._width},set:function(a){this._width=a}},height:{get:function(){return this._height},set:function(a){this._height=a}}}),d.prototype._onTextureUpdate=function(){},d.prototype._renderWebGL=function(a){(!this._tilingTexture||this._refreshTexture)&&this.generateTilingTexture(a,this.texture,!0);var b=this._tilingTexture;if(b){var c=this._uvs;this.tilePosition.x%=b.baseTexture.width/this._tileScaleOffset.x,this.tilePosition.y%=b.baseTexture.height/this._tileScaleOffset.y;var d=this.tilePosition.x/(b.baseTexture.width/this._tileScaleOffset.x),e=this.tilePosition.y/(b.baseTexture.height/this._tileScaleOffset.y),f=this._width/b.baseTexture.width*this._tileScaleOffset.x,g=this._height/b.baseTexture.height*this._tileScaleOffset.y;f/=this.tileScale.x,g/=this.tileScale.y,c.x0=0-d,c.y0=0-e,c.x1=1*f-d,c.y1=0-e,c.x2=1*f-d,c.y2=1*g-e,c.x3=0-d,c.y3=1*g-e;var h=b._uvs,i=b._frame.width,j=b._frame.height;b._uvs=c,b._frame.width=this.width,b._frame.height=this.height,a.setObjectRenderer(a.plugins.sprite),a.plugins.sprite.render(this),b._uvs=h,b._frame.width=i,
b._frame.height=j}},d.prototype._renderCanvas=function(a){var b=a.context;b.globalAlpha=this.worldAlpha;var c=this.worldTransform,d=a.resolution;if(b.setTransform(c.a*d,c.b*d,c.c*d,c.d*d,c.tx*d,c.ty*d),!this.__tilePattern||this._refreshTexture){if(this.generateTilingTexture(!1),!this._tilingTexture)return;this.__tilePattern=b.createPattern(this._tilingTexture.baseTexture.source,"repeat")}this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,b.globalCompositeOperation=a.blendModes[a.currentBlendMode]);var e=this.tilePosition,f=this.tileScale;e.x%=this._tilingTexture.baseTexture.width,e.y%=this._tilingTexture.baseTexture.height,b.scale(f.x,f.y),b.translate(e.x+this.anchor.x*-this._width,e.y+this.anchor.y*-this._height),b.fillStyle=this.__tilePattern,b.fillRect(-e.x,-e.y,this._width/f.x,this._height/f.y),b.translate(-e.x+this.anchor.x*this._width,-e.y+this.anchor.y*this._height),b.scale(1/f.x,1/f.y)},d.prototype.getBounds=function(){var a,b,c,d,e=this._width,f=this._height,g=e*(1-this.anchor.x),h=e*-this.anchor.x,i=f*(1-this.anchor.y),j=f*-this.anchor.y,k=this.worldTransform,l=k.a,m=k.b,n=k.c,o=k.d,p=k.tx,q=k.ty,r=l*h+n*j+p,s=o*j+m*h+q,t=l*g+n*j+p,u=o*j+m*g+q,v=l*g+n*i+p,w=o*i+m*g+q,x=l*h+n*i+p,y=o*i+m*h+q;a=r,a=a>t?t:a,a=a>v?v:a,a=a>x?x:a,c=s,c=c>u?u:c,c=c>w?w:c,c=c>y?y:c,b=r,b=t>b?t:b,b=v>b?v:b,b=x>b?x:b,d=s,d=u>d?u:d,d=w>d?w:d,d=y>d?y:d;var z=this._bounds;return z.x=a,z.width=b-a,z.y=c,z.height=d-c,this._currentBounds=z,z},d.prototype.onTextureUpdate=function(){},d.prototype.generateTilingTexture=function(a,b,c){if(this.texture.baseTexture.hasLoaded){b=this.originalTexture||this._texture;var d,g,i=b.frame,j=i.width!==b.baseTexture.width||i.height!==b.baseTexture.height;if(c&&!b.baseTexture.isPowerOfTwo||j){d=e.utils.getNextPowerOfTwo(i.width),g=e.utils.getNextPowerOfTwo(i.height),f.texture=b;var k=new e.RenderTexture(a,d,g,b.baseTexture.scaleMode,b.baseTexture.resolution),l=a.currentRenderTarget,m=h;m.a=(d+1)/i.width,m.d=(g+1)/i.height,f.worldTransform.tx-=.5,f.worldTransform.ty-=.5,a.currentRenderer.flush(),k.render(f,m,!0,!1),a.setRenderTarget(l),this._tileScaleOffset.x=d/i.width,this._tileScaleOffset.y=g/i.height,this._tilingTexture=k}else this._tilingTexture&&this._tilingTexture.isTiling&&this._tilingTexture.destroy(!0),this._tileScaleOffset.x=1,this._tileScaleOffset.y=1,this._tilingTexture=b;this._refreshTexture=!1,this.originalTexture=this.texture,this._texture=this._tilingTexture}},d.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,g);var b,c=this._width,d=this._height,e=-c*this.anchor.x;return g.x>e&&g.x<e+c&&(b=-d*this.anchor.y,g.y>b&&g.y<b+d)?!0:!1},d.prototype.destroy=function(){e.Sprite.prototype.destroy.call(this),this.tileScale=null,this._tileScaleOffset=null,this.tilePosition=null,this._tilingTexture.destroy(!0),this._tilingTexture=null,this._uvs=null},d.fromFrame=function(a,b,c){var f=e.utils.TextureCache[a];if(!f)throw new Error('The frameId "'+a+'" does not exist in the texture cache '+this);return new d(f,b,c)},d.fromImage=function(a,b,c,f,g){return new d(e.Texture.fromImage(a,f,g),b,c)}},{"../core":20}],73:[function(a,b,c){var d=a("../core"),e=d.DisplayObject,f=new d.Matrix;e.prototype._cacheAsBitmap=!1,e.prototype._originalRenderWebGL=null,e.prototype._originalRenderCanvas=null,e.prototype._originalUpdateTransform=null,e.prototype._originalHitTest=null,e.prototype._cachedSprite=null,Object.defineProperties(e.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap!==a&&(this._cacheAsBitmap=a,a?(this._originalRenderWebGL=this.renderWebGL,this._originalRenderCanvas=this.renderCanvas,this._originalUpdateTransform=this.updateTransform,this._originalGetBounds=this.getBounds,this._originalContainesPoint=this.containsPoint,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas):(this._cachedSprite&&this._destroyCachedDisplayObject(),this.renderWebGL=this._originalRenderWebGL,this.renderCanvas=this._originalRenderCanvas,this.getBounds=this._originalGetBounds,this.updateTransform=this._originalUpdateTransform,this.containsPoint=this._originalContainsPoint))}}}),e.prototype._renderCachedWebGL=function(a){this._initCachedDisplayObject(a),this._cachedSprite.worldAlpha=this.worldAlpha,a.setObjectRenderer(a.plugins.sprite),a.plugins.sprite.render(this._cachedSprite)},e.prototype._initCachedDisplayObject=function(a){if(!this._cachedSprite){a.currentRenderer.flush();var b=this.getLocalBounds().clone();if(this._filters){var c=this._filters[0].padding;b.x-=c,b.y-=c,b.width+=2*c,b.height+=2*c}var e=a.currentRenderTarget,g=a.filterManager.filterStack,h=new d.RenderTexture(a,0|b.width,0|b.height),i=f;i.tx=-b.x,i.ty=-b.y,this.renderWebGL=this._originalRenderWebGL,h.render(this,i,!0),a.setRenderTarget(e),a.filterManager.filterStack=g,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new d.Sprite(h),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-(b.x/b.width),this._cachedSprite.anchor.y=-(b.y/b.height),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},e.prototype._renderCachedCanvas=function(a){this._initCachedDisplayObjectCanvas(a),this._cachedSprite.worldAlpha=this.worldAlpha,this._cachedSprite.renderCanvas(a)},e.prototype._initCachedDisplayObjectCanvas=function(a){if(!this._cachedSprite){var b=this.getLocalBounds(),c=a.context,e=new d.RenderTexture(a,0|b.width,0|b.height),g=f;g.tx=-b.x,g.ty=-b.y,this.renderCanvas=this._originalRenderCanvas,e.render(this,g,!0),a.context=c,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new d.Sprite(e),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-(b.x/b.width),this._cachedSprite.anchor.y=-(b.y/b.height),this.hitTest=this._cachedSprite.hitTest.bind(this._cachedSprite)}},e.prototype._getCachedBounds=function(){return this._cachedSprite._currentBounds=null,this._cachedSprite.getBounds()},e.prototype._destroyCachedDisplayObject=function(){this._cachedSprite._texture.destroy(),this._cachedSprite=null}},{"../core":20}],74:[function(a,b,c){var d=a("../core");d.DisplayObject.prototype.name=null,d.Container.prototype.getChildByName=function(a){for(var b=0;b<this.children.length;b++)if(this.children[b].name===a)return this.children[b];return null}},{"../core":20}],75:[function(a,b,c){var d=a("../core");d.DisplayObject.prototype.getGlobalPosition=function(a){return a=a||new d.Point,this.parent?(this.displayObjectUpdateTransform(),a.x=this.worldTransform.tx,a.y=this.worldTransform.ty):(a.x=this.position.x,a.y=this.position.y),a}},{"../core":20}],76:[function(a,b,c){a("./cacheAsBitmap"),a("./getChildByName"),a("./getGlobalPosition"),b.exports={Ticker:a("./Ticker"),MovieClip:a("./MovieClip"),TilingSprite:a("./TilingSprite"),BitmapText:a("./BitmapText")}},{"./BitmapText":69,"./MovieClip":70,"./Ticker":71,"./TilingSprite":72,"./cacheAsBitmap":73,"./getChildByName":74,"./getGlobalPosition":75}],77:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nuniform vec4 dimensions;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n    if (clamp(p.x, 0.0, 4.0) == p.x && clamp(p.y, 0.0, 4.0) == p.y)\n    {\n        if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 uv = gl_FragCoord.xy;\n\n    vec3 col = texture2D(uSampler, floor( uv / pixelSize ) * pixelSize / dimensions.xy).rgb;\n\n    float gray = (col.r + col.g + col.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    vec2 p = mod( uv / ( pixelSize * 0.5 ), 2.0) - vec2(1.0);\n    col = col * character(n, p);\n\n    gl_FragColor = vec4(col, 1.0);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"1f",value:8}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(a){this.uniforms.pixelSize.value=a}}})},{"../../core":20}],78:[function(a,b,c){function d(){e.AbstractFilter.call(this),this.blurXFilter=new f,this.blurYFilter=new g,this.defaultFilter=new e.AbstractFilter}var e=a("../../core"),f=a("../blur/BlurXFilter"),g=a("../blur/BlurYFilter");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager.getRenderTarget(!0);this.defaultFilter.applyFilter(a,b,c),this.blurXFilter.applyFilter(a,b,d),a.blendModeManager.setBlendMode(e.BLEND_MODES.SCREEN),this.blurYFilter.applyFilter(a,d,c),a.blendModeManager.setBlendMode(e.BLEND_MODES.NORMAL),a.filterManager.returnRenderTarget(d)},Object.defineProperties(d.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=this.blurYFilter.blur=a}},blurX:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a}},blurY:{get:function(){return this.blurYFilter.blur},set:function(a){this.blurYFilter.blur=a}}})},{"../../core":20,"../blur/BlurXFilter":80,"../blur/BlurYFilter":81}],79:[function(a,b,c){function d(){e.AbstractFilter.call(this),this.blurXFilter=new f,this.blurYFilter=new g}var e=a("../../core"),f=a("./BlurXFilter"),g=a("./BlurYFilter");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager.getRenderTarget(!0);this.blurXFilter.applyFilter(a,b,d),this.blurYFilter.applyFilter(a,d,c),a.filterManager.returnRenderTarget(d)},Object.defineProperties(d.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(a){this.padding=.5*a,this.blurXFilter.blur=this.blurYFilter.blur=a}},passes:{get:function(){return this.blurXFilter.passes},set:function(a){this.blurXFilter.passes=this.blurYFilter.passes=a}},blurX:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a}},blurY:{get:function(){return this.blurYFilter.blur},set:function(a){this.blurYFilter.blur=a}}})},{"../../core":20,"./BlurXFilter":80,"./BlurYFilter":81}],80:[function(a,b,c){function d(){e.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(-0.012 * strength, 0.0);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(-0.008 * strength, 0.0);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(-0.004 * strength, 0.0);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2( 0.004 * strength, 0.0);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2( 0.008 * strength, 0.0);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2( 0.012 * strength, 0.0);\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c,d){var e=this.getShader(a);if(this.uniforms.strength.value=this.strength/4/this.passes*(b.frame.width/b.size.width),1===this.passes)a.filterManager.applyFilter(e,b,c,d);else{for(var f=a.filterManager.getRenderTarget(!0),g=b,h=f,i=0;i<this.passes-1;i++){a.filterManager.applyFilter(e,g,h,d);var j=h;h=g,g=j}a.filterManager.applyFilter(e,g,c,d),a.filterManager.returnRenderTarget(f)}},Object.defineProperties(d.prototype,{blur:{get:function(){return this.strength},set:function(a){this.padding=.5*a,this.strength=a}}})},{"../../core":20}],81:[function(a,b,c){function d(){e.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c,d){var e=this.getShader(a);if(this.uniforms.strength.value=this.strength/4/this.passes*(b.frame.height/b.size.height),1===this.passes)a.filterManager.applyFilter(e,b,c,d);else{for(var f=a.filterManager.getRenderTarget(!0),g=b,h=f,i=0;i<this.passes-1;i++){a.filterManager.applyFilter(e,g,h,d);var j=h;h=g,g=j}a.filterManager.applyFilter(e,g,c,d),a.filterManager.returnRenderTarget(f)}},Object.defineProperties(d.prototype,{blur:{get:function(){return this.strength},set:function(a){this.padding=.5*a,this.strength=a}}})},{"../../core":20}],82:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nconst vec2 delta = vec2(1.0/10.0, 0.0);\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta * percent);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n")}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d},{"../../core":20}],83:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float m[24];\n\nuniform vec4 d;\n\nvoid main(void)\n{\n    \n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n	gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[3] * c.a + m[4];\n	gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[8] * c.a + m[9];\n	gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[13] * c.a + m[14];\n	gl_FragColor.a = c.a;\n}\n",{m:{type:"1fv",value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype._loadMatrix=function(a,b){b=!!b;var c=a;b&&(this._multiply(c,this.uniforms.m.value,a),c=this._colorMatrix(c)),this.uniforms.m.value=c},d.prototype._multiply=function(a,b,c){return a[0]=b[0]*c[0]+b[1]*c[5]+b[2]*c[10]+b[3]*c[15]+b[4]*c[20],a[1]=b[0]*c[1]+b[1]*c[6]+b[2]*c[11]+b[3]*c[16]+b[4]*c[21],a[2]=b[0]*c[2]+b[1]*c[7]+b[2]*c[12]+b[3]*c[17]+b[4]*c[22],a[3]=b[0]*c[3]+b[1]*c[8]+b[2]*c[13]+b[3]*c[18]+b[4]*c[23],a[4]=b[0]*c[4]+b[1]*c[9]+b[2]*c[14]+b[3]*c[19]+b[4]*c[24],a[5]=b[5]*c[0]+b[6]*c[5]+b[7]*c[10]+b[8]*c[15]+b[9]*c[20],a[6]=b[5]*c[1]+b[6]*c[6]+b[7]*c[11]+b[8]*c[16]+b[9]*c[21],a[7]=b[5]*c[2]+b[6]*c[7]+b[7]*c[12]+b[8]*c[17]+b[9]*c[22],a[8]=b[5]*c[3]+b[6]*c[8]+b[7]*c[13]+b[8]*c[18]+b[9]*c[23],a[9]=b[5]*c[4]+b[6]*c[9]+b[7]*c[14]+b[8]*c[19]+b[9]*c[24],a[10]=b[10]*c[0]+b[11]*c[5]+b[12]*c[10]+b[13]*c[15]+b[14]*c[20],a[11]=b[10]*c[1]+b[11]*c[6]+b[12]*c[11]+b[13]*c[16]+b[14]*c[21],a[12]=b[10]*c[2]+b[11]*c[7]+b[12]*c[12]+b[13]*c[17]+b[14]*c[22],a[13]=b[10]*c[3]+b[11]*c[8]+b[12]*c[13]+b[13]*c[18]+b[14]*c[23],a[14]=b[10]*c[4]+b[11]*c[9]+b[12]*c[14]+b[13]*c[19]+b[14]*c[24],a[15]=b[15]*c[0]+b[16]*c[5]+b[17]*c[10]+b[18]*c[15]+b[19]*c[20],a[16]=b[15]*c[1]+b[16]*c[6]+b[17]*c[11]+b[18]*c[16]+b[19]*c[21],a[17]=b[15]*c[2]+b[16]*c[7]+b[17]*c[12]+b[18]*c[17]+b[19]*c[22],a[18]=b[15]*c[3]+b[16]*c[8]+b[17]*c[13]+b[18]*c[18]+b[19]*c[23],a[19]=b[15]*c[4]+b[16]*c[9]+b[17]*c[14]+b[18]*c[19]+b[19]*c[24],a[20]=b[20]*c[0]+b[21]*c[5]+b[22]*c[10]+b[23]*c[15]+b[24]*c[20],a[21]=b[20]*c[1]+b[21]*c[6]+b[22]*c[11]+b[23]*c[16]+b[24]*c[21],a[22]=b[20]*c[2]+b[21]*c[7]+b[22]*c[12]+b[23]*c[17]+b[24]*c[22],a[23]=b[20]*c[3]+b[21]*c[8]+b[22]*c[13]+b[23]*c[18]+b[24]*c[23],a[24]=b[20]*c[4]+b[21]*c[9]+b[22]*c[14]+b[23]*c[19]+b[24]*c[24],a},d.prototype._colorMatrix=function(a){var b=new Float32Array(a);return b[4]/=255,b[9]/=255,b[14]/=255,b[19]/=255,b},d.prototype.brightness=function(a,b){var c=[a,0,0,0,0,0,a,0,0,0,0,0,a,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(c,b)},d.prototype.greyscale=function(a,b){var c=[a,a,a,0,0,a,a,a,0,0,a,a,a,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(c,b)},d.prototype.blackAndWhite=function(a){var b=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(b,a)},d.prototype.hue=function(a,b){a=(a||0)/180*Math.PI;var c=Math.cos(a),d=Math.sin(a),e=.213,f=.715,g=.072,h=[e+c*(1-e)+d*-e,f+c*-f+d*-f,g+c*-g+d*(1-g),0,0,e+c*-e+.143*d,f+c*(1-f)+.14*d,g+c*-g+d*-.283,0,0,e+c*-e+d*-(1-e),f+c*-f+d*f,g+c*(1-g)+d*g,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(h,b)},d.prototype.contrast=function(a,b){var c=(a||0)+1,d=-128*(c-1),e=[c,0,0,0,d,0,c,0,0,d,0,0,c,0,d,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,b)},d.prototype.saturation=function(a,b){var c=2*(a||0)/3+1,d=(c-1)*-.5,e=[c,d,d,0,0,d,c,d,0,0,d,d,c,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,b)},d.prototype.desaturate=function(a){this.saturation(-1)},d.prototype.negative=function(a){var b=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(b,a)},d.prototype.sepia=function(a){var b=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(b,a)},d.prototype.technicolor=function(a){var b=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0,0,0,0,0,0];this._loadMatrix(b,a)},d.prototype.polaroid=function(a){var b=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(b,a)},d.prototype.toBGR=function(a){var b=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(b,a)},d.prototype.kodachrome=function(a){var b=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(b,a)},d.prototype.browni=function(a){var b=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(b,a)},d.prototype.vintage=function(a){var b=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(b,a)},d.prototype.colorTone=function(a,b,c,d,e){a=a||.2,b=b||.15,c=c||16770432,d=d||3375104;var f=(c>>16&255)/255,g=(c>>8&255)/255,h=(255&c)/255,i=(d>>16&255)/255,j=(d>>8&255)/255,k=(255&d)/255,l=[.3,.59,.11,0,0,f,g,h,a,0,i,j,k,b,0,f-i,g-j,h-k,0,0,0,0,0,0,1];this._loadMatrix(l,e)},d.prototype.night=function(a,b){a=a||.1;var c=[-2*a,-a,0,0,0,-a,0,a,0,0,0,a,2*a,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(c,b)},d.prototype.predator=function(a,b){var c=[11.224130630493164*a,-4.794486999511719*a,-2.8746118545532227*a,0*a,.40342438220977783*a,-3.6330697536468506*a,9.193157196044922*a,-2.951810836791992*a,0*a,-1.316135048866272*a,-3.2184197902679443*a,-4.2375030517578125*a,7.476448059082031*a,0*a,.8044459223747253*a,0,0,0,1,0,0,0,0,0,0];this._loadMatrix(c,b)},d.prototype.lsd=function(a){var b=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(b,a)},d.prototype.reset=function(){var a=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(a,!1)},Object.defineProperties(d.prototype,{matrix:{get:function(){return this.uniforms.m.value},set:function(a){this.uniforms.m.value=a}}})},{"../../core":20}],84:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float step;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    color = floor(color * step) / step;\n\n    gl_FragColor = color;\n}\n",{step:{type:"1f",value:5}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{step:{get:function(){return this.uniforms.step.value},set:function(a){this.uniforms.step.value=a}}})},{"../../core":20}],85:[function(a,b,c){function d(a,b,c){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n",{matrix:{type:"1fv",value:new Float32Array(a)},texelSize:{type:"2v",value:{x:1/b,y:1/c}}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{matrix:{get:function(){return this.uniforms.matrix.value},set:function(a){this.uniforms.matrix.value=new Float32Array(a)}},width:{get:function(){return 1/this.uniforms.texelSize.value.x},set:function(a){this.uniforms.texelSize.value.x=1/a}},height:{get:function(){return 1/this.uniforms.texelSize.value.y},set:function(a){this.uniforms.texelSize.value.y=1/a}}})},{"../../core":20}],86:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d},{"../../core":20}],87:[function(a,b,c){function d(a){var b=new e.math.Matrix;a.renderable=!1,e.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vMapCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nvoid main(void)\n{\n   vec4 original =  texture2D(uSampler, vTextureCoord);\n   vec4 map =  texture2D(mapSampler, vMapCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y));\n}\n",{mapSampler:{type:"sampler2D",value:a.texture},otherMatrix:{type:"mat3",value:b.toArray(!0)},scale:{type:"v2",value:{x:1,y:1}}}),this.maskSprite=a,this.maskMatrix=b,this.scale=new e.math.Point(20,20)}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager;d.calculateMappedMatrix(b.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.scale.value.x=this.scale.x*(1/b.frame.width),this.uniforms.scale.value.y=this.scale.y*(1/b.frame.height);var e=this.getShader(a);d.applyFilter(e,b,c)},Object.defineProperties(d.prototype,{map:{get:function(){return this.uniforms.mapSampler.value},set:function(a){this.uniforms.mapSampler.value=a}}})},{"../../core":20}],88:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 dimensions;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * dimensions.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n",{scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{scale:{get:function(){return this.uniforms.scale.value},set:function(a){this.uniforms.scale.value=a}},angle:{get:function(){return this.uniforms.angle.value},set:function(a){this.uniforms.angle.value=a}}})},{"../../core":20}],89:[function(a,b,c){function d(){e.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform vec2 offset;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition+offset), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform vec3 color;\nuniform float alpha;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec4 sum = vec4(0.0);\n\n    sum += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    sum += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    sum += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    sum += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    sum += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n\n    gl_FragColor = vec4( color.rgb * sum.a * alpha, sum.a * alpha );\n}\n",{blur:{type:"1f",value:1/512},color:{type:"c",value:[0,0,0]},alpha:{type:"1f",value:.7},offset:{type:"2f",value:[5,5]},strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),
d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c,d){var e=this.getShader(a);if(this.uniforms.strength.value=this.strength/4/this.passes*(b.frame.height/b.size.height),1===this.passes)a.filterManager.applyFilter(e,b,c,d);else{for(var f=a.filterManager.getRenderTarget(!0),g=b,h=f,i=0;i<this.passes-1;i++){a.filterManager.applyFilter(e,g,h,d);var j=h;h=g,g=j}a.filterManager.applyFilter(e,g,c,d),a.filterManager.returnRenderTarget(f)}},Object.defineProperties(d.prototype,{blur:{get:function(){return this.strength},set:function(a){this.padding=.5*a,this.strength=a}}})},{"../../core":20}],90:[function(a,b,c){function d(){e.AbstractFilter.call(this),this.blurXFilter=new f,this.blurYTintFilter=new g,this.defaultFilter=new e.AbstractFilter,this.padding=30,this._dirtyPosition=!0,this._angle=45*Math.PI/180,this._distance=10,this.alpha=.75,this.hideObject=!1,this.blendMode=e.BLEND_MODES.MULTIPLY}var e=a("../../core"),f=a("../blur/BlurXFilter"),g=a("./BlurYTintFilter");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager.getRenderTarget(!0);this._dirtyPosition&&(this._dirtyPosition=!1,this.blurYTintFilter.uniforms.offset.value[0]=Math.sin(this._angle)*this._distance,this.blurYTintFilter.uniforms.offset.value[1]=Math.cos(this._angle)*this._distance),this.blurXFilter.applyFilter(a,b,d),a.blendModeManager.setBlendMode(this.blendMode),this.blurYTintFilter.applyFilter(a,d,c),a.blendModeManager.setBlendMode(e.BLEND_MODES.NORMAL),this.hideObject||this.defaultFilter.applyFilter(a,b,c),a.filterManager.returnRenderTarget(d)},Object.defineProperties(d.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=this.blurYTintFilter.blur=a}},blurX:{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a}},blurY:{get:function(){return this.blurYTintFilter.blur},set:function(a){this.blurYTintFilter.blur=a}},color:{get:function(){return e.utils.rgb2hex(this.blurYTintFilter.uniforms.color.value)},set:function(a){this.blurYTintFilter.uniforms.color.value=e.utils.hex2rgb(a)}},alpha:{get:function(){return this.blurYTintFilter.uniforms.alpha.value},set:function(a){this.blurYTintFilter.uniforms.alpha.value=a}},distance:{get:function(){return this._distance},set:function(a){this._dirtyPosition=!0,this._distance=a}},angle:{get:function(){return this._angle},set:function(a){this._dirtyPosition=!0,this._angle=a}}})},{"../../core":20,"../blur/BlurXFilter":80,"./BlurYTintFilter":89}],91:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float gray;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);\n}\n",{gray:{type:"1f",value:1}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{gray:{get:function(){return this.uniforms.gray.value},set:function(a){this.uniforms.gray.value=a}}})},{"../../core":20}],92:[function(a,b,c){b.exports={AbstractFilter:a("../core/renderers/webgl/filters/AbstractFilter"),FXAAFilter:a("../core/renderers/webgl/filters/FXAAFilter"),SpriteMaskFilter:a("../core/renderers/webgl/filters/SpriteMaskFilter"),AsciiFilter:a("./ascii/AsciiFilter"),BloomFilter:a("./bloom/BloomFilter"),BlurFilter:a("./blur/BlurFilter"),BlurXFilter:a("./blur/BlurXFilter"),BlurYFilter:a("./blur/BlurYFilter"),ColorMatrixFilter:a("./color/ColorMatrixFilter"),ColorStepFilter:a("./color/ColorStepFilter"),ConvolutionFilter:a("./convolution/ConvolutionFilter"),CrossHatchFilter:a("./crosshatch/CrossHatchFilter"),DisplacementFilter:a("./displacement/DisplacementFilter"),DotScreenFilter:a("./dot/DotScreenFilter"),GrayFilter:a("./gray/GrayFilter"),DropShadowFilter:a("./dropshadow/DropShadowFilter"),InvertFilter:a("./invert/InvertFilter"),NoiseFilter:a("./noise/NoiseFilter"),NormalMapFilter:a("./normal/NormalMapFilter"),PixelateFilter:a("./pixelate/PixelateFilter"),RGBSplitFilter:a("./rgb/RGBSplitFilter"),ShockwaveFilter:a("./shockwave/ShockwaveFilter"),SepiaFilter:a("./sepia/SepiaFilter"),SmartBlurFilter:a("./blur/SmartBlurFilter"),TiltShiftFilter:a("./tiltshift/TiltShiftFilter"),TiltShiftXFilter:a("./tiltshift/TiltShiftXFilter"),TiltShiftYFilter:a("./tiltshift/TiltShiftYFilter"),TwistFilter:a("./twist/TwistFilter")}},{"../core/renderers/webgl/filters/AbstractFilter":40,"../core/renderers/webgl/filters/FXAAFilter":41,"../core/renderers/webgl/filters/SpriteMaskFilter":42,"./ascii/AsciiFilter":77,"./bloom/BloomFilter":78,"./blur/BlurFilter":79,"./blur/BlurXFilter":80,"./blur/BlurYFilter":81,"./blur/SmartBlurFilter":82,"./color/ColorMatrixFilter":83,"./color/ColorStepFilter":84,"./convolution/ConvolutionFilter":85,"./crosshatch/CrossHatchFilter":86,"./displacement/DisplacementFilter":87,"./dot/DotScreenFilter":88,"./dropshadow/DropShadowFilter":90,"./gray/GrayFilter":91,"./invert/InvertFilter":93,"./noise/NoiseFilter":94,"./normal/NormalMapFilter":95,"./pixelate/PixelateFilter":96,"./rgb/RGBSplitFilter":97,"./sepia/SepiaFilter":98,"./shockwave/ShockwaveFilter":99,"./tiltshift/TiltShiftFilter":101,"./tiltshift/TiltShiftXFilter":102,"./tiltshift/TiltShiftYFilter":103,"./twist/TwistFilter":104}],93:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform float invert;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);\n}\n",{invert:{type:"1f",value:1}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{invert:{get:function(){return this.uniforms.invert.value},set:function(a){this.uniforms.invert.value=a}}})},{"../../core":20}],94:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(vTextureCoord) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n",{noise:{type:"1f",value:.5}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{noise:{get:function(){return this.uniforms.noise.value},set:function(a){this.uniforms.noise.value=a}}})},{"../../core":20}],95:[function(a,b,c){function d(a){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying float vColor;\n\nuniform sampler2D displacementMap;\nuniform sampler2D uSampler;\n\nuniform vec4 dimensions;\n\nconst vec2 Resolution = vec2(1.0,1.0);      //resolution of screen\nuniform vec3 LightPos;    //light position, normalized\nconst vec4 LightColor = vec4(1.0, 1.0, 1.0, 1.0);      //light RGBA -- alpha is intensity\nconst vec4 AmbientColor = vec4(1.0, 1.0, 1.0, 0.5);    //ambient RGBA -- alpha is intensity\nconst vec3 Falloff = vec3(0.0, 1.0, 0.2);         //attenuation coefficients\n\nuniform vec3 LightDir; // = vec3(1.0, 0.0, 1.0);\n\nuniform vec2 mapDimensions; // = vec2(256.0, 256.0);\n\n\nvoid main(void)\n{\n    vec2 mapCords = vTextureCoord.xy;\n\n    vec4 color = texture2D(uSampler, vTextureCoord.st);\n    vec3 nColor = texture2D(displacementMap, vTextureCoord.st).rgb;\n\n\n    mapCords *= vec2(dimensions.x/512.0, dimensions.y/512.0);\n\n    mapCords.y *= -1.0;\n    mapCords.y += 1.0;\n\n    // RGBA of our diffuse color\n    vec4 DiffuseColor = texture2D(uSampler, vTextureCoord);\n\n    // RGB of our normal map\n    vec3 NormalMap = texture2D(displacementMap, mapCords).rgb;\n\n    // The delta position of light\n    // vec3 LightDir = vec3(LightPos.xy - (gl_FragCoord.xy / Resolution.xy), LightPos.z);\n    vec3 LightDir = vec3(LightPos.xy - (mapCords.xy), LightPos.z);\n\n    // Correct for aspect ratio\n    // LightDir.x *= Resolution.x / Resolution.y;\n\n    // Determine distance (used for attenuation) BEFORE we normalize our LightDir\n    float D = length(LightDir);\n\n    // normalize our vectors\n    vec3 N = normalize(NormalMap * 2.0 - 1.0);\n    vec3 L = normalize(LightDir);\n\n    // Pre-multiply light color with intensity\n    // Then perform 'N dot L' to determine our diffuse term\n    vec3 Diffuse = (LightColor.rgb * LightColor.a) * max(dot(N, L), 0.0);\n\n    // pre-multiply ambient color with intensity\n    vec3 Ambient = AmbientColor.rgb * AmbientColor.a;\n\n    // calculate attenuation\n    float Attenuation = 1.0 / ( Falloff.x + (Falloff.y*D) + (Falloff.z*D*D) );\n\n    // the calculation which brings it all together\n    vec3 Intensity = Ambient + Diffuse * Attenuation;\n    vec3 FinalColor = DiffuseColor.rgb * Intensity;\n    gl_FragColor = vColor * vec4(FinalColor, DiffuseColor.a);\n\n    // gl_FragColor = vec4(1.0, 0.0, 0.0, Attenuation); // vColor * vec4(FinalColor, DiffuseColor.a);\n\n/*\n    // normalise color\n    vec3 normal = normalize(nColor * 2.0 - 1.0);\n\n    vec3 deltaPos = vec3( (light.xy - gl_FragCoord.xy) / resolution.xy, light.z );\n\n    float lambert = clamp(dot(normal, lightDir), 0.0, 1.0);\n\n    float d = sqrt(dot(deltaPos, deltaPos));\n    float att = 1.0 / ( attenuation.x + (attenuation.y*d) + (attenuation.z*d*d) );\n\n    vec3 result = (ambientColor * ambientIntensity) + (lightColor.rgb * lambert) * att;\n    result *= color.rgb;\n\n    gl_FragColor = vec4(result, 1.0);\n*/\n}\n",{displacementMap:{type:"sampler2D",value:a},scale:{type:"2f",value:{x:15,y:15}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:1}},dimensions:{type:"4f",value:[0,0,0,0]},LightPos:{type:"3f",value:[0,1,0]}}),a.baseTexture._powerOf2=!0,a.baseTexture.hasLoaded?this.onTextureLoaded():a.baseTexture.once("loaded",this.onTextureLoaded,this)}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height},Object.defineProperties(d.prototype,{map:{get:function(){return this.uniforms.displacementMap.value},set:function(a){this.uniforms.displacementMap.value=a}},scale:{get:function(){return this.uniforms.scale.value},set:function(a){this.uniforms.scale.value=a}},offset:{get:function(){return this.uniforms.offset.value},set:function(a){this.uniforms.offset.value=a}}})},{"../../core":20}],96:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 dimensions;\nuniform vec2 pixelSize;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord;\n\n    vec2 size = dimensions.xy / pixelSize;\n\n    vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;\n\n    gl_FragColor = texture2D(uSampler, color);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"v2",value:{x:10,y:10}}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(a){this.uniforms.pixelSize.value=a}}})},{"../../core":20}],97:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 dimensions;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n",{red:{type:"v2",value:{x:20,y:20}},green:{type:"v2",value:{x:-20,y:20}},blue:{type:"v2",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{red:{get:function(){return this.uniforms.red.value},set:function(a){this.uniforms.red.value=a}},green:{get:function(){return this.uniforms.green.value},set:function(a){this.uniforms.green.value=a}},blue:{get:function(){return this.uniforms.blue.value},set:function(a){this.uniforms.blue.value=a}}})},{"../../core":20}],98:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float sepia;\n\nconst mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);\n}\n",{sepia:{type:"1f",value:1}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{sepia:{get:function(){return this.uniforms.sepia.value},set:function(a){this.uniforms.sepia.value=a}}})},{"../../core":20}],99:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 center;\nuniform vec3 params; // 10.0, 0.8, 0.1\nuniform float time;\n\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    vec2 texCoord = uv;\n\n    float dist = distance(uv, center);\n\n    if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )\n    {\n        float diff = (dist - time);\n        float powDiff = 1.0 - pow(abs(diff*params.x), params.y);\n\n        float diffTime = diff  * powDiff;\n        vec2 diffUV = normalize(uv - center);\n        texCoord = uv + (diffUV * diffTime);\n    }\n\n    gl_FragColor = texture2D(uSampler, texCoord);\n}\n",{center:{type:"v2",value:{x:.5,y:.5}},params:{type:"v3",value:{x:10,y:.8,z:.1}},time:{type:"1f",value:0}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{center:{get:function(){return this.uniforms.center.value},set:function(a){this.uniforms.center.value=a}},params:{get:function(){return this.uniforms.params.value},set:function(a){this.uniforms.params.value=a}},time:{get:function(){return this.uniforms.time.value},set:function(a){this.uniforms.time.value=a}}})},{"../../core":20}],100:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{blur:{type:"1f",value:100},gradientBlur:{type:"1f",value:600},start:{type:"v2",value:{x:0,y:window.innerHeight/2}},end:{type:"v2",value:{x:600,y:window.innerHeight/2}},delta:{type:"v2",value:{x:30,y:30}},texSize:{type:"v2",value:{x:window.innerWidth,y:window.innerHeight}}}),this.updateDelta()}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.updateDelta=function(){this.uniforms.delta.value.x=0,this.uniforms.delta.value.y=0},Object.defineProperties(d.prototype,{blur:{get:function(){return this.uniforms.blur.value},set:function(a){this.uniforms.blur.value=a}},gradientBlur:{get:function(){return this.uniforms.gradientBlur.value},set:function(a){this.uniforms.gradientBlur.value=a}},start:{get:function(){return this.uniforms.start.value},set:function(a){this.uniforms.start.value=a,this.updateDelta()}},end:{get:function(){return this.uniforms.end.value},set:function(a){this.uniforms.end.value=a,this.updateDelta()}}})},{"../../core":20}],101:[function(a,b,c){function d(){e.AbstractFilter.call(this),this.tiltShiftXFilter=new f,this.tiltShiftYFilter=new g}var e=a("../../core"),f=a("./TiltShiftXFilter"),g=a("./TiltShiftYFilter");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.applyFilter=function(a,b,c){var d=a.filterManager.getRenderTarget(!0);this.tiltShiftXFilter.applyFilter(a,b,d),this.tiltShiftYFilter.applyFilter(a,d,c),a.filterManager.returnRenderTarget(d)},Object.defineProperties(d.prototype,{blur:{get:function(){return this.tiltShiftXFilter.blur},set:function(a){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=a}},gradientBlur:{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(a){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=a}},start:{get:function(){return this.tiltShiftXFilter.start},set:function(a){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=a}},end:{get:function(){return this.tiltShiftXFilter.end},set:function(a){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=a}}})},{"../../core":20,"./TiltShiftXFilter":102,"./TiltShiftYFilter":103}],102:[function(a,b,c){function d(){e.call(this)}var e=a("./TiltShiftAxisFilter");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.updateDelta=function(){var a=this.uniforms.end.value.x-this.uniforms.start.value.x,b=this.uniforms.end.value.y-this.uniforms.start.value.y,c=Math.sqrt(a*a+b*b);this.uniforms.delta.value.x=a/c,this.uniforms.delta.value.y=b/c}},{"./TiltShiftAxisFilter":100}],103:[function(a,b,c){function d(){e.call(this)}var e=a("./TiltShiftAxisFilter");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.updateDelta=function(){var a=this.uniforms.end.value.x-this.uniforms.start.value.x,b=this.uniforms.end.value.y-this.uniforms.start.value.y,c=Math.sqrt(a*a+b*b);this.uniforms.delta.value.x=-b/c,this.uniforms.delta.value.y=a/c}},{"./TiltShiftAxisFilter":100}],104:[function(a,b,c){function d(){e.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\n\nvoid main(void)\n{\n   vec2 coord = vTextureCoord - offset;\n   float dist = length(coord);\n\n   if (dist < radius)\n   {\n       float ratio = (radius - dist) / radius;\n       float angleMod = ratio * ratio * angle;\n       float s = sin(angleMod);\n       float c = cos(angleMod);\n       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n   }\n\n   gl_FragColor = texture2D(uSampler, coord+offset);\n}\n",{radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"v2",value:{x:.5,y:.5}}})}var e=a("../../core");d.prototype=Object.create(e.AbstractFilter.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{offset:{get:function(){return this.uniforms.offset.value},set:function(a){this.uniforms.offset.value=a}},radius:{get:function(){return this.uniforms.radius.value},set:function(a){this.uniforms.radius.value=a}},angle:{get:function(){return this.uniforms.angle.value},set:function(a){this.uniforms.angle.value=a}}})},{"../../core":20}],105:[function(a,b,c){function d(){this.global=new e.Point,this.target=null,this.originalEvent=null}var e=a("../core");d.prototype.constructor=d,b.exports=d,d.prototype.getLocalPosition=function(a,b,c){var d=a.worldTransform,f=c?c:this.global,g=d.a,h=d.c,i=d.tx,j=d.b,k=d.d,l=d.ty,m=1/(g*k+h*-j);return b=b||new e.math.Point,b.x=k*m*f.x+-h*m*f.y+(l*h-i*k)*m,b.y=g*m*f.y+-j*m*f.x+(-l*g+i*j)*m,b}},{"../core":20}],106:[function(a,b,c){function d(a,b){b=b||{},this.renderer=a,this.autoPreventDefault=void 0!==b.autoPreventDefault?b.autoPreventDefault:!0,this.interactionFrequency=b.interactionFrequency||10,this.mouse=new f,this.eventData={stopped:!1,target:null,type:null,data:this.mouse},this.interactiveDataPool=[],this.interactionDOMElement=null,this.eventsAdded=!1,this.onMouseUp=this.onMouseUp.bind(this),this.processMouseUp=this.processMouseUp.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.processMouseDown=this.processMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.processMouseMove=this.processMouseMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.processMouseOverOut=this.processMouseOverOut.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.processTouchStart=this.processTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.processTouchEnd=this.processTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.processTouchMove=this.processTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this._tempPoint=new e.Point,this.resolution=1,this.updateBound=this.update.bind(this),this.setTargetElement(this.renderer.view,this.renderer.resolution),this.update()}var e=a("../core"),f=a("./InteractionData");Object.assign(e.DisplayObject.prototype,a("./interactiveTarget")),d.prototype.constructor=d,b.exports=d,d.prototype.setTargetElement=function(a,b){this.removeEvents(),this.interactionDOMElement=a,this.resolution=b||1,this.addEvents()},d.prototype.addEvents=function(){this.interactionDOMElement&&(window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"),this.interactionDOMElement.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!0)},d.prototype.removeEvents=function(){this.interactionDOMElement&&(window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!1)},d.prototype.update=function(){if(requestAnimationFrame(this.updateBound),!this.throttleUpdate()&&this.interactionDOMElement){if(this.didMove)return void(this.didMove=!1);this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut.bind(this),!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)}},d.prototype.dispatchEvent=function(a,b,c){c.stopped||(c.target=a,c.type=b,a.emit(b,c),a[b]&&a[b](c))},d.prototype.throttleUpdate=function(){var a=Date.now(),b=a-this.last;return b=b*this.interactionFrequency/1e3,1>b?!0:(this.last=a,!1)},d.prototype.mapPositionToPoint=function(a,b,c){var d=this.interactionDOMElement.getBoundingClientRect();a.x=(b-d.left)*(this.interactionDOMElement.width/d.width)/this.resolution,a.y=(c-d.top)*(this.interactionDOMElement.height/d.height)/this.resolution},d.prototype.processInteractive=function(a,b,c,d,e){if(!b.visible)return!1;var f=b.children,g=!1;if(e=e||b.interactive,b.interactiveChildren)for(var h=f.length-1;h>=0;h--)!g&&d?g=this.processInteractive(a,f[h],c,!0,e):this.processInteractive(a,f[h],c,!1,!1);return e&&(d&&(b.hitArea?(b.worldTransform.applyInverse(a,this._tempPoint),g=b.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):b.containsPoint&&(g=b.containsPoint(a))),b.interactive&&c(b,g)),g},d.prototype.onMouseDown=function(a){this.mouse.originalEvent=a,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.autoPreventDefault&&this.mouse.originalEvent.preventDefault(),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0)},d.prototype.processMouseDown=function(a,b){var c=this.mouse.originalEvent,d=2===c.button||3===c.which;b&&(a[d?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(a,d?"rightdown":"mousedown",this.eventData))},d.prototype.onMouseUp=function(a){this.mouse.originalEvent=a,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0)},d.prototype.processMouseUp=function(a,b){var c=this.mouse.originalEvent,d=2===c.button||3===c.which,e=d?"_isRightDown":"_isLeftDown";b?(this.dispatchEvent(a,d?"rightup":"mouseup",this.eventData),a[e]&&(a[e]=!1,this.dispatchEvent(a,d?"rightclick":"click",this.eventData))):a[e]&&(a[e]=!1,this.dispatchEvent(a,d?"rightupoutside":"mouseupoutside",this.eventData))},d.prototype.onMouseMove=function(a){this.mouse.originalEvent=a,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY),this.didMove=!0,this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)},d.prototype.processMouseMove=function(a,b){this.dispatchEvent(a,"mousemove",this.eventData),this.processMouseOverOut(a,b)},d.prototype.onMouseOut=function(a){this.mouse.originalEvent=a,this.eventData.stopped=!1,this.interactionDOMElement.style.cursor="inherit",this.mapPositionToPoint(this.mouse.global,a.clientX,a.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1)},d.prototype.processMouseOverOut=function(a,b){b?(a._over||(a._over=!0,this.dispatchEvent(a,"mouseover",this.eventData)),a.buttonMode&&(this.cursor=a.defaultCursor)):a._over&&(a._over=!1,this.dispatchEvent(a,"mouseout",this.eventData))},d.prototype.onTouchStart=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,c=b.length,d=0;c>d;d++){var e=b[d],f=this.getTouchData(e);f.originalEvent=a,this.eventData.data=f,this.eventData.stopped=!1,this.processInteractive(f.global,this.renderer._lastObjectRendered,this.processTouchStart,!0),this.returnTouchData(f)}},d.prototype.processTouchStart=function(a,b){b&&(a._touchDown=!0,this.dispatchEvent(a,"touchstart",this.eventData))},d.prototype.onTouchEnd=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,c=b.length,d=0;c>d;d++){var e=b[d],f=this.getTouchData(e);f.originalEvent=a,this.eventData.data=f,this.eventData.stopped=!1,this.processInteractive(f.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0),this.returnTouchData(f)}},d.prototype.processTouchEnd=function(a,b){b?(this.dispatchEvent(a,"touchend",this.eventData),a._touchDown&&(a._touchDown=!1,this.dispatchEvent(a,"tap",this.eventData))):a._touchDown&&(a._touchDown=!1,this.dispatchEvent(a,"touchendoutside",this.eventData))},d.prototype.onTouchMove=function(a){this.autoPreventDefault&&a.preventDefault();for(var b=a.changedTouches,c=b.length,d=0;c>d;d++){var e=b[d],f=this.getTouchData(e);f.originalEvent=a,this.eventData.data=f,this.eventData.stopped=!1,this.processInteractive(f.global,this.renderer._lastObjectRendered,this.processTouchMove,!1),this.returnTouchData(f)}},d.prototype.processTouchMove=function(a,b){b=b,this.dispatchEvent(a,"touchmove",this.eventData)},d.prototype.getTouchData=function(a){var b=this.interactiveDataPool.pop();return b||(b=new f),b.identifier=a.identifier,this.mapPositionToPoint(b.global,a.clientX,a.clientY),a.globalX=b.global.x,a.globalY=b.global.y,b},d.prototype.returnTouchData=function(a){this.interactiveDataPool.push(a)},d.prototype.destroy=function(){this.renderer=null,this.mouse=null,this.eventData=null,this.interactiveDataPool=null,this.interactionDOMElement=null,this.onMouseUp=null,this.processMouseUp=null,this.onMouseDown=null,this.processMouseDown=null,this.onMouseMove=null,this.processMouseMove=null,this.onMouseOut=null,this.processMouseOverOut=null,this.onTouchStart=null,this.processTouchStart=null,this.onTouchEnd=null,this.processTouchEnd=null,this.onTouchMove=null,this.processTouchMove=null,this._tempPoint=null,this.updateBound=null},e.WebGLRenderer.registerPlugin("interaction",d),e.CanvasRenderer.registerPlugin("interaction",d)},{"../core":20,"./InteractionData":105,"./interactiveTarget":108}],107:[function(a,b,c){b.exports={InteractionData:a("./InteractionData"),InteractionManager:a("./InteractionManager"),interactiveTarget:a("./interactiveTarget")}},{"./InteractionData":105,"./InteractionManager":106,"./interactiveTarget":108}],108:[function(a,b,c){b.exports={interactive:!1,buttonMode:!1,interactiveChildren:!0,defaultCursor:"pointer",_over:!1,_touchDown:!1}},{}],109:[function(a,b,c){var d=a("resource-loader").Resource,e=a("../core"),f=a("../extras"),g=a("path");b.exports=function(){return function(a,b){if(!a.data)return b();var c=a.data.nodeName&&a.data.nodeName.toLowerCase();if(!c||"#document"!==c&&"div"!==c)return b();if(0===a.data.getElementsByTagName("page").length||0===a.data.getElementsByTagName("info").length||null===a.data.getElementsByTagName("info")[0].getAttribute("face"))return b();var h=g.dirname(a.url);"."===h&&(h=""),this.baseUrl&&h&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(h+="/"),h=h.replace(this.baseUrl,"")),h&&"/"!==h.charAt(h.length-1)&&(h+="/");var i=h+a.data.getElementsByTagName("page")[0].getAttribute("file"),j={crossOrigin:a.crossOrigin,loadType:d.LOAD_TYPE.IMAGE};this.add(a.name+"_image",i,j,function(c){var d={},g=a.data.getElementsByTagName("info")[0],h=a.data.getElementsByTagName("common")[0];d.font=g.getAttribute("face"),d.size=parseInt(g.getAttribute("size"),10),d.lineHeight=parseInt(h.getAttribute("lineHeight"),10),d.chars={};for(var i=a.data.getElementsByTagName("char"),j=0;j<i.length;j++){var k=parseInt(i[j].getAttribute("id"),10),l=new e.math.Rectangle(parseInt(i[j].getAttribute("x"),10),parseInt(i[j].getAttribute("y"),10),parseInt(i[j].getAttribute("width"),10),parseInt(i[j].getAttribute("height"),10));d.chars[k]={xOffset:parseInt(i[j].getAttribute("xoffset"),10),yOffset:parseInt(i[j].getAttribute("yoffset"),10),
xAdvance:parseInt(i[j].getAttribute("xadvance"),10),kerning:{},texture:e.utils.TextureCache[k]=new e.Texture(c.texture.baseTexture,l)}}var m=a.data.getElementsByTagName("kerning");for(j=0;j<m.length;j++){var n=parseInt(m[j].getAttribute("first"),10),o=parseInt(m[j].getAttribute("second"),10),p=parseInt(m[j].getAttribute("amount"),10);d.chars[o].kerning[n]=p}a.bitmapFont=d,f.BitmapText.fonts[d.font]=d,b()})}}},{"../core":20,"../extras":76,path:1,"resource-loader":9}],110:[function(a,b,c){b.exports={Loader:a("./loader"),bitmapFontParser:a("./bitmapFontParser"),spineAtlasParser:a("./spineAtlasParser"),spritesheetParser:a("./spritesheetParser"),textureParser:a("./textureParser")}},{"./bitmapFontParser":109,"./loader":111,"./spineAtlasParser":112,"./spritesheetParser":113,"./textureParser":114}],111:[function(a,b,c){function d(a,b){e.call(this,a,b),this.use(e.middleware.parsing.blob()),this.use(f()),this.use(g()),this.use(h()),this.use(i())}var e=a("resource-loader"),f=a("./textureParser"),g=a("./spritesheetParser"),h=a("./spineAtlasParser"),i=a("./bitmapFontParser");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"./bitmapFontParser":109,"./spineAtlasParser":112,"./spritesheetParser":113,"./textureParser":114,"resource-loader":9}],112:[function(a,b,c){var d=a("resource-loader").Resource,e=a("async"),f=a("../spine");b.exports=function(){return function(a,b){if(!a.data||!a.data.bones)return b();var c=a.url.substr(0,a.url.lastIndexOf("."))+".atlas",g={crossOrigin:a.crossOrigin,xhrType:d.XHR_RESPONSE_TYPE.TEXT},h=a.url.substr(0,a.url.lastIndexOf("/")+1);this.add(a.name+"_atlas",c,g,function(c){var d=new f.SpineRuntime.Atlas(this.xhr.responseText,h,c.crossOrigin),g=new f.SpineRuntime.SkeletonJsonParser(new f.SpineRuntime.AtlasAttachmentParser(d)),i=g.readSkeletonData(a.data);a.spineData=i,a.spineAtlas=d,e.each(d.pages,function(a,b){a.rendererObject.hasLoaded?b():a.rendererObject.once("loaded",b)},b)})}}},{"../spine":125,async:3,"resource-loader":9}],113:[function(a,b,c){var d=a("resource-loader").Resource,e=a("path"),f=a("../core");b.exports=function(){return function(a,b){if(!a.data||!a.data.frames)return b();var c={crossOrigin:a.crossOrigin,loadType:d.LOAD_TYPE.IMAGE},g=e.dirname(a.url.replace(this.baseUrl,"")),h=f.utils.getResolutionOfUrl(a.url);this.add(a.name+"_image",g+"/"+a.data.meta.image,c,function(c){a.textures={};var d=a.data.frames;for(var e in d){var g=d[e].frame;if(g){var i=null,j=null;if(i=d[e].rotated?new f.math.Rectangle(g.x,g.y,g.h,g.w):new f.math.Rectangle(g.x,g.y,g.w,g.h),d[e].trimmed&&(j=new f.math.Rectangle(d[e].spriteSourceSize.x/h,d[e].spriteSourceSize.y/h,d[e].sourceSize.w/h,d[e].sourceSize.h/h)),d[e].rotated){var k=i.width;i.width=i.height,i.height=k}i.x/=h,i.y/=h,i.width/=h,i.height/=h,a.textures[e]=new f.Texture(c.texture.baseTexture,i,i.clone(),j,d[e].rotated),f.utils.TextureCache[e]=a.textures[e]}}b()})}}},{"../core":20,path:1,"resource-loader":9}],114:[function(a,b,c){var d=a("../core");b.exports=function(){return function(a,b){a.data&&a.data.nodeName&&"img"===a.data.nodeName.toLowerCase()&&(a.texture=new d.Texture(new d.BaseTexture(a.data,null,d.utils.getResolutionOfUrl(a.url))),d.utils.TextureCache[a.url]=a.texture),b()}}},{"../core":20}],115:[function(a,b,c){function d(a,b,c,f,g){e.Container.call(this),this.texture=a,this.uvs=c||new Float32Array([0,1,1,1,1,0,0,1]),this.vertices=b||new Float32Array([0,0,100,0,100,100,0,100]),this.indices=f||new Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=e.BLEND_MODES.NORMAL,this.canvasPadding=0,this.drawMode=g||d.DRAW_MODES.TRIANGLE_MESH}var e=a("../core");d.prototype=Object.create(e.Container.prototype),d.prototype.constructor=d,b.exports=d,d.prototype._renderWebGL=function(a){a.setObjectRenderer(a.plugins.mesh),a.plugins.mesh.render(this)},d.prototype._renderCanvas=function(a){var b=a.context,c=this.worldTransform;a.roundPixels?b.setTransform(c.a,c.b,c.c,c.d,0|c.tx,0|c.ty):b.setTransform(c.a,c.b,c.c,c.d,c.tx,c.ty),this.drawMode===d.DRAW_MODES.TRIANGLE_MESH?this._renderCanvasTriangleMesh(b):this._renderCanvasTriangles(b)},d.prototype._renderCanvasTriangleMesh=function(a){for(var b=this.vertices,c=this.uvs,d=b.length/2,e=0;d-2>e;e++){var f=2*e;this._renderCanvasDrawTriangle(a,b,c,f,f+2,f+4)}},d.prototype._renderCanvasTriangles=function(a){for(var b=this.vertices,c=this.uvs,d=this.indices,e=d.length,f=0;e>f;f+=3){var g=2*d[f],h=2*d[f+1],i=2*d[f+2];this._renderCanvasDrawTriangle(a,b,c,g,h,i)}},d.prototype._renderCanvasDrawTriangle=function(a,b,c,d,e,f){var g=this.texture.baseTexture.source,h=this.texture.width,i=this.texture.height,j=b[d],k=b[e],l=b[f],m=b[d+1],n=b[e+1],o=b[f+1],p=c[d]*h,q=c[e]*h,r=c[f]*h,s=c[d+1]*i,t=c[e+1]*i,u=c[f+1]*i;if(this.canvasPadding>0){var v=this.canvasPadding/this.worldTransform.a,w=this.canvasPadding/this.worldTransform.d,x=(j+k+l)/3,y=(m+n+o)/3,z=j-x,A=m-y,B=Math.sqrt(z*z+A*A);j=x+z/B*(B+v),m=y+A/B*(B+w),z=k-x,A=n-y,B=Math.sqrt(z*z+A*A),k=x+z/B*(B+v),n=y+A/B*(B+w),z=l-x,A=o-y,B=Math.sqrt(z*z+A*A),l=x+z/B*(B+v),o=y+A/B*(B+w)}a.save(),a.beginPath(),a.moveTo(j,m),a.lineTo(k,n),a.lineTo(l,o),a.closePath(),a.clip();var C=p*t+s*r+q*u-t*r-s*q-p*u,D=j*t+s*l+k*u-t*l-s*k-j*u,E=p*k+j*r+q*l-k*r-j*q-p*l,F=p*t*l+s*k*r+j*q*u-j*t*r-s*q*l-p*k*u,G=m*t+s*o+n*u-t*o-s*n-m*u,H=p*n+m*r+q*o-n*r-m*q-p*o,I=p*t*o+s*n*r+m*q*u-m*t*r-s*q*o-p*n*u;a.transform(D/C,G/C,E/C,H/C,F/C,I/C),a.drawImage(g,0,0),a.restore()},d.prototype.renderMeshFlat=function(a){var b=this.context,c=a.vertices,d=c.length/2;b.beginPath();for(var e=1;d-2>e;e++){var f=2*e,g=c[f],h=c[f+2],i=c[f+4],j=c[f+1],k=c[f+3],l=c[f+5];b.moveTo(g,j),b.lineTo(h,k),b.lineTo(i,l)}b.fillStyle="#FF0000",b.fill(),b.closePath()},d.prototype.onTextureUpdate=function(){this.updateFrame=!0},d.prototype.getBounds=function(a){for(var b=a||this.worldTransform,c=b.a,d=b.b,f=b.c,g=b.d,h=b.tx,i=b.ty,j=-(1/0),k=-(1/0),l=1/0,m=1/0,n=this.vertices,o=0,p=n.length;p>o;o+=2){var q=n[o],r=n[o+1],s=c*q+f*r+h,t=g*r+d*q+i;l=l>s?s:l,m=m>t?t:m,j=s>j?s:j,k=t>k?t:k}if(l===-(1/0)||k===1/0)return e.math.Rectangle.EMPTY;var u=this._bounds;return u.x=l,u.width=j-l,u.y=m,u.height=k-m,this._currentBounds=u,u},d.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":20}],116:[function(a,b,c){function d(a,b){e.call(this,a),this.points=b,this.vertices=new Float32Array(4*b.length),this.uvs=new Float32Array(4*b.length),this.colors=new Float32Array(2*b.length),this.indices=new Uint16Array(2*b.length),this.refresh()}var e=a("./Mesh");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,d.prototype.refresh=function(){var a=this.points;if(!(a.length<1)){var b=this.uvs,c=this.indices,d=this.colors;b[0]=0,b[1]=0,b[2]=0,b[3]=1,d[0]=1,d[1]=1,c[0]=0,c[1]=1;for(var e,f,g,h=a.length,i=1;h>i;i++)e=a[i],f=4*i,g=i/(h-1),i%2?(b[f]=g,b[f+1]=0,b[f+2]=g,b[f+3]=1):(b[f]=g,b[f+1]=0,b[f+2]=g,b[f+3]=1),f=2*i,d[f]=1,d[f+1]=1,f=2*i,c[f]=f,c[f+1]=f+1}},d.prototype.updateTransform=function(){var a=this.points;if(!(a.length<1)){for(var b,c,d,e,f,g,h=a[0],i=0,j=0,k=this.vertices,l=a.length,m=0;l>m;m++)c=a[m],d=4*m,b=m<a.length-1?a[m+1]:c,j=-(b.x-h.x),i=b.y-h.y,e=10*(1-m/(l-1)),e>1&&(e=1),f=Math.sqrt(i*i+j*j),g=this.texture.height/2,i/=f,j/=f,i*=g,j*=g,k[d]=c.x+i,k[d+1]=c.y+j,k[d+2]=c.x-i,k[d+3]=c.y-j,h=c;this.containerUpdateTransform()}}},{"./Mesh":115}],117:[function(a,b,c){b.exports={Mesh:a("./Mesh"),Rope:a("./Rope"),MeshRenderer:a("./webgl/MeshRenderer"),MeshShader:a("./webgl/MeshShader")}},{"./Mesh":115,"./Rope":116,"./webgl/MeshRenderer":118,"./webgl/MeshShader":119}],118:[function(a,b,c){function d(a){e.call(this,a),this.indices=new Uint16Array(15e3);for(var b=0,c=0;15e3>b;b+=6,c+=4)this.indices[b+0]=c+0,this.indices[b+1]=c+1,this.indices[b+2]=c+2,this.indices[b+3]=c+0,this.indices[b+4]=c+2,this.indices[b+5]=c+3}var e=a("../../core/renderers/webgl/utils/ObjectRenderer"),f=a("../../core/renderers/webgl/WebGLRenderer");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d,f.registerPlugin("mesh",d),d.prototype.onContextChange=function(){},d.prototype.render=function(a){a._vertexBuffer||this._initWebGL(a);var b=this.renderer,c=b.gl,d=a.texture.baseTexture,e=b.shaderManager.plugins.meshShader,f=c.TRIANGLE_STRIP;b.blendModeManager.setBlendMode(a.blendMode),c.uniformMatrix3fv(e.uniforms.translationMatrix._location,!1,a.worldTransform.toArray(!0)),c.uniformMatrix3fv(e.uniforms.projectionMatrix._location,!1,b.currentRenderTarget.projectionMatrix.toArray(!0)),c.uniform1f(e.uniforms.alpha._location,a.worldAlpha),a.dirty?(a.dirty=!1,c.bindBuffer(c.ARRAY_BUFFER,a._vertexBuffer),c.bufferData(c.ARRAY_BUFFER,a.vertices,c.STATIC_DRAW),c.vertexAttribPointer(e.attributes.aVertexPosition,2,c.FLOAT,!1,0,0),c.bindBuffer(c.ARRAY_BUFFER,a._uvBuffer),c.bufferData(c.ARRAY_BUFFER,a.uvs,c.STATIC_DRAW),c.vertexAttribPointer(e.attributes.aTextureCoord,2,c.FLOAT,!1,0,0),c.activeTexture(c.TEXTURE0),d._glTextures[c.id]?c.bindTexture(c.TEXTURE_2D,d._glTextures[c.id]):this.renderer.updateTexture(d),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,a._indexBuffer),c.bufferData(c.ELEMENT_ARRAY_BUFFER,a.indices,c.STATIC_DRAW)):(c.bindBuffer(c.ARRAY_BUFFER,a._vertexBuffer),c.bufferSubData(c.ARRAY_BUFFER,0,a.vertices),c.vertexAttribPointer(e.attributes.aVertexPosition,2,c.FLOAT,!1,0,0),c.bindBuffer(c.ARRAY_BUFFER,a._uvBuffer),c.vertexAttribPointer(e.attributes.aTextureCoord,2,c.FLOAT,!1,0,0),c.activeTexture(c.TEXTURE0),d._glTextures[c.id]?c.bindTexture(c.TEXTURE_2D,d._glTextures[c.id]):this.renderer.updateTexture(d)),c.drawElements(f,a.indices.length,c.UNSIGNED_SHORT,0)},d.prototype._initWebGL=function(a){var b=this.renderer.gl;a._vertexBuffer=b.createBuffer(),a._indexBuffer=b.createBuffer(),a._uvBuffer=b.createBuffer(),a._colorBuffer=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,a._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,a.vertices,b.DYNAMIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,a._uvBuffer),b.bufferData(b.ARRAY_BUFFER,a.uvs,b.STATIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,a._colorBuffer),b.bufferData(b.ARRAY_BUFFER,a.colors,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,a.indices,b.STATIC_DRAW)},d.prototype.flush=function(){},d.prototype.start=function(){var a=this.renderer.shaderManager.plugins.meshShader;this.renderer.shaderManager.setShader(a)},d.prototype.destroy=function(){}},{"../../core/renderers/webgl/WebGLRenderer":39,"../../core/renderers/webgl/utils/ObjectRenderer":53}],119:[function(a,b,c){function d(a){e.Shader.call(this,a,["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * alpha ;","}"].join("\n"),{alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aTextureCoord:0})}var e=a("../../core");d.prototype=Object.create(e.Shader.prototype),d.prototype.constructor=d,b.exports=d,e.ShaderManager.registerPlugin("meshShader",d)},{"../../core":20}],120:[function(a,b,c){Object.assign||(Object.assign=a("object-assign"))},{"object-assign":5}],121:[function(a,b,c){a("./Object.assign"),a("./requestAnimationFrame")},{"./Object.assign":120,"./requestAnimationFrame":122}],122:[function(a,b,c){(function(a){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!a.performance||!a.performance.now){var b=Date.now();a.performance||(a.performance={}),a.performance.now=function(){return Date.now()-b}}for(var c=Date.now(),d=["ms","moz","webkit","o"],e=0;e<d.length&&!a.requestAnimationFrame;++e)a.requestAnimationFrame=a[d[e]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[d[e]+"CancelAnimationFrame"]||a[d[e]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(b){if("function"!=typeof b)throw new TypeError(b+"is not a function");var d=Date.now(),e=16+c-d;return 0>e&&(e=0),c=d,setTimeout(function(){c=Date.now(),b(a.performance.now())},e)}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){clearTimeout(a)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],123:[function(a,b,c){function d(a){if(e.Container.call(this),!a)throw new Error("The spineData param is required.");this.spineData=a,this.skeleton=new f.Skeleton(a),this.skeleton.updateWorldTransform(),this.stateData=new f.AnimationStateData(a),this.state=new f.AnimationState(this.stateData),this.slotContainers=[];for(var b=0,c=this.skeleton.drawOrder.length;c>b;b++){var d=this.skeleton.drawOrder[b],g=d.attachment,h=new e.Container;if(this.slotContainers.push(h),this.addChild(h),g instanceof f.RegionAttachment){var i=g.rendererObject.name,j=this.createSprite(d,g);d.currentSprite=j,d.currentSpriteName=i,h.addChild(j)}else{if(!(g instanceof f.MeshAttachment))continue;var k=this.createMesh(d,g);d.currentMesh=k,d.currentMeshName=g.name,h.addChild(k)}}this.autoUpdate=!0}var e=a("../core"),f=a("./SpineRuntime");f.Bone.yDown=!0,d.prototype=Object.create(e.Container.prototype),d.prototype.constructor=d,b.exports=d,Object.defineProperties(d.prototype,{autoUpdate:{get:function(){return this.updateTransform===d.prototype.autoUpdateTransform},set:function(a){this.updateTransform=a?d.prototype.autoUpdateTransform:e.Container.prototype.updateTransform}}}),d.prototype.update=function(a){this.state.update(a),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var b=this.skeleton.drawOrder,c=0,d=b.length;d>c;c++){var g=b[c],h=g.attachment,i=this.slotContainers[c];if(h){var j=h.type;if(j===f.AttachmentType.region){if(h.rendererObject&&(!g.currentSpriteName||g.currentSpriteName!==h.rendererObject.name)){var k=h.rendererObject.name;if(void 0!==g.currentSprite&&(g.currentSprite.visible=!1),g.sprites=g.sprites||{},void 0!==g.sprites[k])g.sprites[k].visible=!0;else{var l=this.createSprite(g,h);i.addChild(l)}g.currentSprite=g.sprites[k],g.currentSpriteName=k}var m=g.bone;i.position.x=m.worldX+h.x*m.m00+h.y*m.m01,i.position.y=m.worldY+h.x*m.m10+h.y*m.m11,i.scale.x=m.worldScaleX,i.scale.y=m.worldScaleY,i.rotation=-(g.bone.worldRotation*f.degRad),g.currentSprite.tint=e.utils.rgb2hex([g.r,g.g,g.b])}else{if(j!==f.AttachmentType.skinnedmesh){i.visible=!1;continue}if(!g.currentMeshName||g.currentMeshName!==h.name){var n=h.name;if(void 0!==g.currentMesh&&(g.currentMesh.visible=!1),g.meshes=g.meshes||{},void 0!==g.meshes[n])g.meshes[n].visible=!0;else{var o=this.createMesh(g,h);i.addChild(o)}g.currentMesh=g.meshes[n],g.currentMeshName=n}h.computeWorldVertices(g.bone.skeleton.x,g.bone.skeleton.y,g,g.currentMesh.vertices)}i.visible=!0,i.alpha=g.a}else i.visible=!1}},d.prototype.autoUpdateTransform=function(){this.lastTime=this.lastTime||Date.now();var a=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(a),e.Container.prototype.updateTransform.call(this)},d.prototype.createSprite=function(a,b){var c=b.rendererObject,d=c.page.rendererObject,g=new e.math.Rectangle(c.x,c.y,c.rotate?c.height:c.width,c.rotate?c.width:c.height),h=new e.Texture(d,g),i=new e.Sprite(h),j=c.rotate?.5*Math.PI:0;return i.scale.set(c.width/c.originalWidth,c.height/c.originalHeight),i.rotation=j-b.rotation*f.degRad,i.anchor.x=i.anchor.y=.5,a.sprites=a.sprites||{},a.sprites[c.name]=i,i},d.prototype.createMesh=function(a,b){var c=b.rendererObject,d=c.page.rendererObject,f=new e.Texture(d),g=new e.Strip(f);return g.drawMode=e.Strip.DRAW_MODES.TRIANGLES,g.canvasPadding=1.5,g.vertices=new Float32Array(b.uvs.length),g.uvs=b.uvs,g.indices=b.triangles,a.meshes=a.meshes||{},a.meshes[b.name]=g,g}},{"../core":20,"./SpineRuntime":124}],124:[function(a,b,c){var d=a("../core"),e=b.exports={radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:"undefined"==typeof Float32Array?Array:Float32Array,Uint16Array:"undefined"==typeof Uint16Array?Array:Uint16Array};e.BoneData=function(a,b){this.name=a,this.parent=b},e.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0,flipX:!1,flipY:!1},e.SlotData=function(a,b){this.name=a,this.boneData=b},e.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,additiveBlending:!1},e.IkConstraintData=function(a){this.name=a,this.bones=[]},e.IkConstraintData.prototype={target:null,bendDirection:1,mix:1},e.Bone=function(a,b,c){this.data=a,this.skeleton=b,this.parent=c,this.setToSetupPose()},e.Bone.yDown=!1,e.Bone.prototype={x:0,y:0,rotation:0,rotationIK:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,worldFlipX:!1,worldFlipY:!1,updateWorldTransform:function(){var a=this.parent;if(a)this.worldX=this.x*a.m00+this.y*a.m01+a.worldX,this.worldY=this.x*a.m10+this.y*a.m11+a.worldY,this.data.inheritScale?(this.worldScaleX=a.worldScaleX*this.scaleX,this.worldScaleY=a.worldScaleY*this.scaleY):(this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY),this.worldRotation=this.data.inheritRotation?a.worldRotation+this.rotationIK:this.rotationIK,this.worldFlipX=a.worldFlipX!=this.flipX,this.worldFlipY=a.worldFlipY!=this.flipY;else{var b=this.skeleton.flipX,c=this.skeleton.flipY;this.worldX=b?-this.x:this.x,this.worldY=c!=e.Bone.yDown?-this.y:this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotationIK,this.worldFlipX=b!=this.flipX,this.worldFlipY=c!=this.flipY}var d=this.worldRotation*e.degRad,f=Math.cos(d),g=Math.sin(d);this.worldFlipX?(this.m00=-f*this.worldScaleX,this.m01=g*this.worldScaleY):(this.m00=f*this.worldScaleX,this.m01=-g*this.worldScaleY),this.worldFlipY!=e.Bone.yDown?(this.m10=-g*this.worldScaleX,this.m11=-f*this.worldScaleY):(this.m10=g*this.worldScaleX,this.m11=f*this.worldScaleY)},setToSetupPose:function(){var a=this.data;this.x=a.x,this.y=a.y,this.rotation=a.rotation,this.rotationIK=this.rotation,this.scaleX=a.scaleX,this.scaleY=a.scaleY,this.flipX=a.flipX,this.flipY=a.flipY},worldToLocal:function(a){var b=a[0]-this.worldX,c=a[1]-this.worldY,d=this.m00,f=this.m10,g=this.m01,h=this.m11;this.worldFlipX!=(this.worldFlipY!=e.Bone.yDown)&&(d=-d,h=-h);var i=1/(d*h-g*f);a[0]=b*d*i-c*g*i,a[1]=c*h*i-b*f*i},localToWorld:function(a){var b=a[0],c=a[1];a[0]=b*this.m00+c*this.m01+this.worldX,a[1]=b*this.m10+c*this.m11+this.worldY}},e.Slot=function(a,b){this.data=a,this.bone=b,this.setToSetupPose()},e.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,attachmentVertices:[],setAttachment:function(a){this.attachment=a,this._attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0},setAttachmentTime:function(a){this._attachmentTime=this.bone.skeleton.time-a},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var a=this.data;this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a;for(var b=this.bone.skeleton.data.slots,c=0,d=b.length;d>c;c++)if(b[c]==a){this.setAttachment(a.attachmentName?this.bone.skeleton.getAttachmentBySlotIndex(c,a.attachmentName):null);break}}},e.IkConstraint=function(a,b){this.data=a,this.mix=a.mix,this.bendDirection=a.bendDirection,this.bones=[];for(var c=0,d=a.bones.length;d>c;c++)this.bones.push(b.findBone(a.bones[c].name));this.target=b.findBone(a.target.name)},e.IkConstraint.prototype={apply:function(){var a=this.target,b=this.bones;switch(b.length){case 1:e.IkConstraint.apply1(b[0],a.worldX,a.worldY,this.mix);break;case 2:e.IkConstraint.apply2(b[0],b[1],a.worldX,a.worldY,this.bendDirection,this.mix)}}},e.IkConstraint.apply1=function(a,b,c,d){var f=a.data.inheritRotation&&a.parent?a.parent.worldRotation:0,g=a.rotation,h=Math.atan2(c-a.worldY,b-a.worldX)*e.radDeg-f;a.rotationIK=g+(h-g)*d},e.IkConstraint.apply2=function(a,b,c,d,f,g){var h=b.rotation,i=a.rotation;if(!g)return b.rotationIK=h,void(a.rotationIK=i);var j,k,l=e.temp,m=a.parent;m?(l[0]=c,l[1]=d,m.worldToLocal(l),c=(l[0]-a.x)*m.worldScaleX,d=(l[1]-a.y)*m.worldScaleY):(c-=a.x,d-=a.y),b.parent==a?(j=b.x,k=b.y):(l[0]=b.x,l[1]=b.y,b.parent.localToWorld(l),a.worldToLocal(l),j=l[0],k=l[1]);var n=j*a.worldScaleX,o=k*a.worldScaleY,p=Math.atan2(o,n),q=Math.sqrt(n*n+o*o),r=b.data.length*b.worldScaleX,s=2*q*r;if(1e-4>s)return void(b.rotationIK=h+(Math.atan2(d,c)*e.radDeg-i-h)*g);var t=(c*c+d*d-q*q-r*r)/s;-1>t?t=-1:t>1&&(t=1);var u=Math.acos(t)*f,v=q+r*t,w=r*Math.sin(u),x=Math.atan2(d*v-c*w,c*v+d*w),y=(x-p)*e.radDeg-i;y>180?y-=360:-180>y&&(y+=360),a.rotationIK=i+y*g,y=(u+p)*e.radDeg-h,y>180?y-=360:-180>y&&(y+=360),b.rotationIK=h+(y+a.worldRotation-b.parent.worldRotation)*g},e.Skin=function(a){this.name=a,this.attachments={}},e.Skin.prototype={addAttachment:function(a,b,c){this.attachments[a+":"+b]=c},getAttachment:function(a,b){return this.attachments[a+":"+b]},_attachAll:function(a,b){for(var c in b.attachments){var d=c.indexOf(":"),e=parseInt(c.substring(0,d)),f=c.substring(d+1),g=a.slots[e];if(g.attachment&&g.attachment.name==f){var h=this.getAttachment(e,f);h&&g.setAttachment(h)}}}},e.Animation=function(a,b,c){this.name=a,this.timelines=b,this.duration=c},e.Animation.prototype={apply:function(a,b,c,d,e){d&&0!=this.duration&&(c%=this.duration,b%=this.duration);for(var f=this.timelines,g=0,h=f.length;h>g;g++)f[g].apply(a,b,c,e,1)},mix:function(a,b,c,d,e,f){d&&0!=this.duration&&(c%=this.duration,b%=this.duration);for(var g=this.timelines,h=0,i=g.length;i>h;h++)g[h].apply(a,b,c,e,f)}},e.Animation.binarySearch=function(a,b,c){var d=0,e=Math.floor(a.length/c)-2;if(!e)return c;for(var f=e>>>1;;){if(a[(f+1)*c]<=b?d=f+1:e=f,d==e)return(d+1)*c;f=d+e>>>1}},e.Animation.binarySearch1=function(a,b){var c=0,d=a.length-2;if(!d)return 1;for(var e=d>>>1;;){if(a[e+1]<=b?c=e+1:d=e,c==d)return c+1;e=c+d>>>1}},e.Animation.linearSearch=function(a,b,c){for(var d=0,e=a.length-c;e>=d;d+=c)if(a[d]>b)return d;return-1},e.Curves=function(a){this.curves=[]},e.Curves.prototype={setLinear:function(a){this.curves[19*a]=0},setStepped:function(a){this.curves[19*a]=1},setCurve:function(a,b,c,d,e){var f=.1,g=f*f,h=g*f,i=3*f,j=3*g,k=6*g,l=6*h,m=2*-b+d,n=2*-c+e,o=3*(b-d)+1,p=3*(c-e)+1,q=b*i+m*j+o*h,r=c*i+n*j+p*h,s=m*k+o*l,t=n*k+p*l,u=o*l,v=p*l,w=19*a,x=this.curves;x[w++]=2;for(var y=q,z=r,A=w+19-1;A>w;w+=2)x[w]=y,x[w+1]=z,q+=s,r+=t,s+=u,t+=v,y+=q,z+=r},getCurvePercent:function(a,b){b=0>b?0:b>1?1:b;var c=this.curves,d=19*a,e=c[d];if(0===e)return b;if(1==e)return 0;d++;for(var f=0,g=d,h=d+19-1;h>d;d+=2)if(f=c[d],f>=b){var i,j;return d==g?(i=0,j=0):(i=c[d-2],j=c[d-1]),j+(c[d+1]-j)*(b-i)/(f-i)}var k=c[d-1];return k+(1-k)*(b-f)/(1-f)}},e.RotateTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=2*a},e.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h=a.bones[this.boneIndex];if(c>=g[g.length-2]){for(var i=h.data.rotation+g[g.length-1]-h.rotation;i>180;)i-=360;for(;-180>i;)i+=360;return void(h.rotation+=i*f)}var j=e.Animation.binarySearch(g,c,2),k=g[j-1],l=g[j],m=1-(c-l)/(g[j-2]-l);m=this.curves.getCurvePercent(j/2-1,m);for(var i=g[j+1]-k;i>180;)i-=360;for(;-180>i;)i+=360;for(i=h.data.rotation+(k+i*m)-h.rotation;i>180;)i-=360;for(;-180>i;)i+=360;h.rotation+=i*f}}},e.TranslateTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=3*a},e.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h=a.bones[this.boneIndex];if(c>=g[g.length-3])return h.x+=(h.data.x+g[g.length-2]-h.x)*f,void(h.y+=(h.data.y+g[g.length-1]-h.y)*f);var i=e.Animation.binarySearch(g,c,3),j=g[i-2],k=g[i-1],l=g[i],m=1-(c-l)/(g[i+-3]-l);m=this.curves.getCurvePercent(i/3-1,m),h.x+=(h.data.x+j+(g[i+1]-j)*m-h.x)*f,h.y+=(h.data.y+k+(g[i+2]-k)*m-h.y)*f}}},e.ScaleTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=3*a},e.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h=a.bones[this.boneIndex];if(c>=g[g.length-3])return h.scaleX+=(h.data.scaleX*g[g.length-2]-h.scaleX)*f,void(h.scaleY+=(h.data.scaleY*g[g.length-1]-h.scaleY)*f);var i=e.Animation.binarySearch(g,c,3),j=g[i-2],k=g[i-1],l=g[i],m=1-(c-l)/(g[i+-3]-l);m=this.curves.getCurvePercent(i/3-1,m),h.scaleX+=(h.data.scaleX*(j+(g[i+1]-j)*m)-h.scaleX)*f,h.scaleY+=(h.data.scaleY*(k+(g[i+2]-k)*m)-h.scaleY)*f}}},e.ColorTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=5*a},e.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(a,b,c,d,e,f){a*=5,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d,this.frames[a+3]=e,this.frames[a+4]=f},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h,i,j,k;if(c>=g[g.length-5]){var l=g.length-1;h=g[l-3],i=g[l-2],j=g[l-1],k=g[l]}else{var m=e.Animation.binarySearch(g,c,5),n=g[m-4],o=g[m-3],p=g[m-2],q=g[m-1],r=g[m],s=1-(c-r)/(g[m-5]-r);s=this.curves.getCurvePercent(m/5-1,s),h=n+(g[m+1]-n)*s,i=o+(g[m+2]-o)*s,j=p+(g[m+3]-p)*s,k=q+(g[m+4]-q)*s}var t=a.slots[this.slotIndex];1>f?(t.r+=(h-t.r)*f,t.g+=(i-t.g)*f,t.b+=(j-t.b)*f,t.a+=(k-t.a)*f):(t.r=h,t.g=i,t.b=j,t.a=k)}}},e.AttachmentTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=a,this.attachmentNames=[],this.attachmentNames.length=a},e.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.attachmentNames[a]=c},apply:function(a,b,c,d,f){var g=this.frames;if(c<g[0])return void(b>c&&this.apply(a,b,Number.MAX_VALUE,null,0));b>c&&(b=-1);var h=c>=g[g.length-1]?g.length-1:e.Animation.binarySearch1(g,c)-1;if(!(g[h]<b)){var i=this.attachmentNames[h];a.slots[this.slotIndex].setAttachment(i?a.getAttachmentBySlotIndex(this.slotIndex,i):null)}}},e.EventTimeline=function(a){this.frames=[],this.frames.length=a,this.events=[],this.events.length=a},e.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.events[a]=c},apply:function(a,b,c,d,f){if(d){var g=this.frames,h=g.length;if(b>c)this.apply(a,b,Number.MAX_VALUE,d,f),b=-1;else if(b>=g[h-1])return;if(!(c<g[0])){var i;if(b<g[0])i=0;else{i=e.Animation.binarySearch1(g,b);for(var j=g[i];i>0&&g[i-1]==j;)i--}for(var k=this.events;h>i&&c>=g[i];i++)d.push(k[i])}}}},e.DrawOrderTimeline=function(a){this.frames=[],this.frames.length=a,this.drawOrders=[],this.drawOrders.length=a},e.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.drawOrders[a]=c},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h;h=c>=g[g.length-1]?g.length-1:e.Animation.binarySearch1(g,c)-1;var i=a.drawOrder,j=a.slots,k=this.drawOrders[h];if(k)for(var l=0,m=k.length;m>l;l++)i[l]=a.slots[k[l]];else for(var l=0,m=j.length;m>l;l++)i[l]=j[l]}}},e.FfdTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=a,this.frameVertices=[],this.frameVertices.length=a},e.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.frameVertices[a]=c},apply:function(a,b,c,d,f){var g=a.slots[this.slotIndex];if(g.attachment==this.attachment){var h=this.frames;if(!(c<h[0])){var i=this.frameVertices,j=i[0].length,k=g.attachmentVertices;if(k.length!=j&&(f=1),k.length=j,c>=h[h.length-1]){var l=i[h.length-1];if(1>f)for(var m=0;j>m;m++)k[m]+=(l[m]-k[m])*f;else for(var m=0;j>m;m++)k[m]=l[m]}else{var n=e.Animation.binarySearch1(h,c),o=h[n],p=1-(c-o)/(h[n-1]-o);p=this.curves.getCurvePercent(n-1,0>p?0:p>1?1:p);var q=i[n-1],r=i[n];if(1>f)for(var m=0;j>m;m++){var s=q[m];k[m]+=(s+(r[m]-s)*p-k[m])*f}else for(var m=0;j>m;m++){var s=q[m];k[m]=s+(r[m]-s)*p}}}}}},e.IkConstraintTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=3*a},e.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c,d,f){var g=this.frames;if(!(c<g[0])){var h=a.ikConstraints[this.ikConstraintIndex];if(c>=g[g.length-3])return h.mix+=(g[g.length-2]-h.mix)*f,void(h.bendDirection=g[g.length-1]);var i=e.Animation.binarySearch(g,c,3),j=g[i+-2],k=g[i],l=1-(c-k)/(g[i+-3]-k);l=this.curves.getCurvePercent(i/3-1,l);var m=j+(g[i+1]-j)*l;h.mix+=(m-h.mix)*f,h.bendDirection=g[i+-1]}}},e.FlipXTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=2*a},e.FlipXTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c?1:0},apply:function(a,b,c,d,f){var g=this.frames;if(c<g[0])return void(b>c&&this.apply(a,b,Number.MAX_VALUE,null,0));b>c&&(b=-1);var h=(c>=g[g.length-2]?g.length:e.Animation.binarySearch(g,c,2))-2;g[h]<b||(a.bones[boneIndex].flipX=0!=g[h+1])}},e.FlipYTimeline=function(a){this.curves=new e.Curves(a),this.frames=[],this.frames.length=2*a},e.FlipYTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c?1:0},apply:function(a,b,c,d,f){var g=this.frames;if(c<g[0])return void(b>c&&this.apply(a,b,Number.MAX_VALUE,null,0));b>c&&(b=-1);var h=(c>=g[g.length-2]?g.length:e.Animation.binarySearch(g,c,2))-2;g[h]<b||(a.bones[boneIndex].flipY=0!=g[h+1])}},e.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[]},e.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return slot[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSkin:function(a){for(var b=this.skins,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findEvent:function(a){for(var b=this.events,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findAnimation:function(a){for(var b=this.animations,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findIkConstraint:function(a){for(var b=this.ikConstraints,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null}},e.Skeleton=function(a){this.data=a,this.bones=[];for(var b=0,c=a.bones.length;c>b;b++){var d=a.bones[b],f=d.parent?this.bones[a.bones.indexOf(d.parent)]:null;this.bones.push(new e.Bone(d,this,f))}this.slots=[],this.drawOrder=[];for(var b=0,c=a.slots.length;c>b;b++){var g=a.slots[b],h=this.bones[a.bones.indexOf(g.boneData)],i=new e.Slot(g,h);this.slots.push(i),this.drawOrder.push(i)}this.ikConstraints=[];for(var b=0,c=a.ikConstraints.length;c>b;b++)this.ikConstraints.push(new e.IkConstraint(a.ikConstraints[b],this));this.boneCache=[],this.updateCache()},e.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateCache:function(){var a=this.ikConstraints,b=a.length,c=b+1,d=this.boneCache;d.length>c&&(d.length=c);for(var e=0,f=d.length;f>e;e++)d[e].length=0;for(;d.length<c;)d[d.length]=[];

var g=d[0],h=this.bones;a:for(var e=0,f=h.length;f>e;e++){var i=h[e],j=i;do{for(var k=0;b>k;k++)for(var l=a[k],m=l.bones[0],n=l.bones[l.bones.length-1];;){if(j==n){d[k].push(i),d[k+1].push(i);continue a}if(n==m)break;n=n.parent}j=j.parent}while(j);g[g.length]=i}},updateWorldTransform:function(){for(var a=this.bones,b=0,c=a.length;c>b;b++){var d=a[b];d.rotationIK=d.rotation}for(var b=0,e=this.boneCache.length-1;;){for(var f=this.boneCache[b],g=0,h=f.length;h>g;g++)f[g].updateWorldTransform();if(b==e)break;this.ikConstraints[b].apply(),b++}},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var a=this.bones,b=0,c=a.length;c>b;b++)a[b].setToSetupPose();for(var d=this.ikConstraints,b=0,c=d.length;c>b;b++){var e=d[b];e.bendDirection=e.data.bendDirection,e.mix=e.data.mix}},setSlotsToSetupPose:function(){for(var a=this.slots,b=this.drawOrder,c=0,d=a.length;d>c;c++)b[c]=a[c],a[c].setToSetupPose(c)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},setSkinByName:function(a){var b=this.data.findSkin(a);if(!b)throw"Skin not found: "+a;this.setSkin(b)},setSkin:function(a){if(a)if(this.skin)a._attachAll(this,this.skin);else for(var b=this.slots,c=0,d=b.length;d>c;c++){var e=b[c],f=e.data.attachmentName;if(f){var g=a.getAttachment(c,f);g&&e.setAttachment(g)}}this.skin=a},getAttachmentBySlotName:function(a,b){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(a),b)},getAttachmentBySlotIndex:function(a,b){if(this.skin){var c=this.skin.getAttachment(a,b);if(c)return c}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(a,b):null},setAttachment:function(a,b){for(var c=this.slots,d=0,e=c.length;e>d;d++){var f=c[d];if(f.data.name==a){var g=null;if(b&&(g=this.getAttachmentBySlotIndex(d,b),!g))throw"Attachment not found: "+b+", for slot: "+a;return void f.setAttachment(g)}}throw"Slot not found: "+a},findIkConstraint:function(a){for(var b=this.ikConstraints,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},update:function(a){this.time+=a}},e.EventData=function(a){this.name=a},e.EventData.prototype={intValue:0,floatValue:0,stringValue:null},e.Event=function(a){this.data=a},e.Event.prototype={intValue:0,floatValue:0,stringValue:null},e.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3},e.RegionAttachment=function(a){this.name=a,this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},e.RegionAttachment.prototype={type:e.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(a,b,c,d,e){var f=this.uvs;e?(f[2]=a,f[3]=d,f[4]=a,f[5]=b,f[6]=c,f[7]=b,f[0]=c,f[1]=d):(f[0]=a,f[1]=d,f[2]=a,f[3]=b,f[4]=c,f[5]=b,f[6]=c,f[7]=d)},updateOffset:function(){var a=this.width/this.regionOriginalWidth*this.scaleX,b=this.height/this.regionOriginalHeight*this.scaleY,c=-this.width/2*this.scaleX+this.regionOffsetX*a,d=-this.height/2*this.scaleY+this.regionOffsetY*b,f=c+this.regionWidth*a,g=d+this.regionHeight*b,h=this.rotation*e.degRad,i=Math.cos(h),j=Math.sin(h),k=c*i+this.x,l=c*j,m=d*i+this.y,n=d*j,o=f*i+this.x,p=f*j,q=g*i+this.y,r=g*j,s=this.offset;s[0]=k-n,s[1]=m+l,s[2]=k-r,s[3]=q+l,s[4]=o-r,s[5]=q+p,s[6]=o-n,s[7]=m+p},computeVertices:function(a,b,c,d){a+=c.worldX,b+=c.worldY;var e=c.m00,f=c.m01,g=c.m10,h=c.m11,i=this.offset;d[0]=i[0]*e+i[1]*f+a,d[1]=i[0]*g+i[1]*h+b,d[2]=i[2]*e+i[3]*f+a,d[3]=i[2]*g+i[3]*h+b,d[4]=i[4]*e+i[5]*f+a,d[5]=i[4]*g+i[5]*h+b,d[6]=i[6]*e+i[7]*f+a,d[7]=i[6]*g+i[7]*h+b}},e.MeshAttachment=function(a){this.name=a},e.MeshAttachment.prototype={type:e.AttachmentType.mesh,vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var a=this.regionU2-this.regionU,b=this.regionV2-this.regionV,c=this.regionUVs.length;if(this.uvs&&this.uvs.length==c||(this.uvs=new e.Float32Array(c)),this.regionRotate)for(var d=0;c>d;d+=2)this.uvs[d]=this.regionU+this.regionUVs[d+1]*a,this.uvs[d+1]=this.regionV+b-this.regionUVs[d]*b;else for(var d=0;c>d;d+=2)this.uvs[d]=this.regionU+this.regionUVs[d]*a,this.uvs[d+1]=this.regionV+this.regionUVs[d+1]*b},computeWorldVertices:function(a,b,c,d){var e=c.bone;a+=e.worldX,b+=e.worldY;var f=e.m00,g=e.m01,h=e.m10,i=e.m11,j=this.vertices,k=j.length;c.attachmentVertices.length==k&&(j=c.attachmentVertices);for(var l=0;k>l;l+=2){var m=j[l],n=j[l+1];d[l]=m*f+n*g+a,d[l+1]=m*h+n*i+b}}},e.SkinnedMeshAttachment=function(a){this.name=a},e.SkinnedMeshAttachment.prototype={type:e.AttachmentType.skinnedmesh,bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(a,b,c,d,f){var g=this.regionU2-this.regionU,h=this.regionV2-this.regionV,i=this.regionUVs.length;if(this.uvs&&this.uvs.length==i||(this.uvs=new e.Float32Array(i)),this.regionRotate)for(var j=0;i>j;j+=2)this.uvs[j]=this.regionU+this.regionUVs[j+1]*g,this.uvs[j+1]=this.regionV+h-this.regionUVs[j]*h;else for(var j=0;i>j;j+=2)this.uvs[j]=this.regionU+this.regionUVs[j]*g,this.uvs[j+1]=this.regionV+this.regionUVs[j+1]*h},computeWorldVertices:function(a,b,c,d){var e,f,g,h,i,j,k,l=c.bone.skeleton.bones,m=this.weights,n=this.bones,o=0,p=0,q=0,r=0,s=n.length;if(c.attachmentVertices.length)for(var t=c.attachmentVertices;s>p;o+=2){for(f=0,g=0,e=n[p++]+p;e>p;p++,q+=3,r+=2)h=l[n[p]],i=m[q]+t[r],j=m[q+1]+t[r+1],k=m[q+2],f+=(i*h.m00+j*h.m01+h.worldX)*k,g+=(i*h.m10+j*h.m11+h.worldY)*k;d[o]=f+a,d[o+1]=g+b}else for(;s>p;o+=2){for(f=0,g=0,e=n[p++]+p;e>p;p++,q+=3)h=l[n[p]],i=m[q],j=m[q+1],k=m[q+2],f+=(i*h.m00+j*h.m01+h.worldX)*k,g+=(i*h.m10+j*h.m11+h.worldY)*k;d[o]=f+a,d[o+1]=g+b}}},e.BoundingBoxAttachment=function(a){this.name=a,this.vertices=[]},e.BoundingBoxAttachment.prototype={type:e.AttachmentType.boundingbox,computeWorldVertices:function(a,b,c,d){a+=c.worldX,b+=c.worldY;for(var e=c.m00,f=c.m01,g=c.m10,h=c.m11,i=this.vertices,j=0,k=i.length;k>j;j+=2){var l=i[j],m=i[j+1];d[j]=l*e+m*f+a,d[j+1]=l*g+m*h+b}}},e.AnimationStateData=function(a){this.skeletonData=a,this.animationToMixTime={}},e.AnimationStateData.prototype={defaultMix:0,setMixByName:function(a,b,c){var d=this.skeletonData.findAnimation(a);if(!d)throw"Animation not found: "+a;var e=this.skeletonData.findAnimation(b);if(!e)throw"Animation not found: "+b;this.setMix(d,e,c)},setMix:function(a,b,c){this.animationToMixTime[a.name+":"+b.name]=c},getMix:function(a,b){var c=a.name+":"+b.name;return this.animationToMixTime.hasOwnProperty(c)?this.animationToMixTime[c]:this.defaultMix}},e.TrackEntry=function(){},e.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null},e.AnimationState=function(a){this.data=a,this.tracks=[],this.events=[]},e.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(a){a*=this.timeScale;for(var b=0;b<this.tracks.length;b++){var c=this.tracks[b];if(c){if(c.time+=a*c.timeScale,c.previous){var d=a*c.previous.timeScale;c.previous.time+=d,c.mixTime+=d}var e=c.next;e?(e.time=c.lastTime-e.delay,e.time>=0&&this.setCurrent(b,e)):!c.loop&&c.lastTime>=c.endTime&&this.clearTrack(b)}}},apply:function(a){for(var b=0;b<this.tracks.length;b++){var c=this.tracks[b];if(c){this.events.length=0;var d=c.time,e=c.lastTime,f=c.endTime,g=c.loop;!g&&d>f&&(d=f);var h=c.previous;if(h){var i=h.time;!h.loop&&i>h.endTime&&(i=h.endTime),h.animation.apply(a,i,i,h.loop,null);var j=c.mixTime/c.mixDuration*c.mix;j>=1&&(j=1,c.previous=null),c.animation.mix(a,c.lastTime,d,g,this.events,j)}else 1==c.mix?c.animation.apply(a,c.lastTime,d,g,this.events):c.animation.mix(a,c.lastTime,d,g,this.events,c.mix);for(var k=0,l=this.events.length;l>k;k++){var m=this.events[k];c.onEvent&&c.onEvent(b,m),this.onEvent&&this.onEvent(b,m)}if(g?e%f>d%f:f>e&&d>=f){var n=Math.floor(d/f);c.onComplete&&c.onComplete(b,n),this.onComplete&&this.onComplete(b,n)}c.lastTime=c.time}}},clearTracks:function(){for(var a=0,b=this.tracks.length;b>a;a++)this.clearTrack(a);this.tracks.length=0},clearTrack:function(a){if(!(a>=this.tracks.length)){var b=this.tracks[a];b&&(b.onEnd&&b.onEnd(a),this.onEnd&&this.onEnd(a),this.tracks[a]=null)}},_expandToIndex:function(a){if(a<this.tracks.length)return this.tracks[a];for(;a>=this.tracks.length;)this.tracks.push(null);return null},setCurrent:function(a,b){var c=this._expandToIndex(a);if(c){var d=c.previous;c.previous=null,c.onEnd&&c.onEnd(a),this.onEnd&&this.onEnd(a),b.mixDuration=this.data.getMix(c.animation,b.animation),b.mixDuration>0&&(b.mixTime=0,b.previous=d&&c.mixTime/c.mixDuration<.5?d:c)}this.tracks[a]=b,b.onStart&&b.onStart(a),this.onStart&&this.onStart(a)},setAnimationByName:function(a,b,c){var d=this.data.skeletonData.findAnimation(b);if(!d)throw"Animation not found: "+b;return this.setAnimation(a,d,c)},setAnimation:function(a,b,c){var d=new e.TrackEntry;return d.animation=b,d.loop=c,d.endTime=b.duration,this.setCurrent(a,d),d},addAnimationByName:function(a,b,c,d){var e=this.data.skeletonData.findAnimation(b);if(!e)throw"Animation not found: "+b;return this.addAnimation(a,e,c,d)},addAnimation:function(a,b,c,d){var f=new e.TrackEntry;f.animation=b,f.loop=c,f.endTime=b.duration;var g=this._expandToIndex(a);if(g){for(;g.next;)g=g.next;g.next=f}else this.tracks[a]=f;return 0>=d&&(g?d+=g.endTime-this.data.getMix(g.animation,b):d=0),f.delay=d,f},getCurrent:function(a){return a>=this.tracks.length?null:this.tracks[a]}},e.SkeletonJsonParser=function(a){this.attachmentLoader=a},e.SkeletonJsonParser.prototype={scale:1,readSkeletonData:function(a,b){var c=new e.SkeletonData;c.name=b;var d=a.skeleton;d&&(c.hash=d.hash,c.version=d.spine,c.width=d.width||0,c.height=d.height||0);for(var f=a.bones,g=0,h=f.length;h>g;g++){var i=f[g],j=null;if(i.parent&&(j=c.findBone(i.parent),!j))throw"Parent bone not found: "+i.parent;var k=new e.BoneData(i.name,j);k.length=(i.length||0)*this.scale,k.x=(i.x||0)*this.scale,k.y=(i.y||0)*this.scale,k.rotation=i.rotation||0,k.scaleX=i.hasOwnProperty("scaleX")?i.scaleX:1,k.scaleY=i.hasOwnProperty("scaleY")?i.scaleY:1,k.inheritScale=i.hasOwnProperty("inheritScale")?i.inheritScale:!0,k.inheritRotation=i.hasOwnProperty("inheritRotation")?i.inheritRotation:!0,c.bones.push(k)}var l=a.ik;if(l)for(var g=0,h=l.length;h>g;g++){for(var m=l[g],n=new e.IkConstraintData(m.name),f=m.bones,o=0,p=f.length;p>o;o++){var q=c.findBone(f[o]);if(!q)throw"IK bone not found: "+f[o];n.bones.push(q)}if(n.target=c.findBone(m.target),!n.target)throw"Target bone not found: "+m.target;n.bendDirection=!m.hasOwnProperty("bendPositive")||m.bendPositive?1:-1,n.mix=m.hasOwnProperty("mix")?m.mix:1,c.ikConstraints.push(n)}for(var r=a.slots,g=0,h=r.length;h>g;g++){var s=r[g],k=c.findBone(s.bone);if(!k)throw"Slot bone not found: "+s.bone;var t=new e.SlotData(s.name,k),u=s.color;u&&(t.r=this.toColor(u,0),t.g=this.toColor(u,1),t.b=this.toColor(u,2),t.a=this.toColor(u,3)),t.attachmentName=s.attachment,t.additiveBlending=s.additive&&"true"==s.additive,c.slots.push(t)}var v=a.skins;for(var w in v)if(v.hasOwnProperty(w)){var x=v[w],y=new e.Skin(w);for(var z in x)if(x.hasOwnProperty(z)){var A=c.findSlotIndex(z),B=x[z];for(var C in B)if(B.hasOwnProperty(C)){var D=this.readAttachment(y,C,B[C]);D&&y.addAttachment(A,C,D)}}c.skins.push(y),"default"==y.name&&(c.defaultSkin=y)}var E=a.events;for(var F in E)if(E.hasOwnProperty(F)){var G=E[F],H=new e.EventData(F);H.intValue=G["int"]||0,H.floatValue=G["float"]||0,H.stringValue=G.string||null,c.events.push(H)}var I=a.animations;for(var J in I)I.hasOwnProperty(J)&&this.readAnimation(J,I[J],c);return c},readAttachment:function(a,b,c){b=c.name||b;var d=e.AttachmentType[c.type||"region"],f=c.path||b,g=this.scale;if(d==e.AttachmentType.region){var h=this.attachmentLoader.newRegionAttachment(a,b,f);if(!h)return null;h.path=f,h.x=(c.x||0)*g,h.y=(c.y||0)*g,h.scaleX=c.hasOwnProperty("scaleX")?c.scaleX:1,h.scaleY=c.hasOwnProperty("scaleY")?c.scaleY:1,h.rotation=c.rotation||0,h.width=(c.width||0)*g,h.height=(c.height||0)*g;var i=c.color;return i&&(h.r=this.toColor(i,0),h.g=this.toColor(i,1),h.b=this.toColor(i,2),h.a=this.toColor(i,3)),h.updateOffset(),h}if(d==e.AttachmentType.mesh){var j=this.attachmentLoader.newMeshAttachment(a,b,f);return j?(j.path=f,j.vertices=this.getFloatArray(c,"vertices",g),j.triangles=this.getIntArray(c,"triangles"),j.regionUVs=this.getFloatArray(c,"uvs",1),j.updateUVs(),i=c.color,i&&(j.r=this.toColor(i,0),j.g=this.toColor(i,1),j.b=this.toColor(i,2),j.a=this.toColor(i,3)),j.hullLength=2*(c.hull||0),c.edges&&(j.edges=this.getIntArray(c,"edges")),j.width=(c.width||0)*g,j.height=(c.height||0)*g,j):null}if(d==e.AttachmentType.skinnedmesh){var j=this.attachmentLoader.newSkinnedMeshAttachment(a,b,f);if(!j)return null;j.path=f;for(var k=this.getFloatArray(c,"uvs",1),l=this.getFloatArray(c,"vertices",1),m=[],n=[],o=0,p=l.length;p>o;){var q=0|l[o++];n[n.length]=q;for(var r=o+4*q;r>o;)n[n.length]=l[o],m[m.length]=l[o+1]*g,m[m.length]=l[o+2]*g,m[m.length]=l[o+3],o+=4}return j.bones=n,j.weights=m,j.triangles=this.getIntArray(c,"triangles"),j.regionUVs=k,j.updateUVs(),i=c.color,i&&(j.r=this.toColor(i,0),j.g=this.toColor(i,1),j.b=this.toColor(i,2),j.a=this.toColor(i,3)),j.hullLength=2*(c.hull||0),c.edges&&(j.edges=this.getIntArray(c,"edges")),j.width=(c.width||0)*g,j.height=(c.height||0)*g,j}if(d==e.AttachmentType.boundingbox){for(var s=this.attachmentLoader.newBoundingBoxAttachment(a,b),l=c.vertices,o=0,p=l.length;p>o;o++)s.vertices.push(l[o]*g);return s}throw"Unknown attachment type: "+d},readAnimation:function(a,b,c){var d=[],f=0,g=b.slots;for(var h in g)if(g.hasOwnProperty(h)){var i=g[h],j=c.findSlotIndex(h);for(var k in i)if(i.hasOwnProperty(k)){var l=i[k];if("color"==k){var m=new e.ColorTimeline(l.length);m.slotIndex=j;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o],r=q.color,s=this.toColor(r,0),t=this.toColor(r,1),u=this.toColor(r,2),v=this.toColor(r,3);m.setFrame(n,q.time,s,t,u,v),this.readCurve(m,n,q),n++}d.push(m),f=Math.max(f,m.frames[5*m.getFrameCount()-5])}else{if("attachment"!=k)throw"Invalid timeline type for a slot: "+k+" ("+h+")";var m=new e.AttachmentTimeline(l.length);m.slotIndex=j;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o];m.setFrame(n++,q.time,q.name)}d.push(m),f=Math.max(f,m.frames[m.getFrameCount()-1])}}}var w=b.bones;for(var x in w)if(w.hasOwnProperty(x)){var y=c.findBoneIndex(x);if(-1==y)throw"Bone not found: "+x;var z=w[x];for(var k in z)if(z.hasOwnProperty(k)){var l=z[k];if("rotate"==k){var m=new e.RotateTimeline(l.length);m.boneIndex=y;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o];m.setFrame(n,q.time,q.angle),this.readCurve(m,n,q),n++}d.push(m),f=Math.max(f,m.frames[2*m.getFrameCount()-2])}else if("translate"==k||"scale"==k){var m,A=1;"scale"==k?m=new e.ScaleTimeline(l.length):(m=new e.TranslateTimeline(l.length),A=this.scale),m.boneIndex=y;for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o],B=(q.x||0)*A,C=(q.y||0)*A;m.setFrame(n,q.time,B,C),this.readCurve(m,n,q),n++}d.push(m),f=Math.max(f,m.frames[3*m.getFrameCount()-3])}else{if("flipX"!=k&&"flipY"!=k)throw"Invalid timeline type for a bone: "+k+" ("+x+")";var B="flipX"==k,m=B?new e.FlipXTimeline(l.length):new e.FlipYTimeline(l.length);m.boneIndex=y;for(var D=B?"x":"y",n=0,o=0,p=l.length;p>o;o++){var q=l[o];m.setFrame(n,q.time,q[D]||!1),n++}d.push(m),f=Math.max(f,m.frames[2*m.getFrameCount()-2])}}}var E=b.ik;for(var F in E)if(E.hasOwnProperty(F)){var G=c.findIkConstraint(F),l=E[F],m=new e.IkConstraintTimeline(l.length);m.ikConstraintIndex=c.ikConstraints.indexOf(G);for(var n=0,o=0,p=l.length;p>o;o++){var q=l[o],H=q.hasOwnProperty("mix")?q.mix:1,I=!q.hasOwnProperty("bendPositive")||q.bendPositive?1:-1;m.setFrame(n,q.time,H,I),this.readCurve(m,n,q),n++}d.push(m),f=Math.max(f,m.frames[3*m.frameCount-3])}var J=b.ffd;for(var K in J){var L=c.findSkin(K),i=J[K];for(h in i){var j=c.findSlotIndex(h),M=i[h];for(var N in M){var l=M[N],m=new e.FfdTimeline(l.length),O=L.getAttachment(j,N);if(!O)throw"FFD attachment not found: "+N;m.slotIndex=j,m.attachment=O;var P,Q=O.type==e.AttachmentType.mesh;P=Q?O.vertices.length:O.weights.length/3*2;for(var n=0,o=0,p=l.length;p>o;o++){var R,q=l[o];if(q.vertices){var S=q.vertices,R=[];R.length=P;var T=q.offset||0,U=S.length;if(1==this.scale)for(var V=0;U>V;V++)R[V+T]=S[V];else for(var V=0;U>V;V++)R[V+T]=S[V]*this.scale;if(Q)for(var W=O.vertices,V=0,U=R.length;U>V;V++)R[V]+=W[V]}else Q?R=O.vertices:(R=[],R.length=P);m.setFrame(n,q.time,R),this.readCurve(m,n,q),n++}d[d.length]=m,f=Math.max(f,m.frames[m.frameCount-1])}}}var X=b.drawOrder;if(X||(X=b.draworder),X){for(var m=new e.DrawOrderTimeline(X.length),Y=c.slots.length,n=0,o=0,p=X.length;p>o;o++){var Z=X[o],$=null;if(Z.offsets){$=[],$.length=Y;for(var V=Y-1;V>=0;V--)$[V]=-1;var _=Z.offsets,aa=[];aa.length=Y-_.length;for(var ba=0,ca=0,V=0,U=_.length;U>V;V++){var da=_[V],j=c.findSlotIndex(da.slot);if(-1==j)throw"Slot not found: "+da.slot;for(;ba!=j;)aa[ca++]=ba++;$[ba+da.offset]=ba++}for(;Y>ba;)aa[ca++]=ba++;for(var V=Y-1;V>=0;V--)-1==$[V]&&($[V]=aa[--ca])}m.setFrame(n++,Z.time,$)}d.push(m),f=Math.max(f,m.frames[m.getFrameCount()-1])}var ea=b.events;if(ea){for(var m=new e.EventTimeline(ea.length),n=0,o=0,p=ea.length;p>o;o++){var fa=ea[o],ga=c.findEvent(fa.name);if(!ga)throw"Event not found: "+fa.name;var ha=new e.Event(ga);ha.intValue=fa.hasOwnProperty("int")?fa["int"]:ga.intValue,ha.floatValue=fa.hasOwnProperty("float")?fa["float"]:ga.floatValue,ha.stringValue=fa.hasOwnProperty("string")?fa.string:ga.stringValue,m.setFrame(n++,fa.time,ha)}d.push(m),f=Math.max(f,m.frames[m.getFrameCount()-1])}c.animations.push(new e.Animation(a,d,f))},readCurve:function(a,b,c){var d=c.curve;d?"stepped"==d?a.curves.setStepped(b):d instanceof Array&&a.curves.setCurve(b,d[0],d[1],d[2],d[3]):a.curves.setLinear(b)},toColor:function(a,b){if(8!=a.length)throw"Color hexidecimal length must be 8, recieved: "+a;return parseInt(a.substring(2*b,2*b+2),16)/255},getFloatArray:function(a,b,c){var d=a[b],f=new e.Float32Array(d.length),g=0,h=d.length;if(1==c)for(;h>g;g++)f[g]=d[g];else for(;h>g;g++)f[g]=d[g]*c;return f},getIntArray:function(a,b){for(var c=a[b],d=new e.Uint16Array(c.length),f=0,g=c.length;g>f;f++)d[f]=0|c[f];return d}},e.Atlas=function(a,b,c){b&&b.indexOf("/")!==b.length&&(b+="/"),this.pages=[],this.regions=[],this.texturesLoading=0;var f=new e.AtlasReader(a),g=[];g.length=4;for(var h=null;;){var i=f.readLine();if(null===i)break;if(i=f.trim(i),i.length)if(h){var j=new e.AtlasRegion;j.name=i,j.page=h,j.rotate="true"==f.readValue(),f.readTuple(g);var k=parseInt(g[0]),l=parseInt(g[1]);f.readTuple(g);var m=parseInt(g[0]),n=parseInt(g[1]);j.u=k/h.width,j.v=l/h.height,j.rotate?(j.u2=(k+n)/h.width,j.v2=(l+m)/h.height):(j.u2=(k+m)/h.width,j.v2=(l+n)/h.height),j.x=k,j.y=l,j.width=Math.abs(m),j.height=Math.abs(n),4==f.readTuple(g)&&(j.splits=[parseInt(g[0]),parseInt(g[1]),parseInt(g[2]),parseInt(g[3])],4==f.readTuple(g)&&(j.pads=[parseInt(g[0]),parseInt(g[1]),parseInt(g[2]),parseInt(g[3])],f.readTuple(g))),j.originalWidth=parseInt(g[0]),j.originalHeight=parseInt(g[1]),f.readTuple(g),j.offsetX=parseInt(g[0]),j.offsetY=parseInt(g[1]),j.index=parseInt(f.readValue()),this.regions.push(j)}else{h=new e.AtlasPage,h.name=i,2==f.readTuple(g)&&(h.width=parseInt(g[0]),h.height=parseInt(g[1]),f.readTuple(g)),h.format=e.Atlas.Format[g[0]],f.readTuple(g),h.minFilter=e.Atlas.TextureFilter[g[0]],h.magFilter=e.Atlas.TextureFilter[g[1]];var o=f.readValue();h.uWrap=e.Atlas.TextureWrap.clampToEdge,h.vWrap=e.Atlas.TextureWrap.clampToEdge,"x"==o?h.uWrap=e.Atlas.TextureWrap.repeat:"y"==o?h.vWrap=e.Atlas.TextureWrap.repeat:"xy"==o&&(h.uWrap=h.vWrap=e.Atlas.TextureWrap.repeat),h.rendererObject=d.BaseTexture.fromImage(b+i,c),this.pages.push(h)}else h=null}},e.Atlas.prototype={findRegion:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},dispose:function(){for(var a=this.pages,b=0,c=a.length;c>b;b++)a[b].rendererObject.destroy(!0)},updateUVs:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++){var e=b[c];e.page==a&&(e.u=e.x/a.width,e.v=e.y/a.height,e.rotate?(e.u2=(e.x+e.height)/a.width,e.v2=(e.y+e.width)/a.height):(e.u2=(e.x+e.width)/a.width,e.v2=(e.y+e.height)/a.height))}}},e.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},e.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},e.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},e.AtlasPage=function(){},e.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},e.AtlasRegion=function(){},e.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},e.AtlasReader=function(a){this.lines=a.split(/\r\n|\r|\n/)},e.AtlasReader.prototype={index:0,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var a=this.readLine(),b=a.indexOf(":");if(-1==b)throw"Invalid line: "+a;return this.trim(a.substring(b+1))},readTuple:function(a){var b=this.readLine(),c=b.indexOf(":");if(-1==c)throw"Invalid line: "+b;for(var d=0,e=c+1;3>d;d++){var f=b.indexOf(",",e);if(-1==f)break;a[d]=this.trim(b.substr(e,f-e)),e=f+1}return a[d]=this.trim(b.substring(e)),d+1}},e.AtlasAttachmentParser=function(a){this.atlas=a},e.AtlasAttachmentParser.prototype={newRegionAttachment:function(a,b,c){var d=this.atlas.findRegion(c);if(!d)throw"Region not found in atlas: "+c+" (region attachment: "+b+")";var f=new e.RegionAttachment(b);return f.rendererObject=d,f.setUVs(d.u,d.v,d.u2,d.v2,d.rotate),f.regionOffsetX=d.offsetX,f.regionOffsetY=d.offsetY,f.regionWidth=d.width,f.regionHeight=d.height,f.regionOriginalWidth=d.originalWidth,f.regionOriginalHeight=d.originalHeight,f},newMeshAttachment:function(a,b,c){var d=this.atlas.findRegion(c);if(!d)throw"Region not found in atlas: "+c+" (mesh attachment: "+b+")";var f=new e.MeshAttachment(b);return f.rendererObject=d,f.regionU=d.u,f.regionV=d.v,f.regionU2=d.u2,f.regionV2=d.v2,f.regionRotate=d.rotate,f.regionOffsetX=d.offsetX,f.regionOffsetY=d.offsetY,f.regionWidth=d.width,f.regionHeight=d.height,f.regionOriginalWidth=d.originalWidth,f.regionOriginalHeight=d.originalHeight,f},newSkinnedMeshAttachment:function(a,b,c){var d=this.atlas.findRegion(c);if(!d)throw"Region not found in atlas: "+c+" (skinned mesh attachment: "+b+")";var f=new e.SkinnedMeshAttachment(b);return f.rendererObject=d,f.regionU=d.u,f.regionV=d.v,f.regionU2=d.u2,f.regionV2=d.v2,f.regionRotate=d.rotate,f.regionOffsetX=d.offsetX,f.regionOffsetY=d.offsetY,f.regionWidth=d.width,f.regionHeight=d.height,f.regionOriginalWidth=d.originalWidth,f.regionOriginalHeight=d.originalHeight,f},newBoundingBoxAttachment:function(a,b){return new e.BoundingBoxAttachment(b)}},e.SkeletonBounds=function(){this.polygonPool=[],this.polygons=[],this.boundingBoxes=[]},e.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(a,b){var c=a.slots,d=c.length,f=a.x,g=a.y,h=this.boundingBoxes,i=this.polygonPool,j=this.polygons;h.length=0;for(var k=0,l=j.length;l>k;k++)i.push(j[k]);j.length=0;for(var k=0;d>k;k++){var m=c[k],n=m.attachment;if(n.type==e.AttachmentType.boundingbox){h.push(n);var o,p=i.length;p>0?(o=i[p-1],i.splice(p-1,1)):o=[],j.push(o),o.length=n.vertices.length,n.computeWorldVertices(f,g,m.bone,o)}}b&&this.aabbCompute()},aabbCompute:function(){for(var a=this.polygons,b=Number.MAX_VALUE,c=Number.MAX_VALUE,d=Number.MIN_VALUE,e=Number.MIN_VALUE,f=0,g=a.length;g>f;f++)for(var h=a[f],i=0,j=h.length;j>i;i+=2){var k=h[i],l=h[i+1];b=Math.min(b,k),c=Math.min(c,l),d=Math.max(d,k),e=Math.max(e,l)}this.minX=b,this.minY=c,this.maxX=d,this.maxY=e},aabbContainsPoint:function(a,b){return a>=this.minX&&a<=this.maxX&&b>=this.minY&&b<=this.maxY},aabbIntersectsSegment:function(a,b,c,d){var e=this.minX,f=this.minY,g=this.maxX,h=this.maxY;if(e>=a&&e>=c||f>=b&&f>=d||a>=g&&c>=g||b>=h&&d>=h)return!1;var i=(d-b)/(c-a),j=i*(e-a)+b;if(j>f&&h>j)return!0;if(j=i*(g-a)+b,j>f&&h>j)return!0;var k=(f-b)/i+a;return k>e&&g>k?!0:(k=(h-b)/i+a,k>e&&g>k?!0:!1)},aabbIntersectsSkeleton:function(a){return this.minX<a.maxX&&this.maxX>a.minX&&this.minY<a.maxY&&this.maxY>a.minY},containsPoint:function(a,b){for(var c=this.polygons,d=0,e=c.length;e>d;d++)if(this.polygonContainsPoint(c[d],a,b))return this.boundingBoxes[d];return null},intersectsSegment:function(a,b,c,d){for(var e=this.polygons,f=0,g=e.length;g>f;f++)if(e[f].intersectsSegment(a,b,c,d))return this.boundingBoxes[f];return null},polygonContainsPoint:function(a,b,c){for(var d=a.length,e=d-2,f=!1,g=0;d>g;g+=2){var h=a[g+1],i=a[e+1];if(c>h&&i>=c||c>i&&h>=c){var j=a[g];j+(c-h)/(i-h)*(a[e]-j)<b&&(f=!f)}e=g}return f},polygonIntersectsSegment:function(a,b,c,d,e){for(var f=a.length,g=b-d,h=c-e,i=b*e-c*d,j=a[f-2],k=a[f-1],l=0;f>l;l+=2){var m=a[l],n=a[l+1],o=j*n-k*m,p=j-m,q=k-n,r=g*q-h*p,s=(i*p-g*o)/r;if((s>=j&&m>=s||s>=m&&j>=s)&&(s>=b&&d>=s||s>=d&&b>=s)){var t=(i*q-h*o)/r;if((t>=k&&n>=t||t>=n&&k>=t)&&(t>=c&&e>=t||t>=e&&c>=t))return!0}j=m,k=n}return!1},getPolygon:function(a){var b=this.boundingBoxes.indexOf(a);return-1==b?null:this.polygons[b]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}}},{"../core":20}],125:[function(a,b,c){b.exports={Spine:a("./Spine"),SpineRuntime:a("./SpineRuntime")}},{"./Spine":123,"./SpineRuntime":124}],"pixi.js":[function(a,b,c){a("./polyfill");var d=b.exports=a("./core");d.extras=a("./extras"),d.filters=a("./filters"),d.interaction=a("./interaction"),d.loaders=a("./loaders"),d.mesh=a("./mesh"),d.spine=a("./spine"),d.loader=new d.loaders.Loader,Object.assign(d,a("./deprecation"))},{"./core":20,"./deprecation":68,"./extras":76,"./filters":92,"./interaction":107,"./loaders":110,"./mesh":117,"./polyfill":121,"./spine":125}]},{},[])("pixi.js")});